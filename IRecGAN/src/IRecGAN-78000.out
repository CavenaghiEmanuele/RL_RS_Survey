Thu Dec 30 22:57:09 2021       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 470.42.01    Driver Version: 470.42.01    CUDA Version: 11.4     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla V100-PCIE...  Off  | 00000000:3B:00.0 Off |                    0 |
| N/A   38C    P0    36W / 250W |      0MiB / 32510MiB |      2%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
Reading data from: ./data/train.csv
('Number of sessions after filtering:', 68722)
('Average length of the dataset:', 2.8058700270655685, 'max_interact_len:', 4)
Creating vocabulary...
Get training data: number is 65284, average length is 2.8062
Get validation data: number is 1718, average length is 2.7905
Get testing data: number is 1720, average length is 2.8099
agn/embed:0: (40000, 50)
agn/encoder/multi_rnn_cell/cell_0/lstm_cell/kernel:0: (562, 2048)
agn/encoder/multi_rnn_cell/cell_0/lstm_cell/bias:0: (2048,)
agn/encoder/multi_rnn_cell/cell_1/lstm_cell/kernel:0: (1024, 2048)
agn/encoder/multi_rnn_cell/cell_1/lstm_cell/bias:0: (2048,)
agn/decoder/output_projection/weights:0: (512, 40000)
agn/decoder/output_projection/biases:0: (40000,)
Creating agent model with fresh parameters.
env/embed:0: (40000, 50)
env/encoder/multi_rnn_cell/cell_0/lstm_cell/kernel:0: (562, 2048)
env/encoder/multi_rnn_cell/cell_0/lstm_cell/bias:0: (2048,)
env/encoder/multi_rnn_cell/cell_1/lstm_cell/kernel:0: (1024, 2048)
env/encoder/multi_rnn_cell/cell_1/lstm_cell/bias:0: (2048,)
env/pref_output/kernel:0: (512, 50)
env/pref_output/bias:0: (50,)
env/purchase_layer/kernel:0: (512, 512)
env/purchase_layer/bias:0: (512,)
env/purchase_aim/kernel:0: (50, 512)
env/purchase_aim/bias:0: (512,)
env/purchase_projection/kernel:0: (512, 2)
env/purchase_projection/bias:0: (2,)
Creating environment model with fresh parameters.
dis/embed:0: (40000, 50)
dis/encoder/multi_rnn_cell/cell_0/lstm_cell/kernel:0: (562, 2048)
dis/encoder/multi_rnn_cell/cell_0/lstm_cell/bias:0: (2048,)
dis/encoder/multi_rnn_cell/cell_1/lstm_cell/kernel:0: (1024, 2048)
dis/encoder/multi_rnn_cell/cell_1/lstm_cell/bias:0: (2048,)
dis/out2preference/kernel:0: (512, 512)
dis/out2preference/bias:0: (512,)
dis/rec2candidate/kernel:0: (50, 512)
dis/rec2candidate/bias:0: (512,)
Wp:0: ()
bp:0: ()
Creating discriminator model with fresh parameters.
Get training data:len(dataset) is 65284 
Agn epoch 1 learning rate 0.0001 epoch-time 3080.7650 loss [26.93391037] p@10 30.5183% p@1 5.1555%
Get testing data:len(dataset) is 1718 
        dev_set, loss [26.89853668] p@10 31.9100% p@1 6.1873%
Get testing data:len(dataset) is 1720 
        test_set, loss [26.85175896] p@10 35.0499% p@1 6.7834%
Saving agn model params in ./train/agn_train
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 2 learning rate 0.0001 epoch-time 2926.3961 loss [24.74072456] p@10 40.4624% p@1 7.1243%
Get testing data:len(dataset) is 1718 
        dev_set, loss [27.05741692] p@10 32.3654% p@1 5.7578%
Get testing data:len(dataset) is 1720 
        test_set, loss [26.95218468] p@10 34.2114% p@1 6.6306%
Saving agn model params in ./train/agn_train
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 3 learning rate 0.0001 epoch-time 2753.8911 loss [23.72871590] p@10 45.1705% p@1 8.9354%
Get testing data:len(dataset) is 1718 
        dev_set, loss [27.54258919] p@10 31.9513% p@1 5.3797%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 4 learning rate 0.0001 epoch-time 2754.9360 loss [22.79619408] p@10 50.5487% p@1 11.7850%
Get testing data:len(dataset) is 1718 
        dev_set, loss [28.05918694] p@10 32.3709% p@1 5.7747%
Get testing data:len(dataset) is 1720 
        test_set, loss [27.80062103] p@10 33.5108% p@1 5.9775%
Saving agn model params in ./train/agn_train
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 5 learning rate 0.0001 epoch-time 2753.7463 loss [21.55412674] p@10 57.7382% p@1 17.3383%
Get testing data:len(dataset) is 1718 
        dev_set, loss [28.48547173] p@10 32.0203% p@1 6.0780%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 6 learning rate 0.0001 epoch-time 2752.5867 loss [20.22363472] p@10 65.2773% p@1 24.3300%
Get testing data:len(dataset) is 1718 
        dev_set, loss [28.75736809] p@10 31.8153% p@1 6.3925%
Get testing data:len(dataset) is 1720 
        test_set, loss [28.28971100] p@10 32.6080% p@1 5.5901%
Saving agn model params in ./train/agn_train
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 7 learning rate 0.0001 epoch-time 2752.4829 loss [18.93597794] p@10 70.7988% p@1 30.8769%
Get testing data:len(dataset) is 1718 
        dev_set, loss [28.91954231] p@10 31.9053% p@1 6.4781%
Get testing data:len(dataset) is 1720 
        test_set, loss [28.42766953] p@10 32.2431% p@1 5.8577%
Saving agn model params in ./train/agn_train
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 8 learning rate 0.0001 epoch-time 2751.8148 loss [17.70528793] p@10 74.1709% p@1 35.9570%
Get testing data:len(dataset) is 1718 
        dev_set, loss [29.03210640] p@10 31.6410% p@1 6.5280%
Get testing data:len(dataset) is 1720 
        test_set, loss [28.52019501] p@10 31.9579% p@1 5.6618%
Saving agn model params in ./train/agn_train
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 9 learning rate 0.0001 epoch-time 2746.0160 loss [16.52813721] p@10 76.2666% p@1 39.6539%
Get testing data:len(dataset) is 1718 
        dev_set, loss [29.17553902] p@10 31.1923% p@1 6.5073%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 10 learning rate 0.0001 epoch-time 2743.9959 loss [15.40498638] p@10 77.8463% p@1 42.4339%
Get testing data:len(dataset) is 1718 
        dev_set, loss [29.31916618] p@10 30.6447% p@1 6.2124%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 11 learning rate 0.0001 epoch-time 2741.9624 loss [14.33786869] p@10 78.9724% p@1 44.5209%
Get testing data:len(dataset) is 1718 
        dev_set, loss [29.47166634] p@10 30.5852% p@1 5.7856%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 12 learning rate 0.0001 epoch-time 2743.0885 loss [13.32830143] p@10 79.8536% p@1 46.1700%
Get testing data:len(dataset) is 1718 
        dev_set, loss [29.62141037] p@10 30.3659% p@1 5.1943%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 13 learning rate 0.0001 epoch-time 2744.1215 loss [12.38831520] p@10 80.5727% p@1 47.4905%
Get testing data:len(dataset) is 1718 
        dev_set, loss [29.79062843] p@10 29.8390% p@1 5.4475%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 14 learning rate 0.0001 epoch-time 2742.9557 loss [11.52991390] p@10 81.2627% p@1 48.7385%
Get testing data:len(dataset) is 1718 
        dev_set, loss [29.90721703] p@10 29.5785% p@1 5.3985%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 15 learning rate 0.0001 epoch-time 2740.4186 loss [10.75512314] p@10 81.8950% p@1 49.8281%
Get testing data:len(dataset) is 1718 
        dev_set, loss [30.06685829] p@10 29.6420% p@1 5.4562%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 16 learning rate 0.0001 epoch-time 2744.2597 loss [10.05975151] p@10 82.5464% p@1 50.9249%
Get testing data:len(dataset) is 1718 
        dev_set, loss [30.18638420] p@10 29.8080% p@1 5.3168%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 17 learning rate 0.0001 epoch-time 2747.6593 loss [9.43955708] p@10 83.1940% p@1 51.9240%
Get testing data:len(dataset) is 1718 
        dev_set, loss [30.31792068] p@10 29.6420% p@1 5.4025%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 18 learning rate 0.0001 epoch-time 2741.3475 loss [8.89527512] p@10 83.8619% p@1 52.8902%
Get testing data:len(dataset) is 1718 
        dev_set, loss [30.53359032] p@10 29.5779% p@1 5.3520%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 19 learning rate 0.0001 epoch-time 2757.7869 loss [8.40245152] p@10 84.4632% p@1 53.9620%
Get testing data:len(dataset) is 1718 
        dev_set, loss [30.71174812] p@10 29.5955% p@1 5.4121%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 20 learning rate 0.0001 epoch-time 2782.9375 loss [7.96213675] p@10 85.0876% p@1 54.8921%
Get testing data:len(dataset) is 1718 
        dev_set, loss [30.85144806] p@10 29.8621% p@1 5.6765%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 21 learning rate 0.0001 epoch-time 2831.3516 loss [7.56702662] p@10 85.6967% p@1 55.8954%
Get testing data:len(dataset) is 1718 
        dev_set, loss [31.03058243] p@10 30.2168% p@1 5.8309%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 22 learning rate 0.0001 epoch-time 2803.8308 loss [7.21388626] p@10 86.2754% p@1 56.8585%
Get testing data:len(dataset) is 1718 
        dev_set, loss [31.08903885] p@10 30.2971% p@1 5.8398%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 23 learning rate 0.0001 epoch-time 2801.5222 loss [6.88566875] p@10 86.7762% p@1 57.7880%
Get testing data:len(dataset) is 1718 
        dev_set, loss [31.25836372] p@10 30.3693% p@1 5.9712%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 24 learning rate 0.0001 epoch-time 2819.7680 loss [6.59649277] p@10 87.3443% p@1 58.7041%
Get testing data:len(dataset) is 1718 
        dev_set, loss [31.35985184] p@10 30.7582% p@1 6.0832%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 25 learning rate 0.0001 epoch-time 2809.6585 loss [6.32316542] p@10 87.8632% p@1 59.6128%
Get testing data:len(dataset) is 1718 
        dev_set, loss [31.54420662] p@10 30.6158% p@1 6.2060%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 26 learning rate 0.0001 epoch-time 2813.3219 loss [6.07353735] p@10 88.3779% p@1 60.4866%
Get testing data:len(dataset) is 1718 
        dev_set, loss [31.57787132] p@10 30.8435% p@1 6.3281%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 27 learning rate 0.0001 epoch-time 2772.1505 loss [5.84236526] p@10 88.8617% p@1 61.3679%
Get testing data:len(dataset) is 1718 
        dev_set, loss [31.75604630] p@10 30.8199% p@1 6.4582%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 28 learning rate 0.0001 epoch-time 2741.4010 loss [5.62688017] p@10 89.3294% p@1 62.1898%
Get testing data:len(dataset) is 1718 
        dev_set, loss [31.83557892] p@10 31.0112% p@1 6.4982%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 29 learning rate 0.0001 epoch-time 2740.6302 loss [5.42201853] p@10 89.7882% p@1 62.9618%
Get testing data:len(dataset) is 1718 
        dev_set, loss [31.99641991] p@10 30.9019% p@1 6.5819%
Get testing data:len(dataset) is 1720 
        test_set, loss [31.07385254] p@10 31.6703% p@1 5.7913%
Saving agn model params in ./train/agn_train
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 30 learning rate 0.0001 epoch-time 2739.9318 loss [5.23356628] p@10 90.1944% p@1 63.7512%
Get testing data:len(dataset) is 1718 
        dev_set, loss [32.06047821] p@10 30.7959% p@1 6.5942%
Get testing data:len(dataset) is 1720 
        test_set, loss [31.18945312] p@10 31.5448% p@1 5.9151%
Saving agn model params in ./train/agn_train
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 31 learning rate 0.0001 epoch-time 2739.7618 loss [5.05856562] p@10 90.5874% p@1 64.4506%
Get testing data:len(dataset) is 1718 
        dev_set, loss [32.21502686] p@10 30.9029% p@1 6.6266%
Get testing data:len(dataset) is 1720 
        test_set, loss [31.18877220] p@10 31.8001% p@1 5.8266%
Saving agn model params in ./train/agn_train
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 32 learning rate 0.0001 epoch-time 2738.7298 loss [4.89283848] p@10 90.9850% p@1 65.2123%
Get testing data:len(dataset) is 1718 
        dev_set, loss [32.29954147] p@10 30.8801% p@1 6.7418%
Get testing data:len(dataset) is 1720 
        test_set, loss [31.30381584] p@10 31.7512% p@1 5.9574%
Saving agn model params in ./train/agn_train
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 33 learning rate 0.0001 epoch-time 2735.0592 loss [4.73959112] p@10 91.3388% p@1 65.8301%
Get testing data:len(dataset) is 1718 
        dev_set, loss [32.45300674] p@10 30.7278% p@1 6.7804%
Get testing data:len(dataset) is 1720 
        test_set, loss [31.39716339] p@10 32.1068% p@1 6.0719%
Saving agn model params in ./train/agn_train
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 34 learning rate 0.0001 epoch-time 2738.6164 loss [4.59175491] p@10 91.7124% p@1 66.5245%
Get testing data:len(dataset) is 1718 
        dev_set, loss [32.52163696] p@10 30.9175% p@1 6.8347%
Get testing data:len(dataset) is 1720 
        test_set, loss [31.41285706] p@10 31.8437% p@1 6.2099%
Saving agn model params in ./train/agn_train
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 35 learning rate 0.0001 epoch-time 2811.1117 loss [4.45405054] p@10 92.0799% p@1 67.1635%
Get testing data:len(dataset) is 1718 
        dev_set, loss [32.62615204] p@10 30.7859% p@1 6.8203%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 36 learning rate 0.0001 epoch-time 2755.7049 loss [4.32292414] p@10 92.4165% p@1 67.7476%
Get testing data:len(dataset) is 1718 
        dev_set, loss [32.72608566] p@10 30.7896% p@1 6.9652%
Get testing data:len(dataset) is 1720 
        test_set, loss [31.54131889] p@10 32.1731% p@1 6.3046%
Saving agn model params in ./train/agn_train
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 37 learning rate 0.0001 epoch-time 2734.5898 loss [4.20735645] p@10 92.7376% p@1 68.3837%
Get testing data:len(dataset) is 1718 
        dev_set, loss [32.85730743] p@10 30.5962% p@1 7.0007%
Get testing data:len(dataset) is 1720 
        test_set, loss [31.56795692] p@10 32.5001% p@1 6.5335%
Saving agn model params in ./train/agn_train
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 38 learning rate 0.0001 epoch-time 2733.1946 loss [4.09142733] p@10 93.0440% p@1 68.9168%
Get testing data:len(dataset) is 1718 
        dev_set, loss [32.88202286] p@10 30.7947% p@1 6.9707%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 39 learning rate 0.0001 epoch-time 2733.1638 loss [3.97930980] p@10 93.3393% p@1 69.4953%
Get testing data:len(dataset) is 1718 
        dev_set, loss [33.06504822] p@10 30.5017% p@1 6.9002%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 40 learning rate 0.0001 epoch-time 2734.9179 loss [3.87497187] p@10 93.6444% p@1 70.0018%
Get testing data:len(dataset) is 1718 
        dev_set, loss [32.99039841] p@10 30.5925% p@1 7.0264%
Get testing data:len(dataset) is 1720 
        test_set, loss [31.74053764] p@10 32.4822% p@1 6.4377%
Saving agn model params in ./train/agn_train
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 41 learning rate 0.0001 epoch-time 2735.3567 loss [3.77493477] p@10 93.9208% p@1 70.5225%
Get testing data:len(dataset) is 1718 
        dev_set, loss [33.15087128] p@10 30.5105% p@1 6.9102%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 42 learning rate 0.0001 epoch-time 2735.0933 loss [3.68285108] p@10 94.1831% p@1 70.9560%
Get testing data:len(dataset) is 1718 
        dev_set, loss [33.20522308] p@10 30.5661% p@1 6.9286%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 43 learning rate 0.0001 epoch-time 2733.8192 loss [3.58849525] p@10 94.4544% p@1 71.4568%
Get testing data:len(dataset) is 1718 
        dev_set, loss [33.29235840] p@10 30.5732% p@1 6.9587%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 44 learning rate 0.0001 epoch-time 2734.1780 loss [3.50477433] p@10 94.6777% p@1 71.8926%
Get testing data:len(dataset) is 1718 
        dev_set, loss [33.38989639] p@10 30.5282% p@1 6.9606%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 45 learning rate 0.0001 epoch-time 2735.5625 loss [3.42132950] p@10 94.8864% p@1 72.3492%
Get testing data:len(dataset) is 1718 
        dev_set, loss [33.44740295] p@10 30.5136% p@1 6.8758%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 46 learning rate 0.0001 epoch-time 2736.5418 loss [3.34218431] p@10 95.1339% p@1 72.7724%
Get testing data:len(dataset) is 1718 
        dev_set, loss [33.63387680] p@10 30.4916% p@1 6.8733%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 47 learning rate 0.0001 epoch-time 2736.9035 loss [3.27336812] p@10 95.3414% p@1 73.2400%
Get testing data:len(dataset) is 1718 
        dev_set, loss [33.61957169] p@10 30.3566% p@1 6.8668%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 48 learning rate 0.0001 epoch-time 2739.0352 loss [3.20483875] p@10 95.5534% p@1 73.5740%
Get testing data:len(dataset) is 1718 
        dev_set, loss [33.72869110] p@10 30.5436% p@1 6.8664%
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 49 learning rate 0.0001 epoch-time 2736.4358 loss [3.13520384] p@10 95.7158% p@1 74.0035%
Get testing data:len(dataset) is 1718 
        dev_set, loss [33.75154114] p@10 30.6075% p@1 7.0692%
Get testing data:len(dataset) is 1720 
        test_set, loss [32.17293167] p@10 32.8933% p@1 6.3879%
Saving agn model params in ./train/agn_train
------agn train finish-------
Get training data:len(dataset) is 65284 
Agn epoch 50 learning rate 0.0001 epoch-time 2739.7072 loss [3.07418513] p@10 95.8689% p@1 74.3302%
Get testing data:len(dataset) is 1718 
        dev_set, loss [33.78959656] p@10 30.5801% p@1 6.9913%
------agn train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0018', 'true negative:0.9342')
('false positive:0.0607', 'false negative:0.0033')
('predict:p@1:4.8854%', 'p@10:26.0530%')
Env epoch 1 lr 0.0005 time 958.4175 ppl [4.37323427] pr_loss [3.36732149] pu_loss [1.00591278]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0024', 'true negative:0.9258')
('false positive:0.0687', 'false negative:0.0031')
('predict:p@1:7.1522%', 'p@10:25.8194%')
        dev_set, ppl [4.22254133] pr_loss [3.20546579] pu_loss [1.01707566] best_p@10 [0.0000]
Get testing data:len(dataset) is 1720 
Confusion matrix for purchase prediction:
('true positive:0.0018', 'true negative:0.9296')
('false positive:0.0661', 'false negative:0.0025')
('predict:p@1:6.6924%', 'p@10:28.0457%')
        test_set, ppl [4.09000254] pr_loss [3.20068645] pu_loss [0.88931608] best_p@10 [0.2582]
Saving env model params in ./train/env_train
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0025', 'true negative:0.9293')
('false positive:0.0656', 'false negative:0.0025')
('predict:p@1:8.6754%', 'p@10:33.9625%')
Env epoch 2 lr 0.0005 time 957.0411 ppl [3.92181134] pr_loss [3.03794789] pu_loss [0.88386357]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0022', 'true negative:0.9347')
('false positive:0.0599', 'false negative:0.0032')
('predict:p@1:8.4908%', 'p@10:28.4202%')
        dev_set, ppl [4.28973961] pr_loss [3.21021891] pu_loss [1.07952034] best_p@10 [0.2582]
Get testing data:len(dataset) is 1720 
Confusion matrix for purchase prediction:
('true positive:0.0016', 'true negative:0.9379')
('false positive:0.0578', 'false negative:0.0026')
('predict:p@1:7.7867%', 'p@10:31.0765%')
        test_set, ppl [4.12048388] pr_loss [3.19682789] pu_loss [0.92365623] best_p@10 [0.2842]
Saving env model params in ./train/env_train
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0028', 'true negative:0.9403')
('false positive:0.0546', 'false negative:0.0023')
('predict:p@1:10.0607%', 'p@10:38.7006%')
Env epoch 3 lr 0.0005 time 957.6127 ppl [3.78203750] pr_loss [2.94796062] pu_loss [0.83407706]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0018', 'true negative:0.9468')
('false positive:0.0477', 'false negative:0.0037')
('predict:p@1:8.8929%', 'p@10:30.5904%')
        dev_set, ppl [4.45521402] pr_loss [3.25289202] pu_loss [1.20232224] best_p@10 [0.2842]
Get testing data:len(dataset) is 1720 
Confusion matrix for purchase prediction:
('true positive:0.0011', 'true negative:0.9515')
('false positive:0.0442', 'false negative:0.0031')
('predict:p@1:8.1021%', 'p@10:32.9428%')
        test_set, ppl [4.23783493] pr_loss [3.22790051] pu_loss [1.00993395] best_p@10 [0.3059]
Saving env model params in ./train/env_train
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0029', 'true negative:0.9486')
('false positive:0.0463', 'false negative:0.0021')
('predict:p@1:11.2318%', 'p@10:42.7759%')
Env epoch 4 lr 0.0005 time 957.5441 ppl [3.66276145] pr_loss [2.86722779] pu_loss [0.79553396]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0016', 'true negative:0.9552')
('false positive:0.0394', 'false negative:0.0039')
('predict:p@1:8.6877%', 'p@10:31.9638%')
        dev_set, ppl [4.72287226] pr_loss [3.29991961] pu_loss [1.42295218] best_p@10 [0.3059]
Get testing data:len(dataset) is 1720 
Confusion matrix for purchase prediction:
('true positive:0.0012', 'true negative:0.9577')
('false positive:0.0380', 'false negative:0.0030')
('predict:p@1:8.6835%', 'p@10:34.2570%')
        test_set, ppl [4.36141777] pr_loss [3.25877380] pu_loss [1.10264385] best_p@10 [0.3196]
Saving env model params in ./train/env_train
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0031', 'true negative:0.9541')
('false positive:0.0408', 'false negative:0.0020')
('predict:p@1:12.3988%', 'p@10:46.4265%')
Env epoch 5 lr 0.0005 time 956.4559 ppl [3.54965305] pr_loss [2.78640223] pu_loss [0.76325083]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0015', 'true negative:0.9619')
('false positive:0.0327', 'false negative:0.0040')
('predict:p@1:8.7904%', 'p@10:32.7157%')
        dev_set, ppl [4.88733912] pr_loss [3.33860016] pu_loss [1.54873908] best_p@10 [0.3196]
Get testing data:len(dataset) is 1720 
Confusion matrix for purchase prediction:
('true positive:0.0012', 'true negative:0.9631')
('false positive:0.0326', 'false negative:0.0031')
('predict:p@1:9.4389%', 'p@10:34.8210%')
        test_set, ppl [4.51887512] pr_loss [3.29317617] pu_loss [1.22569931] best_p@10 [0.3272]
Saving env model params in ./train/env_train
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0033', 'true negative:0.9574')
('false positive:0.0375', 'false negative:0.0018')
('predict:p@1:13.7816%', 'p@10:49.9372%')
Env epoch 6 lr 0.0005 time 956.3666 ppl [3.42704558] pr_loss [2.69811249] pu_loss [0.72893333]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0013', 'true negative:0.9650')
('false positive:0.0295', 'false negative:0.0041')
('predict:p@1:9.0368%', 'p@10:32.6443%')
        dev_set, ppl [5.13219690] pr_loss [3.39060020] pu_loss [1.74159610] best_p@10 [0.3272]
Get testing data:len(dataset) is 1720 
Confusion matrix for purchase prediction:
('true positive:0.0008', 'true negative:0.9668')
('false positive:0.0289', 'false negative:0.0035')
('predict:p@1:9.2788%', 'p@10:35.0060%')
        test_set, ppl [4.62104607] pr_loss [3.32767320] pu_loss [1.29337335] best_p@10 [0.3272]
Saving env model params in ./train/env_train
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0035', 'true negative:0.9602')
('false positive:0.0347', 'false negative:0.0016')
('predict:p@1:15.3116%', 'p@10:53.4705%')
Env epoch 7 lr 0.0005 time 958.0769 ppl [3.28197050] pr_loss [2.59686518] pu_loss [0.68510568]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0013', 'true negative:0.9686')
('false positive:0.0259', 'false negative:0.0042')
('predict:p@1:9.2323%', 'p@10:33.4093%')
        dev_set, ppl [5.40205288] pr_loss [3.45498085] pu_loss [1.94707203] best_p@10 [0.3272]
Get testing data:len(dataset) is 1720 
Confusion matrix for purchase prediction:
('true positive:0.0006', 'true negative:0.9679')
('false positive:0.0278', 'false negative:0.0037')
('predict:p@1:9.3355%', 'p@10:35.4946%')
        test_set, ppl [4.81193924] pr_loss [3.38073921] pu_loss [1.43119979] best_p@10 [0.3341]
Saving env model params in ./train/env_train
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0036', 'true negative:0.9632')
('false positive:0.0317', 'false negative:0.0015')
('predict:p@1:17.1048%', 'p@10:56.9339%')
Env epoch 8 lr 0.0005 time 957.1103 ppl [3.12235403] pr_loss [2.48078370] pu_loss [0.64157057]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0009', 'true negative:0.9716')
('false positive:0.0230', 'false negative:0.0046')
('predict:p@1:9.1257%', 'p@10:33.5244%')
        dev_set, ppl [5.74363756] pr_loss [3.55002761] pu_loss [2.19360995] best_p@10 [0.3341]
Get testing data:len(dataset) is 1720 
Confusion matrix for purchase prediction:
('true positive:0.0008', 'true negative:0.9720')
('false positive:0.0238', 'false negative:0.0035')
('predict:p@1:9.3295%', 'p@10:35.4667%')
        test_set, ppl [5.01737356] pr_loss [3.46229529] pu_loss [1.55507886] best_p@10 [0.3352]
Saving env model params in ./train/env_train
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0038', 'true negative:0.9661')
('false positive:0.0288', 'false negative:0.0013')
('predict:p@1:19.1703%', 'p@10:60.4433%')
Env epoch 9 lr 0.0005 time 956.9671 ppl [2.95395994] pr_loss [2.35503054] pu_loss [0.59892958]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0010', 'true negative:0.9712')
('false positive:0.0234', 'false negative:0.0045')
('predict:p@1:9.0521%', 'p@10:33.2483%')
        dev_set, ppl [5.90756655] pr_loss [3.65301991] pu_loss [2.25454712] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0039', 'true negative:0.9686')
('false positive:0.0263', 'false negative:0.0011')
('predict:p@1:21.4904%', 'p@10:63.7978%')
Env epoch 10 lr 0.0005 time 957.4998 ppl [2.78257585] pr_loss [2.22715092] pu_loss [0.55542493]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0009', 'true negative:0.9740')
('false positive:0.0206', 'false negative:0.0046')
('predict:p@1:9.0721%', 'p@10:33.4184%')
        dev_set, ppl [6.32280779] pr_loss [3.76216698] pu_loss [2.56064105] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0041', 'true negative:0.9716')
('false positive:0.0233', 'false negative:0.0010')
('predict:p@1:24.1286%', 'p@10:67.0854%')
Env epoch 11 lr 0.0005 time 956.1643 ppl [2.60230660] pr_loss [2.10170269] pu_loss [0.50060391]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0011', 'true negative:0.9751')
('false positive:0.0195', 'false negative:0.0044')
('predict:p@1:8.7554%', 'p@10:33.1664%')
        dev_set, ppl [6.83352900] pr_loss [3.90173674] pu_loss [2.93179202] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0042', 'true negative:0.9739')
('false positive:0.0210', 'false negative:0.0009')
('predict:p@1:27.2998%', 'p@10:70.1342%')
Env epoch 12 lr 0.0005 time 956.5203 ppl [2.44488835] pr_loss [1.97932136] pu_loss [0.46556708]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0009', 'true negative:0.9748')
('false positive:0.0198', 'false negative:0.0045')
('predict:p@1:8.2533%', 'p@10:33.4868%')
        dev_set, ppl [7.37609243] pr_loss [4.04890537] pu_loss [3.32718658] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0043', 'true negative:0.9760')
('false positive:0.0189', 'false negative:0.0008')
('predict:p@1:30.7497%', 'p@10:73.0447%')
Env epoch 13 lr 0.0005 time 957.9634 ppl [2.28086090] pr_loss [1.86057067] pu_loss [0.42029023]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0009', 'true negative:0.9731')
('false positive:0.0215', 'false negative:0.0045')
('predict:p@1:7.8029%', 'p@10:33.0422%')
        dev_set, ppl [7.93712997] pr_loss [4.18271494] pu_loss [3.75441456] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0043', 'true negative:0.9778')
('false positive:0.0171', 'false negative:0.0007')
('predict:p@1:34.6015%', 'p@10:75.7463%')
Env epoch 14 lr 0.0005 time 957.2852 ppl [2.13871241] pr_loss [1.74475145] pu_loss [0.39396092]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0007', 'true negative:0.9748')
('false positive:0.0197', 'false negative:0.0048')
('predict:p@1:7.7297%', 'p@10:32.6618%')
        dev_set, ppl [8.87345505] pr_loss [4.36742163] pu_loss [4.50603294] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0044', 'true negative:0.9791')
('false positive:0.0158', 'false negative:0.0007')
('predict:p@1:38.7192%', 'p@10:78.2360%')
Env epoch 15 lr 0.0005 time 956.8251 ppl [2.00058794] pr_loss [1.63113177] pu_loss [0.36945632]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0007', 'true negative:0.9747')
('false positive:0.0198', 'false negative:0.0048')
('predict:p@1:7.2487%', 'p@10:32.5986%')
        dev_set, ppl [8.93334389] pr_loss [4.50922680] pu_loss [4.42411613] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0045', 'true negative:0.9805')
('false positive:0.0144', 'false negative:0.0006')
('predict:p@1:42.6184%', 'p@10:80.4477%')
Env epoch 16 lr 0.0005 time 956.9630 ppl [1.85175538] pr_loss [1.52395761] pu_loss [0.32779780]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0007', 'true negative:0.9748')
('false positive:0.0198', 'false negative:0.0048')
('predict:p@1:6.8348%', 'p@10:32.2160%')
        dev_set, ppl [9.77574348] pr_loss [4.66654539] pu_loss [5.10919857] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0045', 'true negative:0.9813')
('false positive:0.0136', 'false negative:0.0006')
('predict:p@1:46.9048%', 'p@10:82.5288%')
Env epoch 17 lr 0.0005 time 955.6675 ppl [1.74795473] pr_loss [1.41805041] pu_loss [0.32990429]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0006', 'true negative:0.9746')
('false positive:0.0199', 'false negative:0.0049')
('predict:p@1:6.7592%', 'p@10:32.3620%')
        dev_set, ppl [10.04934502] pr_loss [4.87239170] pu_loss [5.17695427] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0045', 'true negative:0.9822')
('false positive:0.0127', 'false negative:0.0006')
('predict:p@1:50.8087%', 'p@10:84.2624%')
Env epoch 18 lr 0.0005 time 955.9484 ppl [1.63291430] pr_loss [1.31998420] pu_loss [0.31293014]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0008', 'true negative:0.9695')
('false positive:0.0251', 'false negative:0.0047')
('predict:p@1:6.8358%', 'p@10:31.8836%')
        dev_set, ppl [9.91015053] pr_loss [5.02100754] pu_loss [4.88914394] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0046', 'true negative:0.9831')
('false positive:0.0118', 'false negative:0.0005')
('predict:p@1:54.5733%', 'p@10:85.8563%')
Env epoch 19 lr 0.0005 time 958.0617 ppl [1.51016855] pr_loss [1.22549486] pu_loss [0.28467366]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0006', 'true negative:0.9738')
('false positive:0.0207', 'false negative:0.0049')
('predict:p@1:6.9105%', 'p@10:32.1513%')
        dev_set, ppl [11.24964428] pr_loss [5.15333033] pu_loss [6.09631395] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0046', 'true negative:0.9839')
('false positive:0.0110', 'false negative:0.0005')
('predict:p@1:57.9543%', 'p@10:87.2509%')
Env epoch 20 lr 0.0005 time 956.8103 ppl [1.41384089] pr_loss [1.13786149] pu_loss [0.27597940]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0009', 'true negative:0.9695')
('false positive:0.0251', 'false negative:0.0046')
('predict:p@1:6.4864%', 'p@10:32.3446%')
        dev_set, ppl [10.70946693] pr_loss [5.32629728] pu_loss [5.38316965] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0046', 'true negative:0.9845')
('false positive:0.0104', 'false negative:0.0005')
('predict:p@1:60.9714%', 'p@10:88.4506%')
Env epoch 21 lr 0.0005 time 957.0535 ppl [1.32429934] pr_loss [1.06036353] pu_loss [0.26393574]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0008', 'true negative:0.9717')
('false positive:0.0228', 'false negative:0.0046')
('predict:p@1:6.3034%', 'p@10:32.5909%')
        dev_set, ppl [11.33670139] pr_loss [5.43379307] pu_loss [5.90290737] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0046', 'true negative:0.9850')
('false positive:0.0100', 'false negative:0.0005')
('predict:p@1:63.7425%', 'p@10:89.5831%')
Env epoch 22 lr 0.0005 time 957.0614 ppl [1.24297416] pr_loss [0.98200393] pu_loss [0.26097023]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0010', 'true negative:0.9708')
('false positive:0.0238', 'false negative:0.0045')
('predict:p@1:6.3029%', 'p@10:32.3782%')
        dev_set, ppl [11.52508545] pr_loss [5.62197447] pu_loss [5.90311098] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0046', 'true negative:0.9856')
('false positive:0.0094', 'false negative:0.0004')
('predict:p@1:66.2814%', 'p@10:90.4880%')
Env epoch 23 lr 0.0005 time 955.7551 ppl [1.16406536] pr_loss [0.91441739] pu_loss [0.24964793]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0010', 'true negative:0.9651')
('false positive:0.0294', 'false negative:0.0045')
('predict:p@1:6.5187%', 'p@10:32.3504%')
        dev_set, ppl [11.43119049] pr_loss [5.72384977] pu_loss [5.70734215] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0046', 'true negative:0.9862')
('false positive:0.0087', 'false negative:0.0005')
('predict:p@1:68.4176%', 'p@10:91.3685%')
Env epoch 24 lr 0.0005 time 955.8716 ppl [1.09398341] pr_loss [0.85214806] pu_loss [0.24183531]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0008', 'true negative:0.9689')
('false positive:0.0257', 'false negative:0.0047')
('predict:p@1:6.2578%', 'p@10:31.4464%')
        dev_set, ppl [12.50841713] pr_loss [5.84321356] pu_loss [6.66520357] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0046', 'true negative:0.9863')
('false positive:0.0086', 'false negative:0.0004')
('predict:p@1:70.1803%', 'p@10:92.1730%')
Env epoch 25 lr 0.0005 time 956.3407 ppl [1.03685701] pr_loss [0.79852599] pu_loss [0.23833092]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0013', 'true negative:0.9626')
('false positive:0.0319', 'false negative:0.0041')
('predict:p@1:6.3270%', 'p@10:31.7318%')
        dev_set, ppl [11.98326302] pr_loss [5.94262171] pu_loss [6.04064083] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0046', 'true negative:0.9864')
('false positive:0.0085', 'false negative:0.0005')
('predict:p@1:71.7214%', 'p@10:92.8757%')
Env epoch 26 lr 0.0005 time 956.5680 ppl [1.00546527] pr_loss [0.75225049] pu_loss [0.25321469]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0011', 'true negative:0.9653')
('false positive:0.0292', 'false negative:0.0044')
('predict:p@1:5.9172%', 'p@10:32.0611%')
        dev_set, ppl [12.32889271] pr_loss [6.12106657] pu_loss [6.20782804] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0047', 'true negative:0.9869')
('false positive:0.0080', 'false negative:0.0004')
('predict:p@1:72.9826%', 'p@10:93.4809%')
Env epoch 27 lr 0.0005 time 956.1581 ppl [0.93615294] pr_loss [0.70736426] pu_loss [0.22878864]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0010', 'true negative:0.9664')
('false positive:0.0282', 'false negative:0.0044')
('predict:p@1:5.8886%', 'p@10:31.7135%')
        dev_set, ppl [12.58801174] pr_loss [6.20358181] pu_loss [6.38442898] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0046', 'true negative:0.9871')
('false positive:0.0078', 'false negative:0.0004')
('predict:p@1:74.1893%', 'p@10:94.0457%')
Env epoch 28 lr 0.0005 time 954.3706 ppl [0.90487629] pr_loss [0.66693431] pu_loss [0.23794204]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0012', 'true negative:0.9598')
('false positive:0.0348', 'false negative:0.0043')
('predict:p@1:6.0116%', 'p@10:31.7336%')
        dev_set, ppl [12.52117348] pr_loss [6.28948975] pu_loss [6.23168230] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0046', 'true negative:0.9872')
('false positive:0.0077', 'false negative:0.0004')
('predict:p@1:75.0956%', 'p@10:94.4677%')
Env epoch 29 lr 0.0005 time 955.4443 ppl [0.86148942] pr_loss [0.63220692] pu_loss [0.22928244]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0008', 'true negative:0.9633')
('false positive:0.0313', 'false negative:0.0047')
('predict:p@1:5.8788%', 'p@10:31.4573%')
        dev_set, ppl [13.12219048] pr_loss [6.40966511] pu_loss [6.71252441] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0047', 'true negative:0.9876')
('false positive:0.0073', 'false negative:0.0004')
('predict:p@1:75.9709%', 'p@10:94.9027%')
Env epoch 30 lr 0.0005 time 957.0148 ppl [0.82334769] pr_loss [0.60223490] pu_loss [0.22111282]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0012', 'true negative:0.9612')
('false positive:0.0333', 'false negative:0.0043')
('predict:p@1:6.2470%', 'p@10:31.6054%')
        dev_set, ppl [13.59225273] pr_loss [6.51541471] pu_loss [7.07683659] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0047', 'true negative:0.9877')
('false positive:0.0072', 'false negative:0.0004')
('predict:p@1:76.5920%', 'p@10:95.3269%')
Env epoch 31 lr 0.0005 time 956.2972 ppl [0.79070365] pr_loss [0.57334787] pu_loss [0.21735576]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0007', 'true negative:0.9648')
('false positive:0.0297', 'false negative:0.0047')
('predict:p@1:6.0048%', 'p@10:31.8120%')
        dev_set, ppl [13.45582199] pr_loss [6.52814150] pu_loss [6.92768049] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0047', 'true negative:0.9880')
('false positive:0.0069', 'false negative:0.0004')
('predict:p@1:77.2838%', 'p@10:95.6464%')
Env epoch 32 lr 0.0005 time 957.0005 ppl [0.76648474] pr_loss [0.54834068] pu_loss [0.21814412]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0009', 'true negative:0.9678')
('false positive:0.0268', 'false negative:0.0046')
('predict:p@1:6.0909%', 'p@10:31.1485%')
        dev_set, ppl [13.52964973] pr_loss [6.54122353] pu_loss [6.98842430] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0047', 'true negative:0.9883')
('false positive:0.0066', 'false negative:0.0004')
('predict:p@1:77.7200%', 'p@10:95.9704%')
Env epoch 33 lr 0.0005 time 957.9140 ppl [0.72882855] pr_loss [0.52705020] pu_loss [0.20177843]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0010', 'true negative:0.9629')
('false positive:0.0316', 'false negative:0.0045')
('predict:p@1:6.1209%', 'p@10:31.0749%')
        dev_set, ppl [13.88069820] pr_loss [6.70183086] pu_loss [7.17886734] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0047', 'true negative:0.9884')
('false positive:0.0066', 'false negative:0.0004')
('predict:p@1:78.1895%', 'p@10:96.2759%')
Env epoch 34 lr 0.0005 time 956.0997 ppl [0.71776277] pr_loss [0.50665969] pu_loss [0.21110313]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0009', 'true negative:0.9635')
('false positive:0.0310', 'false negative:0.0045')
('predict:p@1:5.9177%', 'p@10:31.0094%')
        dev_set, ppl [14.17369556] pr_loss [6.76476526] pu_loss [7.40892935] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0047', 'true negative:0.9885')
('false positive:0.0065', 'false negative:0.0004')
('predict:p@1:78.6111%', 'p@10:96.4890%')
Env epoch 35 lr 0.0005 time 956.1862 ppl [0.71460384] pr_loss [0.48807263] pu_loss [0.22653122]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0007', 'true negative:0.9662')
('false positive:0.0283', 'false negative:0.0048')
('predict:p@1:5.9317%', 'p@10:31.4797%')
        dev_set, ppl [14.11352921] pr_loss [6.84449959] pu_loss [7.26902866] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0047', 'true negative:0.9888')
('false positive:0.0062', 'false negative:0.0004')
('predict:p@1:78.8786%', 'p@10:96.6710%')
Env epoch 36 lr 0.0005 time 960.1020 ppl [0.67234731] pr_loss [0.47174793] pu_loss [0.20059936]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0007', 'true negative:0.9688')
('false positive:0.0257', 'false negative:0.0047')
('predict:p@1:6.0686%', 'p@10:30.8829%')
        dev_set, ppl [14.56014919] pr_loss [6.96459389] pu_loss [7.59555674] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0047', 'true negative:0.9890')
('false positive:0.0060', 'false negative:0.0004')
('predict:p@1:79.2379%', 'p@10:96.8835%')
Env epoch 37 lr 0.0005 time 958.0390 ppl [0.66371971] pr_loss [0.45403683] pu_loss [0.20968294]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0008', 'true negative:0.9594')
('false positive:0.0352', 'false negative:0.0047')
('predict:p@1:6.0392%', 'p@10:31.3176%')
        dev_set, ppl [13.88640308] pr_loss [6.99225140] pu_loss [6.89415169] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0047', 'true negative:0.9890')
('false positive:0.0060', 'false negative:0.0004')
('predict:p@1:79.4188%', 'p@10:97.0767%')
Env epoch 38 lr 0.0005 time 957.2928 ppl [0.65457511] pr_loss [0.44324028] pu_loss [0.21133484]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0009', 'true negative:0.9655')
('false positive:0.0290', 'false negative:0.0046')
('predict:p@1:5.8388%', 'p@10:30.5145%')
        dev_set, ppl [14.76270294] pr_loss [7.08165646] pu_loss [7.68104887] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0047', 'true negative:0.9893')
('false positive:0.0056', 'false negative:0.0004')
('predict:p@1:79.7816%', 'p@10:97.2368%')
Env epoch 39 lr 0.0005 time 958.5886 ppl [0.62459737] pr_loss [0.43005371] pu_loss [0.19454366]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0009', 'true negative:0.9684')
('false positive:0.0261', 'false negative:0.0045')
('predict:p@1:6.2279%', 'p@10:30.7261%')
        dev_set, ppl [14.80700493] pr_loss [7.07067156] pu_loss [7.73633432] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0047', 'true negative:0.9893')
('false positive:0.0056', 'false negative:0.0004')
('predict:p@1:79.9100%', 'p@10:97.4026%')
Env epoch 40 lr 0.0005 time 956.6329 ppl [0.63043392] pr_loss [0.42040873] pu_loss [0.21002513]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0012', 'true negative:0.9649')
('false positive:0.0297', 'false negative:0.0043')
('predict:p@1:5.9009%', 'p@10:30.6540%')
        dev_set, ppl [13.41977692] pr_loss [7.13138008] pu_loss [6.28839684] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0047', 'true negative:0.9894')
('false positive:0.0055', 'false negative:0.0004')
('predict:p@1:80.2081%', 'p@10:97.5499%')
Env epoch 41 lr 0.0005 time 956.6228 ppl [0.61341006] pr_loss [0.40993437] pu_loss [0.20347568]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0008', 'true negative:0.9667')
('false positive:0.0278', 'false negative:0.0047')
('predict:p@1:6.2275%', 'p@10:30.7889%')
        dev_set, ppl [14.01668453] pr_loss [7.09178972] pu_loss [6.92489386] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0047', 'true negative:0.9896')
('false positive:0.0053', 'false negative:0.0004')
('predict:p@1:80.3432%', 'p@10:97.6712%')
Env epoch 42 lr 0.0005 time 958.3636 ppl [0.61138105] pr_loss [0.39962363] pu_loss [0.21175745]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0009', 'true negative:0.9669')
('false positive:0.0276', 'false negative:0.0046')
('predict:p@1:6.0646%', 'p@10:30.4598%')
        dev_set, ppl [13.46963596] pr_loss [7.09774446] pu_loss [6.37189341] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0047', 'true negative:0.9899')
('false positive:0.0050', 'false negative:0.0004')
('predict:p@1:80.4012%', 'p@10:97.7903%')
Env epoch 43 lr 0.0005 time 958.6275 ppl [0.57931036] pr_loss [0.39162299] pu_loss [0.18768738]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0010', 'true negative:0.9683')
('false positive:0.0262', 'false negative:0.0045')
('predict:p@1:6.3578%', 'p@10:31.0216%')
        dev_set, ppl [15.26978779] pr_loss [7.13143682] pu_loss [8.13835049] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0047', 'true negative:0.9898')
('false positive:0.0051', 'false negative:0.0004')
('predict:p@1:80.5650%', 'p@10:97.9046%')
Env epoch 44 lr 0.0005 time 959.3011 ppl [0.58591503] pr_loss [0.38416892] pu_loss [0.20174609]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0013', 'true negative:0.9663')
('false positive:0.0282', 'false negative:0.0041')
('predict:p@1:5.6719%', 'p@10:30.4308%')
        dev_set, ppl [14.36541367] pr_loss [7.20884275] pu_loss [7.15657234] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0047', 'true negative:0.9899')
('false positive:0.0051', 'false negative:0.0003')
('predict:p@1:80.7739%', 'p@10:97.9580%')
Env epoch 45 lr 0.0005 time 958.8834 ppl [0.57090622] pr_loss [0.37626854] pu_loss [0.19463764]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0010', 'true negative:0.9705')
('false positive:0.0241', 'false negative:0.0044')
('predict:p@1:6.4609%', 'p@10:30.8778%')
        dev_set, ppl [15.42563438] pr_loss [7.24988985] pu_loss [8.17574406] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0047', 'true negative:0.9899')
('false positive:0.0050', 'false negative:0.0004')
('predict:p@1:80.9275%', 'p@10:98.0666%')
Env epoch 46 lr 0.0005 time 957.4717 ppl [0.58759153] pr_loss [0.36880547] pu_loss [0.21878606]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0011', 'true negative:0.9687')
('false positive:0.0258', 'false negative:0.0044')
('predict:p@1:6.1765%', 'p@10:30.7318%')
        dev_set, ppl [14.97214985] pr_loss [7.37285709] pu_loss [7.59929180] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0047', 'true negative:0.9898')
('false positive:0.0051', 'false negative:0.0004')
('predict:p@1:81.0631%', 'p@10:98.1345%')
Env epoch 47 lr 0.0005 time 957.6805 ppl [0.53579032] pr_loss [0.35980204] pu_loss [0.17598835]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0010', 'true negative:0.9686')
('false positive:0.0259', 'false negative:0.0045')
('predict:p@1:5.9159%', 'p@10:30.8823%')
        dev_set, ppl [15.00323963] pr_loss [7.37454748] pu_loss [7.62869310] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0048', 'true negative:0.9902')
('false positive:0.0048', 'false negative:0.0003')
('predict:p@1:81.2415%', 'p@10:98.2309%')
Env epoch 48 lr 0.0005 time 959.2972 ppl [0.53298736] pr_loss [0.35234952] pu_loss [0.18063775]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0011', 'true negative:0.9692')
('false positive:0.0253', 'false negative:0.0043')
('predict:p@1:6.0447%', 'p@10:31.0966%')
        dev_set, ppl [15.00614071] pr_loss [7.42736769] pu_loss [7.57877398] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0047', 'true negative:0.9903')
('false positive:0.0046', 'false negative:0.0004')
('predict:p@1:81.3773%', 'p@10:98.2949%')
Env epoch 49 lr 0.0005 time 958.9417 ppl [0.52981508] pr_loss [0.34494451] pu_loss [0.18487056]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0010', 'true negative:0.9702')
('false positive:0.0244', 'false negative:0.0045')
('predict:p@1:6.0790%', 'p@10:30.6182%')
        dev_set, ppl [15.52652550] pr_loss [7.44387293] pu_loss [8.08265495] best_p@10 [0.3352]
------env train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0048', 'true negative:0.9903')
('false positive:0.0046', 'false negative:0.0003')
('predict:p@1:81.5013%', 'p@10:98.3751%')
Env epoch 50 lr 0.0005 time 959.1684 ppl [0.51717150] pr_loss [0.34077701] pu_loss [0.17639449]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0012', 'true negative:0.9694')
('false positive:0.0252', 'false negative:0.0043')
('predict:p@1:5.9747%', 'p@10:30.1977%')
        dev_set, ppl [14.94984150] pr_loss [7.47515154] pu_loss [7.47469139] best_p@10 [0.3352]
------env train finish-------
1000 interactions finished after 48.6724s 
Dis epoch 1 learning rate 0.0001 epoch-time 3856.6303 perplexity [0.52404290] acc 70.6134%
------dis train finish-------
Dis epoch 2 learning rate 0.0001 epoch-time 3852.7967 perplexity [0.23508263] acc 91.4411%
------dis train finish-------
Dis epoch 3 learning rate 0.0001 epoch-time 3854.0826 perplexity [0.10530912] acc 96.8536%
------dis train finish-------
200 interactions finished after 111.5370s 
Get training data:len(dataset) is 65485 
Agn epoch 51 learning rate 0.0001 epoch-time 2749.5787 loss [3.01704288] p@10 96.0487% p@1 74.6165%
Get testing data:len(dataset) is 1718 
        dev_set, loss [33.90171814] p@10 30.7040% p@1 7.1204%
Get testing data:len(dataset) is 1720 
        test_set, loss [32.26890564] p@10 32.8146% p@1 6.4901%
Saving agn model params in ./train/agn_train
------agn train finish-------
200 interactions finished after 112.4930s 
Get training data:len(dataset) is 65685 
Agn epoch 52 learning rate 0.0001 epoch-time 2754.7606 loss [2.95609903] p@10 96.2122% p@1 74.8980%
Get testing data:len(dataset) is 1718 
        dev_set, loss [33.89929581] p@10 30.8452% p@1 7.1901%
Get testing data:len(dataset) is 1720 
        test_set, loss [32.34907913] p@10 32.7898% p@1 6.4011%
Saving agn model params in ./train/agn_train
------agn train finish-------
200 interactions finished after 101.4742s 
Get training data:len(dataset) is 65885 
Agn epoch 53 learning rate 0.0001 epoch-time 2758.8437 loss [2.89923620] p@10 96.3687% p@1 75.2147%
Get testing data:len(dataset) is 1718 
        dev_set, loss [34.02853775] p@10 30.7659% p@1 7.2888%
Get testing data:len(dataset) is 1720 
        test_set, loss [32.38500595] p@10 32.7949% p@1 6.5384%
Saving agn model params in ./train/agn_train
------agn train finish-------
Get training data:len(dataset) is 601 
Env epoch 51 lr 0.0005 time 8.4307 ppl [9.91804790] pr_loss [0.00000000] pu_loss [0.00000000]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0012', 'true negative:0.9641')
('false positive:0.0304', 'false negative:0.0042')
('predict:p@1:5.9126%', 'p@10:30.3730%')
        dev_set, ppl [14.58464336] pr_loss [7.55126524] pu_loss [7.03337765] best_p@10 [0.3352]
------env pg train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0048', 'true negative:0.9904')
('false positive:0.0045', 'false negative:0.0003')
('predict:p@1:81.4485%', 'p@10:98.4088%')
Env epoch 52 lr 0.0005 time 962.1619 ppl [0.52837306] pr_loss [0.33920431] pu_loss [0.18916880]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0010', 'true negative:0.9709')
('false positive:0.0236', 'false negative:0.0045')
('predict:p@1:5.8996%', 'p@10:30.3388%')
        dev_set, ppl [15.48560810] pr_loss [7.44161177] pu_loss [8.04399490] best_p@10 [0.3352]
------env train finish-------
200 interactions finished after 118.9482s 
Get training data:len(dataset) is 66085 
Agn epoch 54 learning rate 0.0001 epoch-time 2770.4252 loss [2.85094690] p@10 96.5382% p@1 75.4258%
Get testing data:len(dataset) is 1718 
        dev_set, loss [34.07378769] p@10 30.9507% p@1 7.2537%
------agn train finish-------
200 interactions finished after 112.8029s 
Get training data:len(dataset) is 66285 
Agn epoch 55 learning rate 0.0001 epoch-time 2770.4324 loss [2.80075431] p@10 96.6610% p@1 75.7056%
Get testing data:len(dataset) is 1718 
        dev_set, loss [34.15386581] p@10 30.8299% p@1 7.1923%
------agn train finish-------
200 interactions finished after 111.3264s 
Get training data:len(dataset) is 66485 
Agn epoch 56 learning rate 0.0001 epoch-time 2776.2291 loss [2.74798107] p@10 96.7942% p@1 75.9298%
Get testing data:len(dataset) is 1718 
        dev_set, loss [34.20053482] p@10 30.7108% p@1 7.1700%
------agn train finish-------
Get training data:len(dataset) is 1201 
Env epoch 53 lr 0.0005 time 12.7573 ppl [6.68939829] pr_loss [0.00000000] pu_loss [0.00000000]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0017', 'true negative:0.9534')
('false positive:0.0411', 'false negative:0.0038')
('predict:p@1:5.9197%', 'p@10:30.0612%')
        dev_set, ppl [13.88988781] pr_loss [7.83405876] pu_loss [6.05582619] best_p@10 [0.3352]
------env pg train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0048', 'true negative:0.9901')
('false positive:0.0048', 'false negative:0.0003')
('predict:p@1:81.6906%', 'p@10:98.4474%')
Env epoch 54 lr 0.0005 time 961.3757 ppl [0.51275164] pr_loss [0.33678138] pu_loss [0.17597027]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0012', 'true negative:0.9685')
('false positive:0.0260', 'false negative:0.0043')
('predict:p@1:6.0953%', 'p@10:30.3643%')
        dev_set, ppl [14.65069199] pr_loss [7.47693253] pu_loss [7.17376041] best_p@10 [0.3352]
------env train finish-------
200 interactions finished after 106.8479s 
Get training data:len(dataset) is 66685 
Agn epoch 57 learning rate 0.0001 epoch-time 2784.9995 loss [2.70589089] p@10 96.9387% p@1 76.1701%
Get testing data:len(dataset) is 1718 
        dev_set, loss [34.27012634] p@10 30.7766% p@1 7.0318%
------agn train finish-------
200 interactions finished after 104.6209s 
Get training data:len(dataset) is 66885 
Agn epoch 58 learning rate 0.0001 epoch-time 2867.4482 loss [2.65969849] p@10 97.0454% p@1 76.3742%
Get testing data:len(dataset) is 1718 
        dev_set, loss [34.31570816] p@10 30.7652% p@1 7.1615%
------agn train finish-------
200 interactions finished after 115.1731s 
Get training data:len(dataset) is 67085 
Agn epoch 59 learning rate 0.0001 epoch-time 2869.9526 loss [2.61795402] p@10 97.1633% p@1 76.5781%
Get testing data:len(dataset) is 1718 
        dev_set, loss [34.40988159] p@10 30.6898% p@1 7.1826%
------agn train finish-------
Get training data:len(dataset) is 1801 
Env epoch 55 lr 0.0005 time 19.7186 ppl [5.66170883] pr_loss [0.00000000] pu_loss [0.00000000]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0018', 'true negative:0.9445')
('false positive:0.0501', 'false negative:0.0037')
('predict:p@1:5.9481%', 'p@10:30.2007%')
        dev_set, ppl [13.29154205] pr_loss [7.77869177] pu_loss [5.51285028] best_p@10 [0.3352]
------env pg train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0048', 'true negative:0.9900')
('false positive:0.0050', 'false negative:0.0003')
('predict:p@1:81.7988%', 'p@10:98.5309%')
Env epoch 56 lr 0.0005 time 996.6678 ppl [0.49411958] pr_loss [0.32909894] pu_loss [0.16502064]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0009', 'true negative:0.9692')
('false positive:0.0254', 'false negative:0.0046')
('predict:p@1:6.0562%', 'p@10:29.8337%')
        dev_set, ppl [15.47387314] pr_loss [7.60238886] pu_loss [7.87148476] best_p@10 [0.3352]
------env train finish-------
Dis epoch 4 learning rate 0.0001 epoch-time 3972.6741 perplexity [0.68725610] acc 70.8737%
------dis train finish-------
Dis epoch 5 learning rate 0.0001 epoch-time 3898.8033 perplexity [0.27949563] acc 89.0059%
------dis train finish-------
Dis epoch 6 learning rate 0.0001 epoch-time 3883.7169 perplexity [0.14566270] acc 95.0537%
------dis train finish-------
*************************
200 interactions finished after 115.4512s 
Get training data:len(dataset) is 67285 
Agn epoch 60 learning rate 0.0001 epoch-time 2900.9398 loss [2.57732320] p@10 97.2523% p@1 76.7775%
Get testing data:len(dataset) is 1718 
        dev_set, loss [34.40877151] p@10 30.9020% p@1 7.2324%
------agn train finish-------
200 interactions finished after 107.4934s 
Get training data:len(dataset) is 67485 
Agn epoch 61 learning rate 0.0001 epoch-time 2833.4465 loss [2.54114056] p@10 97.3673% p@1 76.9423%
Get testing data:len(dataset) is 1718 
        dev_set, loss [34.55315781] p@10 30.8888% p@1 7.2510%
------agn train finish-------
200 interactions finished after 107.2988s 
Get training data:len(dataset) is 67685 
Agn epoch 62 learning rate 0.0001 epoch-time 2879.4073 loss [2.50613761] p@10 97.4627% p@1 77.0920%
Get testing data:len(dataset) is 1718 
        dev_set, loss [34.57620239] p@10 30.5953% p@1 7.3253%
Get testing data:len(dataset) is 1720 
        test_set, loss [32.73603058] p@10 32.8685% p@1 6.9152%
Saving agn model params in ./train/agn_train
------agn train finish-------
Get training data:len(dataset) is 2401 
Env epoch 57 lr 0.0005 time 26.1166 ppl [4.07900620] pr_loss [0.00000000] pu_loss [0.00000000]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0016', 'true negative:0.9336')
('false positive:0.0609', 'false negative:0.0039')
('predict:p@1:5.7907%', 'p@10:29.5865%')
        dev_set, ppl [13.67192841] pr_loss [7.96995258] pu_loss [5.70197535] best_p@10 [0.3352]
------env pg train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0048', 'true negative:0.9900')
('false positive:0.0049', 'false negative:0.0003')
('predict:p@1:81.9340%', 'p@10:98.5480%')
Env epoch 58 lr 0.0005 time 990.0705 ppl [0.49348965] pr_loss [0.32544273] pu_loss [0.16804692]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0008', 'true negative:0.9686')
('false positive:0.0260', 'false negative:0.0047')
('predict:p@1:5.8435%', 'p@10:30.0579%')
        dev_set, ppl [15.29202843] pr_loss [7.56284380] pu_loss [7.72918367] best_p@10 [0.3352]
------env train finish-------
200 interactions finished after 102.6359s 
Get training data:len(dataset) is 67885 
Agn epoch 63 learning rate 0.0001 epoch-time 2895.3714 loss [2.46879888] p@10 97.5485% p@1 77.2608%
Get testing data:len(dataset) is 1718 
        dev_set, loss [34.65507507] p@10 30.9221% p@1 7.2283%
------agn train finish-------
200 interactions finished after 118.5784s 
Get training data:len(dataset) is 68085 
Agn epoch 64 learning rate 0.0001 epoch-time 2907.0940 loss [2.43683696] p@10 97.6187% p@1 77.4130%
Get testing data:len(dataset) is 1718 
        dev_set, loss [34.72090530] p@10 30.8360% p@1 7.1141%
------agn train finish-------
200 interactions finished after 111.8384s 
Get training data:len(dataset) is 68285 
Agn epoch 65 learning rate 0.0001 epoch-time 2918.1286 loss [2.40606332] p@10 97.7076% p@1 77.5568%
Get testing data:len(dataset) is 1718 
        dev_set, loss [34.76947021] p@10 30.8613% p@1 7.1181%
------agn train finish-------
Get training data:len(dataset) is 3001 
Env epoch 59 lr 0.0005 time 33.0187 ppl [3.17995977] pr_loss [0.00000000] pu_loss [0.00000000]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0016', 'true negative:0.9259')
('false positive:0.0686', 'false negative:0.0038')
('predict:p@1:5.9537%', 'p@10:30.3459%')
        dev_set, ppl [13.64425564] pr_loss [8.14744186] pu_loss [5.49681473] best_p@10 [0.3352]
------env pg train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0048', 'true negative:0.9901')
('false positive:0.0048', 'false negative:0.0003')
('predict:p@1:81.9786%', 'p@10:98.6005%')
Env epoch 60 lr 0.0005 time 1000.7896 ppl [0.47891676] pr_loss [0.32573423] pu_loss [0.15318251]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0009', 'true negative:0.9718')
('false positive:0.0228', 'false negative:0.0046')
('predict:p@1:5.8372%', 'p@10:29.9219%')
        dev_set, ppl [14.60216141] pr_loss [7.50436115] pu_loss [7.09779978] best_p@10 [0.3352]
------env train finish-------
200 interactions finished after 106.2813s 
Get training data:len(dataset) is 68485 
Agn epoch 66 learning rate 0.0001 epoch-time 2926.0947 loss [2.37343192] p@10 97.7962% p@1 77.6898%
Get testing data:len(dataset) is 1718 
        dev_set, loss [34.80613327] p@10 30.8385% p@1 7.1136%
------agn train finish-------
200 interactions finished after 110.4180s 
Get training data:len(dataset) is 68685 
Agn epoch 67 learning rate 0.0001 epoch-time 2880.8704 loss [2.34539294] p@10 97.8611% p@1 77.8145%
Get testing data:len(dataset) is 1718 
        dev_set, loss [34.84225464] p@10 30.6696% p@1 7.0268%
------agn train finish-------
200 interactions finished after 107.8531s 
Get training data:len(dataset) is 68885 
Agn epoch 68 learning rate 0.0001 epoch-time 2840.4389 loss [2.31499195] p@10 97.9310% p@1 77.9514%
Get testing data:len(dataset) is 1718 
        dev_set, loss [34.88142776] p@10 30.9492% p@1 7.1407%
------agn train finish-------
Get training data:len(dataset) is 3601 
Env epoch 61 lr 0.0005 time 38.1035 ppl [2.61734009] pr_loss [0.00000000] pu_loss [0.00000000]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0017', 'true negative:0.9344')
('false positive:0.0602', 'false negative:0.0038')
('predict:p@1:5.9258%', 'p@10:30.2142%')
        dev_set, ppl [13.50051403] pr_loss [7.95864344] pu_loss [5.54187012] best_p@10 [0.3352]
------env pg train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0048', 'true negative:0.9900')
('false positive:0.0049', 'false negative:0.0003')
('predict:p@1:82.0621%', 'p@10:98.6227%')
Env epoch 62 lr 0.0005 time 960.3943 ppl [0.48629647] pr_loss [0.32185632] pu_loss [0.16444018]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0012', 'true negative:0.9694')
('false positive:0.0252', 'false negative:0.0042')
('predict:p@1:5.8820%', 'p@10:29.6471%')
        dev_set, ppl [14.98919582] pr_loss [7.57682467] pu_loss [7.41236973] best_p@10 [0.3352]
------env train finish-------
Dis epoch 7 learning rate 0.0001 epoch-time 3867.5212 perplexity [0.35542968] acc 86.0807%
------dis train finish-------
Dis epoch 8 learning rate 0.0001 epoch-time 3865.0426 perplexity [0.16450441] acc 94.1221%
------dis train finish-------
Dis epoch 9 learning rate 0.0001 epoch-time 3869.5820 perplexity [0.10647797] acc 96.4516%
------dis train finish-------
*************************
200 interactions finished after 98.6535s 
Get training data:len(dataset) is 69085 
Agn epoch 69 learning rate 0.0001 epoch-time 2853.8418 loss [2.28817177] p@10 97.9975% p@1 78.0885%
Get testing data:len(dataset) is 1718 
        dev_set, loss [34.91326141] p@10 30.8783% p@1 7.1735%
------agn train finish-------
200 interactions finished after 108.2763s 
Get training data:len(dataset) is 69285 
Agn epoch 70 learning rate 0.0001 epoch-time 2857.2123 loss [2.26431084] p@10 98.0731% p@1 78.1363%
Get testing data:len(dataset) is 1718 
        dev_set, loss [34.99812698] p@10 30.8383% p@1 7.0847%
------agn train finish-------
200 interactions finished after 108.3582s 
Get training data:len(dataset) is 69485 
Agn epoch 71 learning rate 0.0001 epoch-time 2860.1721 loss [2.24381185] p@10 98.1326% p@1 78.2550%
Get testing data:len(dataset) is 1718 
        dev_set, loss [35.05829239] p@10 30.9708% p@1 7.1385%
------agn train finish-------
Get training data:len(dataset) is 4201 
Env epoch 63 lr 0.0005 time 44.6216 ppl [2.54643250] pr_loss [0.00000000] pu_loss [0.00000000]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0015', 'true negative:0.9373')
('false positive:0.0573', 'false negative:0.0040')
('predict:p@1:5.7656%', 'p@10:29.8773%')
        dev_set, ppl [14.30596352] pr_loss [8.28281021] pu_loss [6.02315283] best_p@10 [0.3352]
------env pg train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0048', 'true negative:0.9899')
('false positive:0.0050', 'false negative:0.0003')
('predict:p@1:82.2322%', 'p@10:98.6542%')
Env epoch 64 lr 0.0005 time 962.8390 ppl [0.48210633] pr_loss [0.31827021] pu_loss [0.16383612]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0008', 'true negative:0.9714')
('false positive:0.0232', 'false negative:0.0047')
('predict:p@1:6.0536%', 'p@10:29.7725%')
        dev_set, ppl [15.59049320] pr_loss [7.51242733] pu_loss [8.07806492] best_p@10 [0.3352]
------env train finish-------
200 interactions finished after 105.5832s 
Get training data:len(dataset) is 69685 
Agn epoch 72 learning rate 0.0001 epoch-time 2864.3243 loss [2.21872306] p@10 98.1894% p@1 78.3168%
Get testing data:len(dataset) is 1718 
        dev_set, loss [35.13745499] p@10 30.8819% p@1 7.0342%
------agn train finish-------
200 interactions finished after 103.6989s 
Get training data:len(dataset) is 69885 
Agn epoch 73 learning rate 0.0001 epoch-time 2870.7234 loss [2.19966412] p@10 98.2379% p@1 78.4309%
Get testing data:len(dataset) is 1718 
        dev_set, loss [35.16905212] p@10 30.7459% p@1 7.0572%
------agn train finish-------
200 interactions finished after 107.1003s 
Get training data:len(dataset) is 70085 
Agn epoch 74 learning rate 0.0001 epoch-time 2880.9927 loss [2.17917514] p@10 98.2899% p@1 78.4750%
Get testing data:len(dataset) is 1718 
        dev_set, loss [35.25030518] p@10 30.8566% p@1 7.0033%
------agn train finish-------
Get training data:len(dataset) is 4801 
Env epoch 65 lr 0.0005 time 50.9840 ppl [2.04925346] pr_loss [0.00000000] pu_loss [0.00000000]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0015', 'true negative:0.9266')
('false positive:0.0680', 'false negative:0.0039')
('predict:p@1:6.1062%', 'p@10:29.8662%')
        dev_set, ppl [14.12394524] pr_loss [8.08860970] pu_loss [6.03533602] best_p@10 [0.3352]
------env pg train finish-------
Get training data:len(dataset) is 65284 
Confusion matrix for purchase prediction:
('true positive:0.0048', 'true negative:0.9897')
('false positive:0.0052', 'false negative:0.0003')
('predict:p@1:82.3098%', 'p@10:98.7061%')
Env epoch 66 lr 0.0005 time 963.3338 ppl [0.46367908] pr_loss [0.31294101] pu_loss [0.15073809]
Get testing data:len(dataset) is 1718 
Confusion matrix for purchase prediction:
('true positive:0.0008', 'true negative:0.9734')
('false positive:0.0211', 'false negative:0.0047')
('predict:p@1:5.8254%', 'p@10:29.5814%')
        dev_set, ppl [15.52386284] pr_loss [7.57206726] pu_loss [7.95179462] best_p@10 [0.3352]
------env train finish-------
200 interactions finished after 110.5816s 
Get training data:len(dataset) is 70285 
Agn epoch 75 learning rate 0.0001 epoch-time 2882.1178 loss [2.15725851] p@10 98.3325% p@1 78.5999%
Get testing data:len(dataset) is 1718 
        dev_set, loss [35.30613327] p@10 30.8321% p@1 6.9648%
------agn train finish-------
200 interactions finished after 104.1219s 
Get training data:len(dataset) is 70485 
Agn epoch 76 learning rate 0.0001 epoch-time 2884.2224 loss [2.14017725] p@10 98.3698% p@1 78.6281%
Get testing data:len(dataset) is 1718 
        dev_set, loss [35.32262039] p@10 30.6655% p@1 6.9883%
------agn train finish-------
200 interactions finished after 110.4089s 
Get training data:len(dataset) is 70685 
Agn epoch 77 learning rate 0.0001 epoch-time 2891.1695 loss [2.12138033] p@10 98.4137% p@1 78.7023%
Get testing data:len(dataset) is 1718 
        dev_set, loss [35.38652039] p@10 30.5746% p@1 6.9228%
------agn train finish-------
Get training data:len(dataset