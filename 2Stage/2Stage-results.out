Fri Dec  3 14:52:11 2021       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 470.42.01    Driver Version: 470.42.01    CUDA Version: 11.4     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla V100-PCIE...  Off  | 00000000:AF:00.0 Off |                    0 |
| N/A   43C    P0    39W / 250W |      0MiB / 32510MiB |      2%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
loaded full_impression_feats.pt
-----------------------------------------------------
ALGORITHMS EVALUATION 
 with loss type: loss_ce

 ---epoch 0---
1 stage 0.8283112645149231
2 stage 0.9435430765151978
1 stage (val) OrderedDict([('Precision@1', 0.7712215185165405), ('Precision@5', 0.7561072707176208), ('Precision@10', 0.7601962089538574), ('Recall@1', 0.0025406121276319027), ('Recall@5', 0.01293876301497221), ('Recall@10', 0.027056947350502014), ('NDCG@5', 0.7601037621498108), ('NDCG@10', 0.7613793015480042), ('NDCG@20', 0.7634238004684448)])
2 stage (val) OrderedDict([('Precision@1', 0.9404761791229248), ('Precision@5', 0.8920292854309082), ('Precision@10', 0.8523814082145691), ('Recall@1', 0.014650296419858932), ('Recall@5', 0.040033165365457535), ('Recall@10', 0.056170668452978134), ('NDCG@5', 0.906629204750061), ('NDCG@10', 0.879317045211792), ('NDCG@20', 0.8431696891784668)])
1 stage (test) OrderedDict([('Precision@1', 0.8811136484146118), ('Precision@5', 0.8704310059547424), ('Precision@10', 0.8745405673980713), ('Recall@1', 0.0028621922247111797), ('Recall@5', 0.01440187357366085), ('Recall@10', 0.02973530814051628), ('NDCG@5', 0.873636782169342), ('NDCG@10', 0.875171422958374), ('NDCG@20', 0.8719898462295532)])
2 stage (test) OrderedDict([('Precision@1', 0.973664402961731), ('Precision@5', 0.9487835764884949), ('Precision@10', 0.9303234219551086), ('Recall@1', 0.007826665416359901), ('Recall@5', 0.027142416685819626), ('Recall@10', 0.04358246549963951), ('NDCG@5', 0.9558278918266296), ('NDCG@10', 0.9426999092102051), ('NDCG@20', 0.9225301146507263)])

 ---epoch 1---
1 stage 0.8301324844360352
2 stage 0.9432119131088257
1 stage (val) OrderedDict([('Precision@1', 0.773809552192688), ('Precision@5', 0.7595236301422119), ('Precision@10', 0.7618524432182312), ('Recall@1', 0.0026000041980296373), ('Recall@5', 0.013114139437675476), ('Recall@10', 0.027250992134213448), ('NDCG@5', 0.7630928754806519), ('NDCG@10', 0.7632816433906555), ('NDCG@20', 0.7644608616828918)])
2 stage (val) OrderedDict([('Precision@1', 0.9409937858581543), ('Precision@5', 0.899482786655426), ('Precision@10', 0.8595760464668274), ('Recall@1', 0.014359145425260067), ('Recall@5', 0.04153316095471382), ('Recall@10', 0.058392204344272614), ('NDCG@5', 0.9118286371231079), ('NDCG@10', 0.8850722908973694), ('NDCG@20', 0.8481661677360535)])
1 stage (test) OrderedDict([('Precision@1', 0.8826184868812561), ('Precision@5', 0.8726385831832886), ('Precision@10', 0.875619113445282), ('Recall@1', 0.0028993061278015375), ('Recall@5', 0.014489829540252686), ('Recall@10', 0.029994715005159378), ('NDCG@5', 0.8754095435142517), ('NDCG@10', 0.8762668371200562), ('NDCG@20', 0.8735100626945496)])
2 stage (test) OrderedDict([('Precision@1', 0.9729119539260864), ('Precision@5', 0.951492428779602), ('Precision@10', 0.9328316450119019), ('Recall@1', 0.007669906131923199), ('Recall@5', 0.027348756790161133), ('Recall@10', 0.04409905523061752), ('NDCG@5', 0.9576801657676697), ('NDCG@10', 0.9447212815284729), ('NDCG@20', 0.9254541397094727)])

 ---epoch 2---
1 stage 0.8309602737426758
2 stage 0.9427152276039124
1 stage (val) OrderedDict([('Precision@1', 0.7753623127937317), ('Precision@5', 0.7605587244033813), ('Precision@10', 0.7621630430221558), ('Recall@1', 0.0026172169018536806), ('Recall@5', 0.01311479788273573), ('Recall@10', 0.027676662430167198), ('NDCG@5', 0.7640324234962463), ('NDCG@10', 0.7636905312538147), ('NDCG@20', 0.7635862231254578)])
2 stage (val) OrderedDict([('Precision@1', 0.9399585723876953), ('Precision@5', 0.8996898531913757), ('Precision@10', 0.8595240712165833), ('Recall@1', 0.014112669974565506), ('Recall@5', 0.04164985939860344), ('Recall@10', 0.05846232548356056), ('NDCG@5', 0.9117982983589172), ('NDCG@10', 0.8848738074302673), ('NDCG@20', 0.8471189737319946)])
1 stage (test) OrderedDict([('Precision@1', 0.8831201195716858), ('Precision@5', 0.8737923502922058), ('Precision@10', 0.8757696747779846), ('Recall@1', 0.002914312295615673), ('Recall@5', 0.014516693539917469), ('Recall@10', 0.030166586861014366), ('NDCG@5', 0.8763307332992554), ('NDCG@10', 0.8765184879302979), ('NDCG@20', 0.8728643655776978)])
2 stage (test) OrderedDict([('Precision@1', 0.9726611375808716), ('Precision@5', 0.9517431855201721), ('Precision@10', 0.9327563643455505), ('Recall@1', 0.007661545183509588), ('Recall@5', 0.027226606383919716), ('Recall@10', 0.043969932943582535), ('NDCG@5', 0.9579092264175415), ('NDCG@10', 0.9447734355926514), ('NDCG@20', 0.9248648881912231)])

 ---epoch 3---
1 stage 0.8309602737426758
2 stage 0.9427152276039124
1 stage (val) OrderedDict([('Precision@1', 0.7732919454574585), ('Precision@5', 0.7613869905471802), ('Precision@10', 0.7622664570808411), ('Recall@1', 0.0025976556353271008), ('Recall@5', 0.01315295696258545), ('Recall@10', 0.027919597923755646), ('NDCG@5', 0.7642895579338074), ('NDCG@10', 0.7636125683784485), ('NDCG@20', 0.7626592516899109)])
2 stage (val) OrderedDict([('Precision@1', 0.9399585723876953), ('Precision@5', 0.8996899127960205), ('Precision@10', 0.8595759272575378), ('Recall@1', 0.014112669974565506), ('Recall@5', 0.04163310304284096), ('Recall@10', 0.05840195342898369), ('NDCG@5', 0.9118059873580933), ('NDCG@10', 0.8849174976348877), ('NDCG@20', 0.8467755317687988)])
1 stage (test) OrderedDict([('Precision@1', 0.8841233849525452), ('Precision@5', 0.8744443655014038), ('Precision@10', 0.875619113445282), ('Recall@1', 0.002922292798757553), ('Recall@5', 0.014544970355927944), ('Recall@10', 0.03011552430689335), ('NDCG@5', 0.8769433498382568), ('NDCG@10', 0.876642107963562), ('NDCG@20', 0.8725051283836365)])
2 stage (test) OrderedDict([('Precision@1', 0.9726611375808716), ('Precision@5', 0.9516931176185608), ('Precision@10', 0.9324804544448853), ('Recall@1', 0.00762938940897584), ('Recall@5', 0.027186086401343346), ('Recall@10', 0.043871860951185226), ('NDCG@5', 0.9578554630279541), ('NDCG@10', 0.9445577263832092), ('NDCG@20', 0.924519419670105)])

 ---epoch 4---
1 stage 0.8311258554458618
2 stage 0.9423841238021851
1 stage (val) OrderedDict([('Precision@1', 0.7722567319869995), ('Precision@5', 0.7615941762924194), ('Precision@10', 0.7622146606445312), ('Recall@1', 0.0025856117717921734), ('Recall@5', 0.013131472282111645), ('Recall@10', 0.028000425547361374), ('NDCG@5', 0.7642789483070374), ('NDCG@10', 0.7635685205459595), ('NDCG@20', 0.7624138593673706)])
2 stage (val) OrderedDict([('Precision@1', 0.9389234185218811), ('Precision@5', 0.8996897339820862), ('Precision@10', 0.8594205975532532), ('Recall@1', 0.014074929058551788), ('Recall@5', 0.04161488637328148), ('Recall@10', 0.05831214785575867), ('NDCG@5', 0.9116950631141663), ('NDCG@10', 0.8847064971923828), ('NDCG@20', 0.8465331792831421)])
1 stage (test) OrderedDict([('Precision@1', 0.8848758339881897), ('Precision@5', 0.8747451901435852), ('Precision@10', 0.8754184246063232), ('Recall@1', 0.0029344544745981693), ('Recall@5', 0.014549127779901028), ('Recall@10', 0.030054571107029915), ('NDCG@5', 0.8772202730178833), ('NDCG@10', 0.8766471147537231), ('NDCG@20', 0.8720505833625793)])
2 stage (test) OrderedDict([('Precision@1', 0.9726611375808716), ('Precision@5', 0.9516428709030151), ('Precision@10', 0.932580828666687), ('Recall@1', 0.007651285734027624), ('Recall@5', 0.027255116030573845), ('Recall@10', 0.043974943459033966), ('NDCG@5', 0.9578578472137451), ('NDCG@10', 0.9446741938591003), ('NDCG@20', 0.9244104623794556)])

 ---epoch 5---
1 stage 0.8327814936637878
2 stage 0.9423841238021851
1 stage (val) OrderedDict([('Precision@1', 0.7748447060585022), ('Precision@5', 0.7616977095603943), ('Precision@10', 0.762162983417511), ('Recall@1', 0.0026315487921237946), ('Recall@5', 0.013146793469786644), ('Recall@10', 0.027997588738799095), ('NDCG@5', 0.7645986676216125), ('NDCG@10', 0.7637874484062195), ('NDCG@20', 0.7620424032211304)])
2 stage (val) OrderedDict([('Precision@1', 0.9389234185218811), ('Precision@5', 0.8998968005180359), ('Precision@10', 0.8590583801269531), ('Recall@1', 0.014044119045138359), ('Recall@5', 0.041657134890556335), ('Recall@10', 0.058316636830568314), ('NDCG@5', 0.9119440317153931), ('NDCG@10', 0.8845623731613159), ('NDCG@20', 0.8462854623794556)])
1 stage (test) OrderedDict([('Precision@1', 0.8861299157142639), ('Precision@5', 0.8750461935997009), ('Precision@10', 0.8752678632736206), ('Recall@1', 0.002951904432848096), ('Recall@5', 0.014559569768607616), ('Recall@10', 0.030047230422496796), ('NDCG@5', 0.8776324391365051), ('NDCG@10', 0.8767233490943909), ('NDCG@20', 0.8718279600143433)])
2 stage (test) OrderedDict([('Precision@1', 0.9726611375808716), ('Precision@5', 0.9515424966812134), ('Precision@10', 0.9323550462722778), ('Recall@1', 0.007646217942237854), ('Recall@5', 0.02711538039147854), ('Recall@10', 0.04380745068192482), ('NDCG@5', 0.9577285647392273), ('NDCG@10', 0.9444390535354614), ('NDCG@20', 0.9241275191307068)])

 ---epoch 6---
1 stage 0.8336092829704285
2 stage 0.9420530200004578
1 stage (val) OrderedDict([('Precision@1', 0.7753623127937317), ('Precision@5', 0.7620081305503845), ('Precision@10', 0.7622665762901306), ('Recall@1', 0.0026686317287385464), ('Recall@5', 0.01315335649996996), ('Recall@10', 0.028034254908561707), ('NDCG@5', 0.7648366689682007), ('NDCG@10', 0.7639350891113281), ('NDCG@20', 0.7617238759994507)])
2 stage (val) OrderedDict([('Precision@1', 0.9378882050514221), ('Precision@5', 0.8993791937828064), ('Precision@10', 0.8590065836906433), ('Recall@1', 0.013985579833388329), ('Recall@5', 0.04141826182603836), ('Recall@10', 0.058173518627882004), ('NDCG@5', 0.9114518761634827), ('NDCG@10', 0.884390115737915), ('NDCG@20', 0.8459869027137756)])
1 stage (test) OrderedDict([('Precision@1', 0.8871331810951233), ('Precision@5', 0.8743940591812134), ('Precision@10', 0.8747411966323853), ('Recall@1', 0.0029580986592918634), ('Recall@5', 0.014523975551128387), ('Recall@10', 0.029972821474075317), ('NDCG@5', 0.8773494362831116), ('NDCG@10', 0.8765016198158264), ('NDCG@20', 0.8714382648468018)])
2 stage (test) OrderedDict([('Precision@1', 0.9726611375808716), ('Precision@5', 0.9516931176185608), ('Precision@10', 0.9324302673339844), ('Recall@1', 0.0076085957698524), ('Recall@5', 0.027207642793655396), ('Recall@10', 0.04389943182468414), ('NDCG@5', 0.9579143524169922), ('NDCG@10', 0.9445683360099792), ('NDCG@20', 0.9241575598716736)])

 ---epoch 7---
1 stage 0.8332781791687012
2 stage 0.9417218565940857
1 stage (val) OrderedDict([('Precision@1', 0.7748447060585022), ('Precision@5', 0.7619047164916992), ('Precision@10', 0.762370228767395), ('Recall@1', 0.00265584047883749), ('Recall@5', 0.013197148218750954), ('Recall@10', 0.028067007660865784), ('NDCG@5', 0.7647883296012878), ('NDCG@10', 0.7640490531921387), ('NDCG@20', 0.7611926198005676)])
2 stage (val) OrderedDict([('Precision@1', 0.9384058117866516), ('Precision@5', 0.9001038074493408), ('Precision@10', 0.8593688607215881), ('Recall@1', 0.014158114790916443), ('Recall@5', 0.04163438081741333), ('Recall@10', 0.05845775082707405), ('NDCG@5', 0.9121458530426025), ('NDCG@10', 0.8849162459373474), ('NDCG@20', 0.8462274074554443)])
1 stage (test) OrderedDict([('Precision@1', 0.8868823647499084), ('Precision@5', 0.8744444251060486), ('Precision@10', 0.8747914433479309), ('Recall@1', 0.0029608814511448145), ('Recall@5', 0.014549437910318375), ('Recall@10', 0.03001868724822998), ('NDCG@5', 0.8773465156555176), ('NDCG@10', 0.8765310049057007), ('NDCG@20', 0.8706704378128052)])
2 stage (test) OrderedDict([('Precision@1', 0.971908688545227), ('Precision@5', 0.9516428709030151), ('Precision@10', 0.9324302673339844), ('Recall@1', 0.007533699739724398), ('Recall@5', 0.02686741016805172), ('Recall@10', 0.04352675378322601), ('NDCG@5', 0.957614541053772), ('NDCG@10', 0.944297730922699), ('NDCG@20', 0.9239033460617065)])

 ---epoch 8---
1 stage 0.8339403867721558
2 stage 0.9413907527923584
1 stage (val) OrderedDict([('Precision@1', 0.7753623127937317), ('Precision@5', 0.762319028377533), ('Precision@10', 0.7620598077774048), ('Recall@1', 0.0026745935901999474), ('Recall@5', 0.013324066996574402), ('Recall@10', 0.028224099427461624), ('NDCG@5', 0.7655296921730042), ('NDCG@10', 0.7641653418540955), ('NDCG@20', 0.7607902884483337)])
2 stage (val) OrderedDict([('Precision@1', 0.9378882050514221), ('Precision@5', 0.8991721868515015), ('Precision@10', 0.8587478995323181), ('Recall@1', 0.014051624573767185), ('Recall@5', 0.04070620983839035), ('Recall@10', 0.05750025063753128), ('NDCG@5', 0.9110620021820068), ('NDCG@10', 0.8838689923286438), ('NDCG@20', 0.8451893329620361)])
1 stage (test) OrderedDict([('Precision@1', 0.887634813785553), ('Precision@5', 0.8742437362670898), ('Precision@10', 0.8747663497924805), ('Recall@1', 0.0029845840763300657), ('Recall@5', 0.014532489702105522), ('Recall@10', 0.02989695779979229), ('NDCG@5', 0.8774835467338562), ('NDCG@10', 0.8767173886299133), ('NDCG@20', 0.8701626658439636)])
2 stage (test) OrderedDict([('Precision@1', 0.9716578722000122), ('Precision@5', 0.9512917399406433), ('Precision@10', 0.9322296380996704), ('Recall@1', 0.0075211594812572), ('Recall@5', 0.026838574558496475), ('Recall@10', 0.043512992560863495), ('NDCG@5', 0.957363486289978), ('NDCG@10', 0.9441179633140564), ('NDCG@20', 0.9236834645271301)])

 ---epoch 9---
1 stage 0.8360927104949951
2 stage 0.9412251710891724
1 stage (val) OrderedDict([('Precision@1', 0.7779502868652344), ('Precision@5', 0.7633541226387024), ('Precision@10', 0.7620599269866943), ('Recall@1', 0.002708292566239834), ('Recall@5', 0.013444870710372925), ('Recall@10', 0.028082801029086113), ('NDCG@5', 0.7665983438491821), ('NDCG@10', 0.7645328044891357), ('NDCG@20', 0.7605472803115845)])
2 stage (val) OrderedDict([('Precision@1', 0.9373705983161926), ('Precision@5', 0.8990685939788818), ('Precision@10', 0.858644425868988), ('Recall@1', 0.014017115347087383), ('Recall@5', 0.0405028834939003), ('Recall@10', 0.05730699375271797), ('NDCG@5', 0.9108366370201111), ('NDCG@10', 0.8836493492126465), ('NDCG@20', 0.8447377681732178)])
1 stage (test) OrderedDict([('Precision@1', 0.8896413445472717), ('Precision@5', 0.8743942379951477), ('Precision@10', 0.8749169111251831), ('Recall@1', 0.0030048645567148924), ('Recall@5', 0.014543048106133938), ('Recall@10', 0.029945267364382744), ('NDCG@5', 0.8778788447380066), ('NDCG@10', 0.8770166635513306), ('NDCG@20', 0.8697684407234192)])
2 stage (test) OrderedDict([('Precision@1', 0.9716578722000122), ('Precision@5', 0.9511913657188416), ('Precision@10', 0.93222975730896), ('Recall@1', 0.007535942830145359), ('Recall@5', 0.026785630732774734), ('Recall@10', 0.04349857196211815), ('NDCG@5', 0.957308292388916), ('NDCG@10', 0.9440893530845642), ('NDCG@20', 0.9235320091247559)])

 ---epoch 10---
1 stage 0.8364238739013672
2 stage 0.9403973817825317
1 stage (val) OrderedDict([('Precision@1', 0.7789855003356934), ('Precision@5', 0.7639750838279724), ('Precision@10', 0.7629398107528687), ('Recall@1', 0.002738019684329629), ('Recall@5', 0.013534351252019405), ('Recall@10', 0.02819298952817917), ('NDCG@5', 0.7671827077865601), ('NDCG@10', 0.7652683258056641), ('NDCG@20', 0.7603051662445068)])
2 stage (val) OrderedDict([('Precision@1', 0.9363353848457336), ('Precision@5', 0.8982404470443726), ('Precision@10', 0.8582301735877991), ('Recall@1', 0.013966524042189121), ('Recall@5', 0.04014104604721069), ('Recall@10', 0.05689927563071251), ('NDCG@5', 0.9100028872489929), ('NDCG@10', 0.8830404281616211), ('NDCG@20', 0.844190239906311)])
1 stage (test) OrderedDict([('Precision@1', 0.8896413445472717), ('Precision@5', 0.8745446801185608), ('Precision@10', 0.8748918175697327), ('Recall@1', 0.0030093693640083075), ('Recall@5', 0.014573907479643822), ('Recall@10', 0.03000910021364689), ('NDCG@5', 0.8781865835189819), ('NDCG@10', 0.877153754234314), ('NDCG@20', 0.8692296743392944)])
2 stage (test) OrderedDict([('Precision@1', 0.9709054231643677), ('Precision@5', 0.9507399201393127), ('Precision@10', 0.9318785667419434), ('Recall@1', 0.007461123168468475), ('Recall@5', 0.02655087783932686), ('Recall@10', 0.043230365961790085), ('NDCG@5', 0.9568008184432983), ('NDCG@10', 0.943594753742218), ('NDCG@20', 0.9230790138244629)])

 ---epoch 11---
1 stage 0.8377483487129211
2 stage 0.939072847366333
1 stage (val) OrderedDict([('Precision@1', 0.781573474407196), ('Precision@5', 0.7650102972984314), ('Precision@10', 0.7625259160995483), ('Recall@1', 0.002764297416433692), ('Recall@5', 0.013602224178612232), ('Recall@10', 0.028177060186862946), ('NDCG@5', 0.7683464288711548), ('NDCG@10', 0.7653682231903076), ('NDCG@20', 0.7599365711212158)])
2 stage (val) OrderedDict([('Precision@1', 0.933747410774231), ('Precision@5', 0.8967912793159485), ('Precision@10', 0.8575056195259094), ('Recall@1', 0.013609064742922783), ('Recall@5', 0.03935741260647774), ('Recall@10', 0.05610119178891182), ('NDCG@5', 0.9083454012870789), ('NDCG@10', 0.8817606568336487), ('NDCG@20', 0.8430511951446533)])
1 stage (test) OrderedDict([('Precision@1', 0.8903937935829163), ('Precision@5', 0.8744944930076599), ('Precision@10', 0.8749167919158936), ('Recall@1', 0.003019785974174738), ('Recall@5', 0.014585458673536777), ('Recall@10', 0.029980655759572983), ('NDCG@5', 0.8783434629440308), ('NDCG@10', 0.8773007988929749), ('NDCG@20', 0.8684766292572021)])
2 stage (test) OrderedDict([('Precision@1', 0.9701529741287231), ('Precision@5', 0.9500376582145691), ('Precision@10', 0.9312766194343567), ('Recall@1', 0.007364977616816759), ('Recall@5', 0.02616909332573414), ('Recall@10', 0.04279512166976929), ('NDCG@5', 0.9560360312461853), ('NDCG@10', 0.9428279399871826), ('NDCG@20', 0.9223937392234802)])

 ---epoch 12---
1 stage 0.8389073014259338
2 stage 0.937748372554779
1 stage (val) OrderedDict([('Precision@1', 0.7831262946128845), ('Precision@5', 0.7656314373016357), ('Precision@10', 0.7633022665977478), ('Recall@1', 0.0028011647518724203), ('Recall@5', 0.01358367595821619), ('Recall@10', 0.028517208993434906), ('NDCG@5', 0.7692259550094604), ('NDCG@10', 0.7661464810371399), ('NDCG@20', 0.7597347497940063)])
2 stage (val) OrderedDict([('Precision@1', 0.9306418299674988), ('Precision@5', 0.8959630131721497), ('Precision@10', 0.8565739393234253), ('Recall@1', 0.013215593062341213), ('Recall@5', 0.03868018463253975), ('Recall@10', 0.05535771697759628), ('NDCG@5', 0.9069182276725769), ('NDCG@10', 0.8802322745323181), ('NDCG@20', 0.8420560956001282)])
1 stage (test) OrderedDict([('Precision@1', 0.8913970589637756), ('Precision@5', 0.8748456835746765), ('Precision@10', 0.8749419450759888), ('Recall@1', 0.0030339332297444344), ('Recall@5', 0.014616797678172588), ('Recall@10', 0.030291980132460594), ('NDCG@5', 0.8788566589355469), ('NDCG@10', 0.8774672150611877), ('NDCG@20', 0.867768406867981)])
2 stage (test) OrderedDict([('Precision@1', 0.9696513414382935), ('Precision@5', 0.9498370289802551), ('Precision@10', 0.9313268065452576), ('Recall@1', 0.007243053056299686), ('Recall@5', 0.025992222130298615), ('Recall@10', 0.04263247549533844), ('NDCG@5', 0.9556947946548462), ('NDCG@10', 0.9426355361938477), ('NDCG@20', 0.9221203327178955)])

 ---epoch 13---
1 stage 0.8380795121192932
2 stage 0.9367550015449524
1 stage (val) OrderedDict([('Precision@1', 0.781573474407196), ('Precision@5', 0.7654244303703308), ('Precision@10', 0.7641821503639221), ('Recall@1', 0.00279193464666605), ('Recall@5', 0.013658200390636921), ('Recall@10', 0.02888765186071396), ('NDCG@5', 0.7690128684043884), ('NDCG@10', 0.7666630744934082), ('NDCG@20', 0.7592405676841736)])
2 stage (val) OrderedDict([('Precision@1', 0.9285714030265808), ('Precision@5', 0.8959630727767944), ('Precision@10', 0.8564187288284302), ('Recall@1', 0.012925985269248486), ('Recall@5', 0.03840015083551407), ('Recall@10', 0.05503508076071739), ('NDCG@5', 0.9065622091293335), ('NDCG@10', 0.8797500133514404), ('NDCG@20', 0.8413093090057373)])
1 stage (test) OrderedDict([('Precision@1', 0.890895426273346), ('Precision@5', 0.8751969337463379), ('Precision@10', 0.8743900060653687), ('Recall@1', 0.003038279013708234), ('Recall@5', 0.014668293297290802), ('Recall@10', 0.030278604477643967), ('NDCG@5', 0.8790581822395325), ('NDCG@10', 0.877087414264679), ('NDCG@20', 0.8668333888053894)])
2 stage (test) OrderedDict([('Precision@1', 0.9691497087478638), ('Precision@5', 0.9496363997459412), ('Precision@10', 0.931126058101654), ('Recall@1', 0.007186496630311012), ('Recall@5', 0.025857146829366684), ('Recall@10', 0.042483240365982056), ('NDCG@5', 0.9554008841514587), ('NDCG@10', 0.9423397779464722), ('NDCG@20', 0.9217275977134705)])

 ---epoch 14---
1 stage 0.8382450342178345
2 stage 0.9364238381385803
1 stage (val) OrderedDict([('Precision@1', 0.7810559272766113), ('Precision@5', 0.7654244899749756), ('Precision@10', 0.7641823887825012), ('Recall@1', 0.0027999503072351217), ('Recall@5', 0.013674703426659107), ('Recall@10', 0.028878113254904747), ('NDCG@5', 0.7690293788909912), ('NDCG@10', 0.7666827440261841), ('NDCG@20', 0.7588724493980408)])
2 stage (val) OrderedDict([('Precision@1', 0.9285714030265808), ('Precision@5', 0.8954454064369202), ('Precision@10', 0.8561078906059265), ('Recall@1', 0.013167304918169975), ('Recall@5', 0.03761443868279457), ('Recall@10', 0.05422062426805496), ('NDCG@5', 0.9062443971633911), ('NDCG@10', 0.8795248866081238), ('NDCG@20', 0.840968132019043)])
1 stage (test) OrderedDict([('Precision@1', 0.8913970589637756), ('Precision@5', 0.8752971887588501), ('Precision@10', 0.8739635944366455), ('Recall@1', 0.0030412443447858095), ('Recall@5', 0.014685279689729214), ('Recall@10', 0.03043964132666588), ('NDCG@5', 0.8792804479598999), ('NDCG@10', 0.8768924474716187), ('NDCG@20', 0.8661752343177795)])
2 stage (test) OrderedDict([('Precision@1', 0.9686481356620789), ('Precision@5', 0.9494858980178833), ('Precision@10', 0.931075930595398), ('Recall@1', 0.00713158817961812), ('Recall@5', 0.025759147480130196), ('Recall@10', 0.042369816452264786), ('NDCG@5', 0.9551783800125122), ('NDCG@10', 0.9421936273574829), ('NDCG@20', 0.9214770197868347)])

 ---epoch 15---
1 stage 0.8397350907325745
2 stage 0.936092734336853
1 stage (val) OrderedDict([('Precision@1', 0.7841615080833435), ('Precision@5', 0.7663561105728149), ('Precision@10', 0.7640788555145264), ('Recall@1', 0.0029163763392716646), ('Recall@5', 0.013834535144269466), ('Recall@10', 0.02873191051185131), ('NDCG@5', 0.7700952291488647), ('NDCG@10', 0.7670206427574158), ('NDCG@20', 0.7586137652397156)])
2 stage (val) OrderedDict([('Precision@1', 0.9275362491607666), ('Precision@5', 0.8943066596984863), ('Precision@10', 0.8557973504066467), ('Recall@1', 0.012883621267974377), ('Recall@5', 0.03690279647707939), ('Recall@10', 0.05358008295297623), ('NDCG@5', 0.9048573970794678), ('NDCG@10', 0.8785969018936157), ('NDCG@20', 0.8399351239204407)])
1 stage (test) OrderedDict([('Precision@1', 0.8921495079994202), ('Precision@5', 0.875598132610321), ('Precision@10', 0.873988687992096), ('Recall@1', 0.003050534287467599), ('Recall@5', 0.014712585136294365), ('Recall@10', 0.030478497967123985), ('NDCG@5', 0.8794626593589783), ('NDCG@10', 0.8769136071205139), ('NDCG@20', 0.8653722405433655)])
2 stage (test) OrderedDict([('Precision@1', 0.9686481356620789), ('Precision@5', 0.9492853283882141), ('Precision@10', 0.9310256838798523), ('Recall@1', 0.00713158817961812), ('Recall@5', 0.02563779056072235), ('Recall@10', 0.042251527309417725), ('NDCG@5', 0.9549764394760132), ('NDCG@10', 0.9420576691627502), ('NDCG@20', 0.9213718771934509)])

 ---epoch 16---
1 stage 0.8408940434455872
2 stage 0.935927152633667
1 stage (val) OrderedDict([('Precision@1', 0.784679114818573), ('Precision@5', 0.7662526369094849), ('Precision@10', 0.7635613679885864), ('Recall@1', 0.0029329254757612944), ('Recall@5', 0.013847262598574162), ('Recall@10', 0.02863120660185814), ('NDCG@5', 0.7703219056129456), ('NDCG@10', 0.766893208026886), ('NDCG@20', 0.7584422826766968)])
2 stage (val) OrderedDict([('Precision@1', 0.9280538558959961), ('Precision@5', 0.893478512763977), ('Precision@10', 0.8553832769393921), ('Recall@1', 0.012944009155035019), ('Recall@5', 0.03658490255475044), ('Recall@10', 0.053291309624910355), ('NDCG@5', 0.9042165279388428), ('NDCG@10', 0.8781479597091675), ('NDCG@20', 0.8394578695297241)])
1 stage (test) OrderedDict([('Precision@1', 0.8936544060707092), ('Precision@5', 0.875598132610321), ('Precision@10', 0.8737630248069763), ('Recall@1', 0.0030703088268637657), ('Recall@5', 0.014720737002789974), ('Recall@10', 0.030497347936034203), ('NDCG@5', 0.8797132968902588), ('NDCG@10', 0.8769235014915466), ('NDCG@20', 0.8646010160446167)])
2 stage (test) OrderedDict([('Precision@1', 0.9681465029716492), ('Precision@5', 0.9488840103149414), ('Precision@10', 0.930850088596344), ('Recall@1', 0.007089786231517792), ('Recall@5', 0.0255022831261158), ('Recall@10', 0.0421249158680439), ('NDCG@5', 0.9545373916625977), ('NDCG@10', 0.9417319893836975), ('NDCG@20', 0.9209865927696228)])

 ---epoch 17---
1 stage 0.8412252068519592
2 stage 0.935927152633667
1 stage (val) OrderedDict([('Precision@1', 0.7841615080833435), ('Precision@5', 0.7669771909713745), ('Precision@10', 0.7632506489753723), ('Recall@1', 0.002943872706964612), ('Recall@5', 0.013892101123929024), ('Recall@10', 0.028680844232439995), ('NDCG@5', 0.7707937359809875), ('NDCG@10', 0.7667248249053955), ('NDCG@20', 0.7580633759498596)])
2 stage (val) OrderedDict([('Precision@1', 0.9280538558959961), ('Precision@5', 0.8932714462280273), ('Precision@10', 0.8550208806991577), ('Recall@1', 0.012944009155035019), ('Recall@5', 0.03643859550356865), ('Recall@10', 0.05300949141383171), ('NDCG@5', 0.9039430022239685), ('NDCG@10', 0.877760112285614), ('NDCG@20', 0.839079737663269)])
1 stage (test) OrderedDict([('Precision@1', 0.894406795501709), ('Precision@5', 0.8755981922149658), ('Precision@10', 0.8733615279197693), ('Recall@1', 0.00307757337577641), ('Recall@5', 0.014727815985679626), ('Recall@10', 0.03047383390367031), ('NDCG@5', 0.8799375295639038), ('NDCG@10', 0.8768253326416016), ('NDCG@20', 0.8639920949935913)])
2 stage (test) OrderedDict([('Precision@1', 0.9681465029716492), ('Precision@5', 0.9485328197479248), ('Precision@10', 0.9307246804237366), ('Recall@1', 0.0071088955737650394), ('Recall@5', 0.025439558550715446), ('Recall@10', 0.04209970682859421), ('NDCG@5', 0.9542410373687744), ('NDCG@10', 0.9415664672851562), ('NDCG@20', 0.9207212924957275)])

 ---epoch 18---
1 stage 0.8417218923568726
2 stage 0.9365894198417664
1 stage (val) OrderedDict([('Precision@1', 0.7867494821548462), ('Precision@5', 0.7677016854286194), ('Precision@10', 0.763198971748352), ('Recall@1', 0.003002506447955966), ('Recall@5', 0.013936608098447323), ('Recall@10', 0.028638379648327827), ('NDCG@5', 0.7715412974357605), ('NDCG@10', 0.7669243812561035), ('NDCG@20', 0.7572728991508484)])
2 stage (val) OrderedDict([('Precision@1', 0.9296066164970398), ('Precision@5', 0.8932713270187378), ('Precision@10', 0.8550726771354675), ('Recall@1', 0.013003803789615631), ('Recall@5', 0.036347951740026474), ('Recall@10', 0.05293339863419533), ('NDCG@5', 0.9042857885360718), ('NDCG@10', 0.8779889941215515), ('NDCG@20', 0.8390893340110779)])
1 stage (test) OrderedDict([('Precision@1', 0.8939051628112793), ('Precision@5', 0.8754476308822632), ('Precision@10', 0.8729853630065918), ('Recall@1', 0.003067530458793044), ('Recall@5', 0.01473639253526926), ('Recall@10', 0.030471468344330788), ('NDCG@5', 0.879700779914856), ('NDCG@10', 0.8764643669128418), ('NDCG@20', 0.8630965352058411)])
2 stage (test) OrderedDict([('Precision@1', 0.968397319316864), ('Precision@5', 0.9483321309089661), ('Precision@10', 0.9307999014854431), ('Recall@1', 0.007099753711372614), ('Recall@5', 0.025374682620167732), ('Recall@10', 0.042083121836185455), ('NDCG@5', 0.9541348814964294), ('NDCG@10', 0.9416218996047974), ('NDCG@20', 0.9207408428192139)])

 ---epoch 19---
1 stage 0.8420529961585999
2 stage 0.9355960488319397
1 stage (val) OrderedDict([('Precision@1', 0.7857142686843872), ('Precision@5', 0.7682194113731384), ('Precision@10', 0.7629398703575134), ('Recall@1', 0.0029943427070975304), ('Recall@5', 0.013966984115540981), ('Recall@10', 0.028721632435917854), ('NDCG@5', 0.771885097026825), ('NDCG@10', 0.7667935490608215), ('NDCG@20', 0.7567167282104492)])
2 stage (val) OrderedDict([('Precision@1', 0.9275362491607666), ('Precision@5', 0.8928572535514832), ('Precision@10', 0.8547104001045227), ('Recall@1', 0.01269878912717104), ('Recall@5', 0.03603971749544144), ('Recall@10', 0.052651870995759964), ('NDCG@5', 0.9036076068878174), ('NDCG@10', 0.877312183380127), ('NDCG@20', 0.838592529296875)])
1 stage (test) OrderedDict([('Precision@1', 0.8949084281921387), ('Precision@5', 0.8754475116729736), ('Precision@10', 0.8724083304405212), ('Recall@1', 0.003077692585065961), ('Recall@5', 0.014748155139386654), ('Recall@10', 0.030459009110927582), ('NDCG@5', 0.8798143863677979), ('NDCG@10', 0.8761606812477112), ('NDCG@20', 0.8625475764274597)])
2 stage (test) OrderedDict([('Precision@1', 0.9678956866264343), ('Precision@5', 0.9481315612792969), ('Precision@10', 0.9306493401527405), ('Recall@1', 0.007064411882311106), ('Recall@5', 0.02530802972614765), ('Recall@10', 0.042020756751298904), ('NDCG@5', 0.9538567662239075), ('NDCG@10', 0.9414175152778625), ('NDCG@20', 0.9205048084259033)])
------------------------------------------------------------
Best validation epoch: 1
Best validation stage results
 1 stage: OrderedDict([('Precision@1', 0.773809552192688), ('Precision@5', 0.7595236301422119), ('Precision@10', 0.7618524432182312), ('Recall@1', 0.0026000041980296373), ('Recall@5', 0.013114139437675476), ('Recall@10', 0.027250992134213448), ('NDCG@5', 0.7630928754806519), ('NDCG@10', 0.7632816433906555), ('NDCG@20', 0.7644608616828918)])
 2 stage: OrderedDict([('Precision@1', 0.9409937858581543), ('Precision@5', 0.899482786655426), ('Precision@10', 0.8595760464668274), ('Recall@1', 0.014359145425260067), ('Recall@5', 0.04153316095471382), ('Recall@10', 0.058392204344272614), ('NDCG@5', 0.9118286371231079), ('NDCG@10', 0.8850722908973694), ('NDCG@20', 0.8481661677360535)])
Best test results
 1 stage: OrderedDict([('Precision@1', 0.8826184868812561), ('Precision@5', 0.8726385831832886), ('Precision@10', 0.875619113445282), ('Recall@1', 0.0028993061278015375), ('Recall@5', 0.014489829540252686), ('Recall@10', 0.029994715005159378), ('NDCG@5', 0.8754095435142517), ('NDCG@10', 0.8762668371200562), ('NDCG@20', 0.8735100626945496)])
 2 stage: OrderedDict([('Precision@1', 0.9729119539260864), ('Precision@5', 0.951492428779602), ('Precision@10', 0.9328316450119019), ('Recall@1', 0.007669906131923199), ('Recall@5', 0.027348756790161133), ('Recall@10', 0.04409905523061752), ('NDCG@5', 0.9576801657676697), ('NDCG@10', 0.9447212815284729), ('NDCG@20', 0.9254541397094727)])
loaded full_impression_feats.pt
-----------------------------------------------------
ALGORITHMS EVALUATION 
 with loss type: loss_ips

 ---epoch 0---
1 stage 0.8524834513664246
2 stage 0.9226821064949036
1 stage (val) OrderedDict([('Precision@1', 0.8059006333351135), ('Precision@5', 0.7285715341567993), ('Precision@10', 0.6945663690567017), ('Recall@1', 0.0033738818019628525), ('Recall@5', 0.012849566526710987), ('Recall@10', 0.022611645981669426), ('NDCG@5', 0.7493892312049866), ('NDCG@10', 0.718339741230011), ('NDCG@20', 0.6582445502281189)])
2 stage (val) OrderedDict([('Precision@1', 0.9089027047157288), ('Precision@5', 0.8488615155220032), ('Precision@10', 0.7869071960449219), ('Recall@1', 0.007492325734347105), ('Recall@5', 0.023258013650774956), ('Recall@10', 0.034837715327739716), ('NDCG@5', 0.8623825311660767), ('NDCG@10', 0.8156320452690125), ('NDCG@20', 0.7097929120063782)])
1 stage (test) OrderedDict([('Precision@1', 0.9009280204772949), ('Precision@5', 0.8199729919433594), ('Precision@10', 0.7780259251594543), ('Recall@1', 0.0031824486795812845), ('Recall@5', 0.013757237233221531), ('Recall@10', 0.02530842460691929), ('NDCG@5', 0.8417469263076782), ('NDCG@10', 0.8051412105560303), ('NDCG@20', 0.7202200889587402)])
2 stage (test) OrderedDict([('Precision@1', 0.9573614001274109), ('Precision@5', 0.9179859757423401), ('Precision@10', 0.8724558353424072), ('Recall@1', 0.005138430278748274), ('Recall@5', 0.019317010417580605), ('Recall@10', 0.032909318804740906), ('NDCG@5', 0.9274799227714539), ('NDCG@10', 0.8931178450584412), ('NDCG@20', 0.7715895771980286)])

 ---epoch 1---
1 stage 0.8523178696632385
2 stage 0.9201986789703369
1 stage (val) OrderedDict([('Precision@1', 0.8074533939361572), ('Precision@5', 0.740268886089325), ('Precision@10', 0.7178579568862915), ('Recall@1', 0.003377797780558467), ('Recall@5', 0.013479418121278286), ('Recall@10', 0.023438172414898872), ('NDCG@5', 0.7580297589302063), ('NDCG@10', 0.7362709641456604), ('NDCG@20', 0.6959933042526245)])
2 stage (val) OrderedDict([('Precision@1', 0.9042443037033081), ('Precision@5', 0.853830099105835), ('Precision@10', 0.8083863258361816), ('Recall@1', 0.007100386545062065), ('Recall@5', 0.023182127624750137), ('Recall@10', 0.036283936351537704), ('NDCG@5', 0.8650371432304382), ('NDCG@10', 0.8303576111793518), ('NDCG@20', 0.7567055225372314)])
1 stage (test) OrderedDict([('Precision@1', 0.8999247550964355), ('Precision@5', 0.833516538143158), ('Precision@10', 0.8143201470375061), ('Recall@1', 0.0031813522800803185), ('Recall@5', 0.014173907227814198), ('Recall@10', 0.026543082669377327), ('NDCG@5', 0.8515393137931824), ('NDCG@10', 0.8317602872848511), ('NDCG@20', 0.7784328460693359)])
2 stage (test) OrderedDict([('Precision@1', 0.9558565616607666), ('Precision@5', 0.9250077605247498), ('Precision@10', 0.8939763903617859), ('Recall@1', 0.004968787543475628), ('Recall@5', 0.019337745383381844), ('Recall@10', 0.03394860401749611), ('NDCG@5', 0.93238765001297), ('NDCG@10', 0.9084071516990662), ('NDCG@20', 0.835872232913971)])

 ---epoch 2---
1 stage 0.8523178696632385
2 stage 0.914238452911377
1 stage (val) OrderedDict([('Precision@1', 0.8090062141418457), ('Precision@5', 0.7711179256439209), ('Precision@10', 0.7261391282081604), ('Recall@1', 0.003396489890292287), ('Recall@5', 0.015023346059024334), ('Recall@10', 0.02389802783727646), ('NDCG@5', 0.782675564289093), ('NDCG@10', 0.747334897518158), ('NDCG@20', 0.7151355743408203)])
2 stage (val) OrderedDict([('Precision@1', 0.8949275612831116), ('Precision@5', 0.8567286133766174), ('Precision@10', 0.8154253959655762), ('Recall@1', 0.006594934035092592), ('Recall@5', 0.02299308218061924), ('Recall@10', 0.03672889247536659), ('NDCG@5', 0.8652084469795227), ('NDCG@10', 0.8344432711601257), ('NDCG@20', 0.7782101035118103)])
1 stage (test) OrderedDict([('Precision@1', 0.899172306060791), ('Precision@5', 0.8687783479690552), ('Precision@10', 0.8272854685783386), ('Recall@1', 0.003181388135999441), ('Recall@5', 0.015251808799803257), ('Recall@10', 0.027006568387150764), ('NDCG@5', 0.8787311315536499), ('NDCG@10', 0.846280574798584), ('NDCG@20', 0.8064084053039551)])
2 stage (test) OrderedDict([('Precision@1', 0.9513418674468994), ('Precision@5', 0.9283181428909302), ('Precision@10', 0.8988163471221924), ('Recall@1', 0.004735223483294249), ('Recall@5', 0.019243726506829262), ('Recall@10', 0.03420788049697876), ('NDCG@5', 0.9339382648468018), ('NDCG@10', 0.9116937518119812), ('NDCG@20', 0.864271342754364)])

 ---epoch 3---
1 stage 0.8551324605941772
2 stage 0.9104304909706116
1 stage (val) OrderedDict([('Precision@1', 0.8126294016838074), ('Precision@5', 0.7779499292373657), ('Precision@10', 0.7338512539863586), ('Recall@1', 0.0033686021342873573), ('Recall@5', 0.01513863354921341), ('Recall@10', 0.02453457936644554), ('NDCG@5', 0.7867214679718018), ('NDCG@10', 0.7529513239860535), ('NDCG@20', 0.7277429103851318)])
2 stage (val) OrderedDict([('Precision@1', 0.888198733329773), ('Precision@5', 0.8572463989257812), ('Precision@10', 0.8187380433082581), ('Recall@1', 0.006073897238820791), ('Recall@5', 0.02243436872959137), ('Recall@10', 0.03656478226184845), ('NDCG@5', 0.864194929599762), ('NDCG@10', 0.8359416723251343), ('NDCG@20', 0.7880752086639404)])
1 stage (test) OrderedDict([('Precision@1', 0.9016804695129395), ('Precision@5', 0.8805646300315857), ('Precision@10', 0.8358871340751648), ('Recall@1', 0.003201593179255724), ('Recall@5', 0.015480294823646545), ('Recall@10', 0.02752745896577835), ('NDCG@5', 0.8866994976997375), ('NDCG@10', 0.8532336354255676), ('NDCG@20', 0.825230598449707)])
2 stage (test) OrderedDict([('Precision@1', 0.948833703994751), ('Precision@5', 0.9304746389389038), ('Precision@10', 0.900822103023529), ('Recall@1', 0.004499442409723997), ('Recall@5', 0.01905914954841137), ('Recall@10', 0.03411457687616348), ('NDCG@5', 0.9347596168518066), ('NDCG@10', 0.9129462242126465), ('NDCG@20', 0.8783280849456787)])

 ---epoch 4---
1 stage 0.8413907289505005
2 stage 0.9052980542182922
1 stage (val) OrderedDict([('Precision@1', 0.7888198494911194), ('Precision@5', 0.7903726100921631), ('Precision@10', 0.7498452067375183), ('Recall@1', 0.002945383545011282), ('Recall@5', 0.015712754800915718), ('Recall@10', 0.026318395510315895), ('NDCG@5', 0.7896175384521484), ('NDCG@10', 0.7621515393257141), ('NDCG@20', 0.7297952771186829)])
2 stage (val) OrderedDict([('Precision@1', 0.8783643841743469), ('Precision@5', 0.8547619581222534), ('Precision@10', 0.8183240294456482), ('Recall@1', 0.005298440344631672), ('Recall@5', 0.021424230188131332), ('Recall@10', 0.0356605164706707), ('NDCG@5', 0.8599972128868103), ('NDCG@10', 0.833607017993927), ('NDCG@20', 0.7888606190681458)])
1 stage (test) OrderedDict([('Precision@1', 0.892400324344635), ('Precision@5', 0.8925023078918457), ('Precision@10', 0.8492045998573303), ('Recall@1', 0.003077918430790305), ('Recall@5', 0.01589050516486168), ('Recall@10', 0.028579508885741234), ('NDCG@5', 0.8925580978393555), ('NDCG@10', 0.862808108329773), ('NDCG@20', 0.8297770023345947)])
2 stage (test) OrderedDict([('Precision@1', 0.9458239078521729), ('Precision@5', 0.929722249507904), ('Precision@10', 0.9002196192741394), ('Recall@1', 0.0043699550442397594), ('Recall@5', 0.01892728917300701), ('Recall@10', 0.034039173275232315), ('NDCG@5', 0.9335896968841553), ('NDCG@10', 0.9120830297470093), ('NDCG@20', 0.8815329670906067)])

 ---epoch 5---
1 stage 0.8399006724357605
2 stage 0.9016556143760681
1 stage (val) OrderedDict([('Precision@1', 0.784679114818573), ('Precision@5', 0.7935816645622253), ('Precision@10', 0.7521226406097412), ('Recall@1', 0.002859697910025716), ('Recall@5', 0.015919549390673637), ('Recall@10', 0.026556117460131645), ('NDCG@5', 0.7915852069854736), ('NDCG@10', 0.7638789415359497), ('NDCG@20', 0.7303902506828308)])
2 stage (val) OrderedDict([('Precision@1', 0.8726708292961121), ('Precision@5', 0.8535197377204895), ('Precision@10', 0.8173408508300781), ('Recall@1', 0.0049555376172065735), ('Recall@5', 0.02096543461084366), ('Recall@10', 0.03509262204170227), ('NDCG@5', 0.857671320438385), ('NDCG@10', 0.831745982170105), ('NDCG@20', 0.787376344203949)])
1 stage (test) OrderedDict([('Precision@1', 0.8921495079994202), ('Precision@5', 0.8937063813209534), ('Precision@10', 0.851612389087677), ('Recall@1', 0.003065726952627301), ('Recall@5', 0.015988698229193687), ('Recall@10', 0.028743557631969452), ('NDCG@5', 0.8938055038452148), ('NDCG@10', 0.864892840385437), ('NDCG@20', 0.8305812478065491)])
2 stage (test) OrderedDict([('Precision@1', 0.9430649876594543), ('Precision@5', 0.9288694858551025), ('Precision@10', 0.9002949595451355), ('Recall@1', 0.004171710927039385), ('Recall@5', 0.018756309524178505), ('Recall@10', 0.03390856832265854), ('NDCG@5', 0.93243408203125), ('NDCG@10', 0.9116397500038147), ('NDCG@20', 0.8809553980827332)])

 ---epoch 6---
1 stage 0.8364238739013672
2 stage 0.9009934067726135
1 stage (val) OrderedDict([('Precision@1', 0.7774327397346497), ('Precision@5', 0.7921321392059326), ('Precision@10', 0.7531577348709106), ('Recall@1', 0.0026823971420526505), ('Recall@5', 0.015751715749502182), ('Recall@10', 0.026577265933156013), ('NDCG@5', 0.7894245982170105), ('NDCG@10', 0.7636283040046692), ('NDCG@20', 0.7287218570709229)])
2 stage (val) OrderedDict([('Precision@1', 0.8700827956199646), ('Precision@5', 0.8522773385047913), ('Precision@10', 0.8164607882499695), ('Recall@1', 0.004706846084445715), ('Recall@5', 0.02080991119146347), ('Recall@10', 0.0349370576441288), ('NDCG@5', 0.8564035892486572), ('NDCG@10', 0.8307410478591919), ('NDCG@20', 0.7849217057228088)])
1 stage (test) OrderedDict([('Precision@1', 0.8903937935829163), ('Precision@5', 0.8929539322853088), ('Precision@10', 0.8527154922485352), ('Recall@1', 0.0030356096103787422), ('Recall@5', 0.015921281650662422), ('Recall@10', 0.02880859561264515), ('NDCG@5', 0.8929928541183472), ('NDCG@10', 0.8653793334960938), ('NDCG@20', 0.8286440372467041)])
2 stage (test) OrderedDict([('Precision@1', 0.9433158040046692), ('Precision@5', 0.9282174110412598), ('Precision@10', 0.8986901044845581), ('Recall@1', 0.004175729583948851), ('Recall@5', 0.018715355545282364), ('Recall@10', 0.03379132226109505), ('NDCG@5', 0.9319992661476135), ('NDCG@10', 0.9105207920074463), ('NDCG@20', 0.8784573078155518)])

 ---epoch 7---
1 stage 0.8357616066932678
2 stage 0.9024834632873535
1 stage (val) OrderedDict([('Precision@1', 0.7763975262641907), ('Precision@5', 0.7902689576148987), ('Precision@10', 0.7525884509086609), ('Recall@1', 0.002668767934665084), ('Recall@5', 0.015492603182792664), ('Recall@10', 0.026521658524870872), ('NDCG@5', 0.7879995703697205), ('NDCG@10', 0.7629519701004028), ('NDCG@20', 0.7269257307052612)])
2 stage (val) OrderedDict([('Precision@1', 0.8742235898971558), ('Precision@5', 0.8523808121681213), ('Precision@10', 0.8155290484428406), ('Recall@1', 0.005449890159070492), ('Recall@5', 0.021519141271710396), ('Recall@10', 0.035540997982025146), ('NDCG@5', 0.857566773891449), ('NDCG@10', 0.831111490726471), ('NDCG@20', 0.783305823802948)])
1 stage (test) OrderedDict([('Precision@1', 0.8898921608924866), ('Precision@5', 0.8919004797935486), ('Precision@10', 0.8522894978523254), ('Recall@1', 0.003021828830242157), ('Recall@5', 0.01585036888718605), ('Recall@10', 0.028781626373529434), ('NDCG@5', 0.8921485543251038), ('NDCG@10', 0.8649379014968872), ('NDCG@20', 0.8258609771728516)])
2 stage (test) OrderedDict([('Precision@1', 0.943566620349884), ('Precision@5', 0.9276154041290283), ('Precision@10', 0.8964574933052063), ('Recall@1', 0.004318939987570047), ('Recall@5', 0.01881246082484722), ('Recall@10', 0.03382445126771927), ('NDCG@5', 0.9317699670791626), ('NDCG@10', 0.9091672897338867), ('NDCG@20', 0.8752578496932983)])

 ---epoch 8---
1 stage 0.8369205594062805
2 stage 0.9044702053070068
1 stage (val) OrderedDict([('Precision@1', 0.7753623127937317), ('Precision@5', 0.7872669696807861), ('Precision@10', 0.7517603635787964), ('Recall@1', 0.0026448846329003572), ('Recall@5', 0.015114248730242252), ('Recall@10', 0.026403173804283142), ('NDCG@5', 0.7859417796134949), ('NDCG@10', 0.762130618095398), ('NDCG@20', 0.7245774269104004)])
2 stage (val) OrderedDict([('Precision@1', 0.8762940168380737), ('Precision@5', 0.8530019521713257), ('Precision@10', 0.8143906593322754), ('Recall@1', 0.005667500197887421), ('Recall@5', 0.021753355860710144), ('Recall@10', 0.03565359115600586), ('NDCG@5', 0.8584415316581726), ('NDCG@10', 0.8307509422302246), ('NDCG@20', 0.7811580896377563)])
1 stage (test) OrderedDict([('Precision@1', 0.8921495079994202), ('Precision@5', 0.8898940086364746), ('Precision@10', 0.8523649573326111), ('Recall@1', 0.003031714353710413), ('Recall@5', 0.01569954864680767), ('Recall@10', 0.028771789744496346), ('NDCG@5', 0.8910378217697144), ('NDCG@10', 0.864936113357544), ('NDCG@20', 0.8230621218681335)])
2 stage (test) OrderedDict([('Precision@1', 0.945573091506958), ('Precision@5', 0.9280168414115906), ('Precision@10', 0.8946259021759033), ('Recall@1', 0.004472037311643362), ('Recall@5', 0.019000230357050896), ('Recall@10', 0.03391018509864807), ('NDCG@5', 0.932437002658844), ('NDCG@10', 0.908295750617981), ('NDCG@20', 0.8722979426383972)])

 ---epoch 9---
1 stage 0.8380795121192932
2 stage 0.9072847962379456
1 stage (val) OrderedDict([('Precision@1', 0.7774327397346497), ('Precision@5', 0.7842649817466736), ('Precision@10', 0.7509323954582214), ('Recall@1', 0.002658348297700286), ('Recall@5', 0.014832721091806889), ('Recall@10', 0.026316339150071144), ('NDCG@5', 0.7840657234191895), ('NDCG@10', 0.7613645195960999), ('NDCG@20', 0.7229173183441162)])
2 stage (val) OrderedDict([('Precision@1', 0.8799172043800354), ('Precision@5', 0.8540369272232056), ('Precision@10', 0.8135622143745422), ('Recall@1', 0.0062690419144928455), ('Recall@5', 0.022524649277329445), ('Recall@10', 0.036338649690151215), ('NDCG@5', 0.8600473999977112), ('NDCG@10', 0.8311757445335388), ('NDCG@20', 0.7800295948982239)])
1 stage (test) OrderedDict([('Precision@1', 0.8929019570350647), ('Precision@5', 0.8884896039962769), ('Precision@10', 0.8522148728370667), ('Recall@1', 0.003033872228115797), ('Recall@5', 0.015583191998302937), ('Recall@10', 0.02877078764140606), ('NDCG@5', 0.8902586698532104), ('NDCG@10', 0.8647649884223938), ('NDCG@20', 0.819994330406189)])
2 stage (test) OrderedDict([('Precision@1', 0.9480812549591064), ('Precision@5', 0.9282174706459045), ('Precision@10', 0.8930951952934265), ('Recall@1', 0.0048433043994009495), ('Recall@5', 0.01938510313630104), ('Recall@10', 0.034199949353933334), ('NDCG@5', 0.9331042766571045), ('NDCG@10', 0.9078661203384399), ('NDCG@20', 0.8701085448265076)])

 ---epoch 10---
1 stage 0.8384106159210205
2 stage 0.9134106040000916
1 stage (val) OrderedDict([('Precision@1', 0.7769151329994202), ('Precision@5', 0.7831262350082397), ('Precision@10', 0.7497938275337219), ('Recall@1', 0.002638294128701091), ('Recall@5', 0.01469119917601347), ('Recall@10', 0.026257483288645744), ('NDCG@5', 0.7835829854011536), ('NDCG@10', 0.7605829238891602), ('NDCG@20', 0.7207967042922974)])
2 stage (val) OrderedDict([('Precision@1', 0.8918219208717346), ('Precision@5', 0.8570390939712524), ('Precision@10', 0.814907968044281), ('Recall@1', 0.008813455700874329), ('Recall@5', 0.02534385398030281), ('Recall@10', 0.03912559151649475), ('NDCG@5', 0.8657218813896179), ('NDCG@10', 0.8357923626899719), ('NDCG@20', 0.7820301651954651)])
1 stage (test) OrderedDict([('Precision@1', 0.8936544060707092), ('Precision@5', 0.8870350122451782), ('Precision@10', 0.852089524269104), ('Recall@1', 0.0030382603872567415), ('Recall@5', 0.015487873926758766), ('Recall@10', 0.028747452422976494), ('NDCG@5', 0.8893518447875977), ('NDCG@10', 0.8645435571670532), ('NDCG@20', 0.8168845772743225)])
2 stage (test) OrderedDict([('Precision@1', 0.9515926837921143), ('Precision@5', 0.9289197325706482), ('Precision@10', 0.8925931453704834), ('Recall@1', 0.00530562037602067), ('Recall@5', 0.01984964869916439), ('Recall@10', 0.034625839442014694), ('NDCG@5', 0.934455931186676), ('NDCG@10', 0.908370316028595), ('NDCG@20', 0.8683386445045471)])

 ---epoch 11---
1 stage 0.8382450342178345
2 stage 0.9178808331489563
1 stage (val) OrderedDict([('Precision@1', 0.7763975262641907), ('Precision@5', 0.7809521555900574), ('Precision@10', 0.7494315505027771), ('Recall@1', 0.0026443819515407085), ('Recall@5', 0.014412852004170418), ('Recall@10', 0.026261471211910248), ('NDCG@5', 0.7819441556930542), ('NDCG@10', 0.7598832845687866), ('NDCG@20', 0.7190945148468018)])
2 stage (val) OrderedDict([('Precision@1', 0.8969979286193848), ('Precision@5', 0.8577637672424316), ('Precision@10', 0.8152186274528503), ('Recall@1', 0.009422323666512966), ('Recall@5', 0.025983646512031555), ('Recall@10', 0.039800457656383514), ('NDCG@5', 0.8674310445785522), ('NDCG@10', 0.8371434211730957), ('NDCG@20', 0.7816880941390991)])
1 stage (test) OrderedDict([('Precision@1', 0.8936544060707092), ('Precision@5', 0.8851792812347412), ('Precision@10', 0.8511864542961121), ('Recall@1', 0.003037412418052554), ('Recall@5', 0.015353466384112835), ('Recall@10', 0.028710903599858284), ('NDCG@5', 0.8880338668823242), ('NDCG@10', 0.863714873790741), ('NDCG@20', 0.8142037987709045)])
2 stage (test) OrderedDict([('Precision@1', 0.9558565616607666), ('Precision@5', 0.9299732446670532), ('Precision@10', 0.8927935361862183), ('Recall@1', 0.0059306323528289795), ('Recall@5', 0.020532211288809776), ('Recall@10', 0.03530930355191231), ('NDCG@5', 0.9361388683319092), ('NDCG@10', 0.9095468521118164), ('NDCG@20', 0.8673228025436401)])

 ---epoch 12---
1 stage 0.8379139304161072
2 stage 0.9187086224555969
1 stage (val) OrderedDict([('Precision@1', 0.7763975262641907), ('Precision@5', 0.7790886759757996), ('Precision@10', 0.7482412457466125), ('Recall@1', 0.0026424473617225885), ('Recall@5', 0.014272757805883884), ('Recall@10', 0.02620319463312626), ('NDCG@5', 0.7806203961372375), ('NDCG@10', 0.7588120102882385), ('NDCG@20', 0.7176167368888855)])
2 stage (val) OrderedDict([('Precision@1', 0.8980331420898438), ('Precision@5', 0.8579708337783813), ('Precision@10', 0.8153222799301147), ('Recall@1', 0.009448529221117496), ('Recall@5', 0.026153702288866043), ('Recall@10', 0.03998563066124916), ('NDCG@5', 0.8678606748580933), ('NDCG@10', 0.8374278545379639), ('NDCG@20', 0.7804821729660034)])
1 stage (test) OrderedDict([('Precision@1', 0.8931527733802795), ('Precision@5', 0.8826211094856262), ('Precision@10', 0.8504837155342102), ('Recall@1', 0.003025393933057785), ('Recall@5', 0.015070094726979733), ('Recall@10', 0.028680836781859398), ('NDCG@5', 0.8862404227256775), ('NDCG@10', 0.8629363775253296), ('NDCG@20', 0.812140166759491)])
2 stage (test) OrderedDict([('Precision@1', 0.9566089510917664), ('Precision@5', 0.9305751323699951), ('Precision@10', 0.8924673795700073), ('Recall@1', 0.005970606114715338), ('Recall@5', 0.020597636699676514), ('Recall@10', 0.0353248156607151), ('NDCG@5', 0.9366065859794617), ('NDCG@10', 0.9094142317771912), ('NDCG@20', 0.8652106523513794)])

 ---epoch 13---
1 stage 0.8370860815048218
2 stage 0.9218543171882629
1 stage (val) OrderedDict([('Precision@1', 0.773809552192688), ('Precision@5', 0.776500940322876), ('Precision@10', 0.7477753162384033), ('Recall@1', 0.002600757172331214), ('Recall@5', 0.014013935811817646), ('Recall@10', 0.026155436411499977), ('NDCG@5', 0.7787651419639587), ('NDCG@10', 0.7581520676612854), ('NDCG@20', 0.7166268229484558)])
2 stage (val) OrderedDict([('Precision@1', 0.9042443037033081), ('Precision@5', 0.8592130541801453), ('Precision@10', 0.8160468339920044), ('Recall@1', 0.009929532185196877), ('Recall@5', 0.026682788506150246), ('Recall@10', 0.04050769284367561), ('NDCG@5', 0.8700749278068542), ('NDCG@10', 0.8390794396400452), ('NDCG@20', 0.7801383137702942)])
1 stage (test) OrderedDict([('Precision@1', 0.8931527733802795), ('Precision@5', 0.8803136944770813), ('Precision@10', 0.8495557308197021), ('Recall@1', 0.003027866594493389), ('Recall@5', 0.01499134674668312), ('Recall@10', 0.02862103283405304), ('NDCG@5', 0.8846299648284912), ('NDCG@10', 0.86198890209198), ('NDCG@20', 0.8100637793540955)])
2 stage (test) OrderedDict([('Precision@1', 0.9583646655082703), ('Precision@5', 0.9305752515792847), ('Precision@10', 0.8925175666809082), ('Recall@1', 0.006159719079732895), ('Recall@5', 0.02088220976293087), ('Recall@10', 0.035595737397670746), ('NDCG@5', 0.9370740056037903), ('NDCG@10', 0.9098483324050903), ('NDCG@20', 0.8639865517616272)])

 ---epoch 14---
1 stage 0.8369205594062805
2 stage 0.9240066409111023
1 stage (val) OrderedDict([('Precision@1', 0.773809552192688), ('Precision@5', 0.773705780506134), ('Precision@10', 0.7468438148498535), ('Recall@1', 0.002625058637931943), ('Recall@5', 0.013789812102913857), ('Recall@10', 0.026069900020956993), ('NDCG@5', 0.7768892645835876), ('NDCG@10', 0.7571765780448914), ('NDCG@20', 0.715872049331665)])
2 stage (val) OrderedDict([('Precision@1', 0.9042443037033081), ('Precision@5', 0.8591095209121704), ('Precision@10', 0.8163056969642639), ('Recall@1', 0.009976180270314217), ('Recall@5', 0.02666594833135605), ('Recall@10', 0.0405643992125988), ('NDCG@5', 0.8700694441795349), ('NDCG@10', 0.8392456769943237), ('NDCG@20', 0.7795045375823975)])
1 stage (test) OrderedDict([('Precision@1', 0.8929019570350647), ('Precision@5', 0.8788090348243713), ('Precision@10', 0.8485274314880371), ('Recall@1', 0.0030219501350075006), ('Recall@5', 0.014938991516828537), ('Recall@10', 0.02854839526116848), ('NDCG@5', 0.8835630416870117), ('NDCG@10', 0.861046552658081), ('NDCG@20', 0.8082680702209473)])
2 stage (test) OrderedDict([('Precision@1', 0.9616252779960632), ('Precision@5', 0.9315785765647888), ('Precision@10', 0.8929688334465027), ('Recall@1', 0.0066758450120687485), ('Recall@5', 0.02143881842494011), ('Recall@10', 0.03613971546292305), ('NDCG@5', 0.9386357069015503), ('NDCG@10', 0.9109789729118347), ('NDCG@20', 0.8636295795440674)])

 ---epoch 15---
1 stage 0.8367549777030945
2 stage 0.9263245463371277
1 stage (val) OrderedDict([('Precision@1', 0.7732919454574585), ('Precision@5', 0.7711178064346313), ('Precision@10', 0.7458087205886841), ('Recall@1', 0.0026230306830257177), ('Recall@5', 0.013649744912981987), ('Recall@10', 0.025645026937127113), ('NDCG@5', 0.7750684022903442), ('NDCG@10', 0.756171464920044), ('NDCG@20', 0.7145808935165405)])
2 stage (val) OrderedDict([('Precision@1', 0.9078674912452698), ('Precision@5', 0.8598342537879944), ('Precision@10', 0.8168233036994934), ('Recall@1', 0.010108765214681625), ('Recall@5', 0.026852861046791077), ('Recall@10', 0.04076804965734482), ('NDCG@5', 0.8712517023086548), ('NDCG@10', 0.8401376605033875), ('NDCG@20', 0.7791740894317627)])
1 stage (test) OrderedDict([('Precision@1', 0.8929019570350647), ('Precision@5', 0.8776553869247437), ('Precision@10', 0.8467967510223389), ('Recall@1', 0.0030198993626981974), ('Recall@5', 0.014920705929398537), ('Recall@10', 0.02837933599948883), ('NDCG@5', 0.8827570676803589), ('NDCG@10', 0.8596747517585754), ('NDCG@20', 0.806827962398529)])
2 stage (test) OrderedDict([('Precision@1', 0.9633809924125671), ('Precision@5', 0.9314783215522766), ('Precision@10', 0.8932698965072632), ('Recall@1', 0.006833173334598541), ('Recall@5', 0.02157573401927948), ('Recall@10', 0.03630045801401138), ('NDCG@5', 0.9389359354972839), ('NDCG@10', 0.9114251732826233), ('NDCG@20', 0.8627160787582397)])

 ---epoch 16---
1 stage 0.8377483487129211
2 stage 0.9279801249504089
1 stage (val) OrderedDict([('Precision@1', 0.7732919454574585), ('Precision@5', 0.7703932523727417), ('Precision@10', 0.7450322508811951), ('Recall@1', 0.0026215016841888428), ('Recall@5', 0.01363329030573368), ('Recall@10', 0.02535092830657959), ('NDCG@5', 0.7744974493980408), ('NDCG@10', 0.7555225491523743), ('NDCG@20', 0.7141284346580505)])
2 stage (val) OrderedDict([('Precision@1', 0.909937858581543), ('Precision@5', 0.85973060131073), ('Precision@10', 0.8169785737991333), ('Recall@1', 0.010247328318655491), ('Recall@5', 0.026916243135929108), ('Recall@10', 0.04083896055817604), ('NDCG@5', 0.871487021446228), ('NDCG@10', 0.8404349684715271), ('NDCG@20', 0.7784505486488342)])
1 stage (test) OrderedDict([('Precision@1', 0.894406795501709), ('Precision@5', 0.8763011693954468), ('Precision@10', 0.8460192084312439), ('Recall@1', 0.0030427267774939537), ('Recall@5', 0.014874869957566261), ('Recall@10', 0.02825956419110298), ('NDCG@5', 0.8819859623908997), ('NDCG@10', 0.8590070009231567), ('NDCG@20', 0.8056714534759521)])
2 stage (test) OrderedDict([('Precision@1', 0.9648858904838562), ('Precision@5', 0.9313278198242188), ('Precision@10', 0.8936462998390198), ('Recall@1', 0.0066637517884373665), ('Recall@5', 0.02140112966299057), ('Recall@10', 0.03614155203104019), ('NDCG@5', 0.9389299154281616), ('NDCG@10', 0.9116401672363281), ('NDCG@20', 0.8616355061531067)])

 ---epoch 17---
1 stage 0.8380795121192932
2 stage 0.928311288356781
1 stage (val) OrderedDict([('Precision@1', 0.7743270993232727), ('Precision@5', 0.7690474987030029), ('Precision@10', 0.7437383532524109), ('Recall@1', 0.0026126643642783165), ('Recall@5', 0.013555226847529411), ('Recall@10', 0.025189176201820374), ('NDCG@5', 0.7735527753829956), ('NDCG@10', 0.7544404864311218), ('NDCG@20', 0.7135841250419617)])
2 stage (val) OrderedDict([('Precision@1', 0.910973072052002), ('Precision@5', 0.858384907245636), ('Precision@10', 0.8159434795379639), ('Recall@1', 0.010241901502013206), ('Recall@5', 0.026761410757899284), ('Recall@10', 0.04070962220430374), ('NDCG@5', 0.8705347776412964), ('NDCG@10', 0.8395485281944275), ('NDCG@20', 0.7770092487335205)])
1 stage (test) OrderedDict([('Precision@1', 0.894406795501709), ('Precision@5', 0.8756492137908936), ('Precision@10', 0.8449908494949341), ('Recall@1', 0.0030495007522404194), ('Recall@5', 0.01483848039060831), ('Recall@10', 0.028159769251942635), ('NDCG@5', 0.881527304649353), ('NDCG@10', 0.8581295013427734), ('NDCG@20', 0.8043125867843628)])
2 stage (test) OrderedDict([('Precision@1', 0.9648858904838562), ('Precision@5', 0.9307761192321777), ('Precision@10', 0.8930948376655579), ('Recall@1', 0.006684644613415003), ('Recall@5', 0.02141491509974003), ('Recall@10', 0.03612670674920082), ('NDCG@5', 0.9385197758674622), ('NDCG@10', 0.911191999912262), ('NDCG@20', 0.860363781452179)])

 ---epoch 18---
1 stage 0.8385761976242065
2 stage 0.9284768104553223
1 stage (val) OrderedDict([('Precision@1', 0.7753623127937317), ('Precision@5', 0.7689440250396729), ('Precision@10', 0.7423926591873169), ('Recall@1', 0.0026258444413542747), ('Recall@5', 0.013555916957557201), ('Recall@10', 0.02488681487739086), ('NDCG@5', 0.7735055088996887), ('NDCG@10', 0.7535225749015808), ('NDCG@20', 0.7133587598800659)])
2 stage (val) OrderedDict([('Precision@1', 0.9120082855224609), ('Precision@5', 0.8580743074417114), ('Precision@10', 0.815373957157135), ('Recall@1', 0.010421862825751305), ('Recall@5', 0.026906386017799377), ('Recall@10', 0.040826473385095596), ('NDCG@5', 0.8705376982688904), ('NDCG@10', 0.8393794298171997), ('NDCG@20', 0.776407778263092)])
1 stage (test) OrderedDict([('Precision@1', 0.8946576118469238), ('Precision@5', 0.8744452595710754), ('Precision@10', 0.8425575494766235), ('Recall@1', 0.0030520563013851643), ('Recall@5', 0.01479689683765173), ('Recall@10', 0.0279135312885046), ('NDCG@5', 0.8807300925254822), ('NDCG@10', 0.8563908338546753), ('NDCG@20', 0.8030115365982056)])
2 stage (test) OrderedDict([('Precision@1', 0.9646350741386414), ('Precision@5', 0.9301741719245911), ('Precision@10', 0.8928941488265991), ('Recall@1', 0.006708457134664059), ('Recall@5', 0.021374143660068512), ('Recall@10', 0.036129772663116455), ('NDCG@5', 0.9379391670227051), ('NDCG@10', 0.9108685255050659), ('NDCG@20', 0.8594520092010498)])

 ---epoch 19---
1 stage 0.8392384052276611
2 stage 0.9306291341781616
1 stage (val) OrderedDict([('Precision@1', 0.7779502868652344), ('Precision@5', 0.7680123448371887), ('Precision@10', 0.7404776215553284), ('Recall@1', 0.0026848965790122747), ('Recall@5', 0.013484515249729156), ('Recall@10', 0.02446618862450123), ('NDCG@5', 0.7731295824050903), ('NDCG@10', 0.7523353695869446), ('NDCG@20', 0.712979793548584)])
2 stage (val) OrderedDict([('Precision@1', 0.9145962595939636), ('Precision@5', 0.857660174369812), ('Precision@10', 0.8152185082435608), ('Recall@1', 0.01090286485850811), ('Recall@5', 0.027272948995232582), ('Recall@10', 0.041257504373788834), ('NDCG@5', 0.8707783222198486), ('NDCG@10', 0.839805006980896), ('NDCG@20', 0.7766426205635071)])
1 stage (test) OrderedDict([('Precision@1', 0.894406795501709), ('Precision@5', 0.8728401064872742), ('Precision@10', 0.8400994539260864), ('Recall@1', 0.0030561115127056837), ('Recall@5', 0.014737891964614391), ('Recall@10', 0.02773532271385193), ('NDCG@5', 0.8795916438102722), ('NDCG@10', 0.8545643091201782), ('NDCG@20', 0.8020243644714355)])
2 stage (test) OrderedDict([('Precision@1', 0.9666416049003601), ('Precision@5', 0.9304250478744507), ('Precision@10', 0.8929947018623352), ('Recall@1', 0.007100214716047049), ('Recall@5', 0.021800579503178596), ('Recall@10', 0.03653929382562637), ('NDCG@5', 0.9387186765670776), ('NDCG@10', 0.9114676117897034), ('NDCG@20', 0.8593714833259583)])
------------------------------------------------------------
Best validation epoch: 3
Best validation stage results
 1 stage: OrderedDict([('Precision@1', 0.8126294016838074), ('Precision@5', 0.7779499292373657), ('Precision@10', 0.7338512539863586), ('Recall@1', 0.0033686021342873573), ('Recall@5', 0.01513863354921341), ('Recall@10', 0.02453457936644554), ('NDCG@5', 0.7867214679718018), ('NDCG@10', 0.7529513239860535), ('NDCG@20', 0.7277429103851318)])
 2 stage: OrderedDict([('Precision@1', 0.888198733329773), ('Precision@5', 0.8572463989257812), ('Precision@10', 0.8187380433082581), ('Recall@1', 0.006073897238820791), ('Recall@5', 0.02243436872959137), ('Recall@10', 0.03656478226184845), ('NDCG@5', 0.864194929599762), ('NDCG@10', 0.8359416723251343), ('NDCG@20', 0.7880752086639404)])
Best test results
 1 stage: OrderedDict([('Precision@1', 0.9016804695129395), ('Precision@5', 0.8805646300315857), ('Precision@10', 0.8358871340751648), ('Recall@1', 0.003201593179255724), ('Recall@5', 0.015480294823646545), ('Recall@10', 0.02752745896577835), ('NDCG@5', 0.8866994976997375), ('NDCG@10', 0.8532336354255676), ('NDCG@20', 0.825230598449707)])
 2 stage: OrderedDict([('Precision@1', 0.948833703994751), ('Precision@5', 0.9304746389389038), ('Precision@10', 0.900822103023529), ('Recall@1', 0.004499442409723997), ('Recall@5', 0.01905914954841137), ('Recall@10', 0.03411457687616348), ('NDCG@5', 0.9347596168518066), ('NDCG@10', 0.9129462242126465), ('NDCG@20', 0.8783280849456787)])
loaded full_impression_feats.pt
-----------------------------------------------------
ALGORITHMS EVALUATION 
 with loss type: loss_2s

 ---epoch 0---
1 stage 0.873344361782074
2 stage 0.9384106397628784
1 stage (val) OrderedDict([('Precision@1', 0.8338509202003479), ('Precision@5', 0.7877851128578186), ('Precision@10', 0.7181189060211182), ('Recall@1', 0.003642122959718108), ('Recall@5', 0.020684462040662766), ('Recall@10', 0.041265055537223816), ('NDCG@5', 0.7985565066337585), ('NDCG@10', 0.7462682723999023), ('NDCG@20', 0.6313529014587402)])
2 stage (val) OrderedDict([('Precision@1', 0.9301242232322693), ('Precision@5', 0.875673234462738), ('Precision@10', 0.8062130808830261), ('Recall@1', 0.014403818175196648), ('Recall@5', 0.03602266684174538), ('Recall@10', 0.05059070140123367), ('NDCG@5', 0.8918942213058472), ('NDCG@10', 0.8433381915092468), ('NDCG@20', 0.7105907201766968)])
1 stage (test) OrderedDict([('Precision@1', 0.9189866781234741), ('Precision@5', 0.8634147047996521), ('Precision@10', 0.78136146068573), ('Recall@1', 0.0034247369039803743), ('Recall@5', 0.017489982768893242), ('Recall@10', 0.03379764035344124), ('NDCG@5', 0.8775942325592041), ('NDCG@10', 0.8160069584846497), ('NDCG@20', 0.6786080598831177)])
2 stage (test) OrderedDict([('Precision@1', 0.9709054231643677), ('Precision@5', 0.9409087300300598), ('Precision@10', 0.8751149773597717), ('Recall@1', 0.009031438268721104), ('Recall@5', 0.026501670479774475), ('Recall@10', 0.041449856013059616), ('NDCG@5', 0.9497897028923035), ('NDCG@10', 0.9045546650886536), ('NDCG@20', 0.7551402449607849)])

 ---epoch 1---
1 stage 0.8753311634063721
2 stage 0.9385761618614197
1 stage (val) OrderedDict([('Precision@1', 0.8354037404060364), ('Precision@5', 0.8445125222206116), ('Precision@10', 0.755904495716095), ('Recall@1', 0.0036841146647930145), ('Recall@5', 0.032292719930410385), ('Recall@10', 0.046266473829746246), ('NDCG@5', 0.843669593334198), ('NDCG@10', 0.786135733127594), ('NDCG@20', 0.6578509211540222)])
2 stage (val) OrderedDict([('Precision@1', 0.9311594367027283), ('Precision@5', 0.8897523283958435), ('Precision@10', 0.8409956097602844), ('Recall@1', 0.014148821122944355), ('Recall@5', 0.04270213097333908), ('Recall@10', 0.05903777852654457), ('NDCG@5', 0.9045421481132507), ('NDCG@10', 0.8711667060852051), ('NDCG@20', 0.7512878775596619)])
1 stage (test) OrderedDict([('Precision@1', 0.9212440252304077), ('Precision@5', 0.9205431342124939), ('Precision@10', 0.8301914930343628), ('Recall@1', 0.0034814050886780024), ('Recall@5', 0.024621345102787018), ('Recall@10', 0.038262225687503815), ('NDCG@5', 0.9212713241577148), ('NDCG@10', 0.861315131187439), ('NDCG@20', 0.7117437720298767)])
2 stage (test) OrderedDict([('Precision@1', 0.9706546068191528), ('Precision@5', 0.9434677362442017), ('Precision@10', 0.9044354557991028), ('Recall@1', 0.008502614684402943), ('Recall@5', 0.029152661561965942), ('Recall@10', 0.04529530555009842), ('NDCG@5', 0.9521176218986511), ('NDCG@10', 0.9244924783706665), ('NDCG@20', 0.7995257377624512)])

 ---epoch 2---
1 stage 0.8731788396835327
2 stage 0.9435430765151978
1 stage (val) OrderedDict([('Precision@1', 0.8312629461288452), ('Precision@5', 0.8476181626319885), ('Precision@10', 0.7773318886756897), ('Recall@1', 0.0035402001813054085), ('Recall@5', 0.03262514993548393), ('Recall@10', 0.04820612445473671), ('NDCG@5', 0.8456135988235474), ('NDCG@10', 0.7999119758605957), ('NDCG@20', 0.6980400085449219)])
2 stage (val) OrderedDict([('Precision@1', 0.9394409656524658), ('Precision@5', 0.9113879203796387), ('Precision@10', 0.8637183904647827), ('Recall@1', 0.014307752251625061), ('Recall@5', 0.05073155462741852), ('Recall@10', 0.07030732184648514), ('NDCG@5', 0.9216817617416382), ('NDCG@10', 0.891334593296051), ('NDCG@20', 0.7943497896194458)])
1 stage (test) OrderedDict([('Precision@1', 0.9199899435043335), ('Precision@5', 0.9240540862083435), ('Precision@10', 0.863624095916748), ('Recall@1', 0.0034455673303455114), ('Recall@5', 0.024460382759571075), ('Recall@10', 0.03978703171014786), ('NDCG@5', 0.9238967895507812), ('NDCG@10', 0.8838794231414795), ('NDCG@20', 0.7710138559341431)])
2 stage (test) OrderedDict([('Precision@1', 0.9741660356521606), ('Precision@5', 0.9570612907409668), ('Precision@10', 0.9234714508056641), ('Recall@1', 0.00781621690839529), ('Recall@5', 0.03321736305952072), ('Recall@10', 0.050937220454216), ('NDCG@5', 0.962189257144928), ('NDCG@10', 0.9397227764129639), ('NDCG@20', 0.8485462069511414)])

 ---epoch 3---
1 stage 0.8728476762771606
2 stage 0.943708598613739
1 stage (val) OrderedDict([('Precision@1', 0.8307453393936157), ('Precision@5', 0.8465829491615295), ('Precision@10', 0.7751567363739014), ('Recall@1', 0.0035668653436005116), ('Recall@5', 0.03270033001899719), ('Recall@10', 0.04852311685681343), ('NDCG@5', 0.8448703289031982), ('NDCG@10', 0.7976555228233337), ('NDCG@20', 0.7094318270683289)])
2 stage (val) OrderedDict([('Precision@1', 0.9404761791229248), ('Precision@5', 0.91521817445755), ('Precision@10', 0.8648566603660583), ('Recall@1', 0.014898229390382767), ('Recall@5', 0.0528409406542778), ('Recall@10', 0.07275377213954926), ('NDCG@5', 0.9252486824989319), ('NDCG@10', 0.8936250805854797), ('NDCG@20', 0.7935351133346558)])
1 stage (test) OrderedDict([('Precision@1', 0.9197391271591187), ('Precision@5', 0.9264116287231445), ('Precision@10', 0.8730055093765259), ('Recall@1', 0.0034180800430476665), ('Recall@5', 0.02452448010444641), ('Recall@10', 0.04040439799427986), ('NDCG@5', 0.9255384802818298), ('NDCG@10', 0.8901402950286865), ('NDCG@20', 0.7891217470169067)])
2 stage (test) OrderedDict([('Precision@1', 0.9739152193069458), ('Precision@5', 0.9596194624900818), ('Precision@10', 0.9265311360359192), ('Recall@1', 0.007858017459511757), ('Recall@5', 0.03383801877498627), ('Recall@10', 0.051749277859926224), ('NDCG@5', 0.9642794132232666), ('NDCG@10', 0.9424636960029602), ('NDCG@20', 0.8509746193885803)])

 ---epoch 4---
1 stage 0.871854305267334
2 stage 0.943874180316925
1 stage (val) OrderedDict([('Precision@1', 0.8291925191879272), ('Precision@5', 0.8445125222206116), ('Precision@10', 0.77577805519104), ('Recall@1', 0.0035469415597617626), ('Recall@5', 0.03286739066243172), ('Recall@10', 0.05468452349305153), ('NDCG@5', 0.8436872959136963), ('NDCG@10', 0.7966625094413757), ('NDCG@20', 0.7110303044319153)])
2 stage (val) OrderedDict([('Precision@1', 0.9409937858581543), ('Precision@5', 0.914907693862915), ('Precision@10', 0.8615439534187317), ('Recall@1', 0.014932735823094845), ('Recall@5', 0.05287071689963341), ('Recall@10', 0.07229438424110413), ('NDCG@5', 0.925213634967804), ('NDCG@10', 0.8914133906364441), ('NDCG@20', 0.7903339862823486)])
1 stage (test) OrderedDict([('Precision@1', 0.9189866781234741), ('Precision@5', 0.9278162121772766), ('Precision@10', 0.8754640817642212), ('Recall@1', 0.0034107810351997614), ('Recall@5', 0.024635957553982735), ('Recall@10', 0.042894214391708374), ('NDCG@5', 0.9267644286155701), ('NDCG@10', 0.8917465806007385), ('NDCG@20', 0.7922101020812988)])
2 stage (test) OrderedDict([('Precision@1', 0.9739152193069458), ('Precision@5', 0.959619402885437), ('Precision@10', 0.9259538054466248), ('Recall@1', 0.007858017459511757), ('Recall@5', 0.03384460508823395), ('Recall@10', 0.05136534199118614), ('NDCG@5', 0.9641972184181213), ('NDCG@10', 0.9420285224914551), ('NDCG@20', 0.8499817252159119)])

 ---epoch 5---
1 stage 0.8715232014656067
2 stage 0.9442052841186523
1 stage (val) OrderedDict([('Precision@1', 0.828157365322113), ('Precision@5', 0.8440985679626465), ('Precision@10', 0.7751054167747498), ('Recall@1', 0.0035600538831204176), ('Recall@5', 0.03293487802147865), ('Recall@10', 0.05498601496219635), ('NDCG@5', 0.8435922861099243), ('NDCG@10', 0.7962989807128906), ('NDCG@20', 0.7122547030448914)])
2 stage (val) OrderedDict([('Precision@1', 0.9420289993286133), ('Precision@5', 0.9152182340621948), ('Precision@10', 0.8588525652885437), ('Recall@1', 0.014970477670431137), ('Recall@5', 0.05290345475077629), ('Recall@10', 0.07179859280586243), ('NDCG@5', 0.9254247546195984), ('NDCG@10', 0.8896178603172302), ('NDCG@20', 0.789766252040863)])
1 stage (test) OrderedDict([('Precision@1', 0.9189866781234741), ('Precision@5', 0.929371178150177), ('Precision@10', 0.873407244682312), ('Recall@1', 0.0034213666804134846), ('Recall@5', 0.02445461042225361), ('Recall@10', 0.043027978390455246), ('NDCG@5', 0.9281464219093323), ('NDCG@10', 0.8906310200691223), ('NDCG@20', 0.7925272583961487)])
2 stage (test) OrderedDict([('Precision@1', 0.9739152193069458), ('Precision@5', 0.9595691561698914), ('Precision@10', 0.9251015186309814), ('Recall@1', 0.007858017459511757), ('Recall@5', 0.03378944844007492), ('Recall@10', 0.05123606324195862), ('NDCG@5', 0.9642377495765686), ('NDCG@10', 0.9415031671524048), ('NDCG@20', 0.8496964573860168)])

 ---epoch 6---
1 stage 0.8711920380592346
2 stage 0.9440397620201111
1 stage (val) OrderedDict([('Precision@1', 0.8286749720573425), ('Precision@5', 0.8456515669822693), ('Precision@10', 0.7802817821502686), ('Recall@1', 0.003579061245545745), ('Recall@5', 0.03249823674559593), ('Recall@10', 0.05669151619076729), ('NDCG@5', 0.8449612855911255), ('NDCG@10', 0.8000505566596985), ('NDCG@20', 0.7129603624343872)])
2 stage (val) OrderedDict([('Precision@1', 0.9415113925933838), ('Precision@5', 0.9159427881240845), ('Precision@10', 0.8606643080711365), ('Recall@1', 0.014797944575548172), ('Recall@5', 0.05294150114059448), ('Recall@10', 0.07188677042722702), ('NDCG@5', 0.9257479906082153), ('NDCG@10', 0.8907122015953064), ('NDCG@20', 0.7934211492538452)])
1 stage (test) OrderedDict([('Precision@1', 0.9182342886924744), ('Precision@5', 0.9304243326187134), ('Precision@10', 0.8760902285575867), ('Recall@1', 0.003392111510038376), ('Recall@5', 0.0243728905916214), ('Recall@10', 0.04407436400651932), ('NDCG@5', 0.9288574457168579), ('NDCG@10', 0.8924244046211243), ('NDCG@20', 0.7893427610397339)])
2 stage (test) OrderedDict([('Precision@1', 0.9739152193069458), ('Precision@5', 0.960070788860321), ('Precision@10', 0.9260292649269104), ('Recall@1', 0.007858017459511757), ('Recall@5', 0.03384515270590782), ('Recall@10', 0.05133317410945892), ('NDCG@5', 0.9645946621894836), ('NDCG@10', 0.9422363638877869), ('NDCG@20', 0.8519969582557678)])

 ---epoch 7---
1 stage 0.8710265159606934
2 stage 0.9443708658218384
1 stage (val) OrderedDict([('Precision@1', 0.8297101259231567), ('Precision@5', 0.8514488935470581), ('Precision@10', 0.7854577898979187), ('Recall@1', 0.0036012919154018164), ('Recall@5', 0.03555092588067055), ('Recall@10', 0.05728212743997574), ('NDCG@5', 0.8481239080429077), ('NDCG@10', 0.8049586415290833), ('NDCG@20', 0.7177723050117493)])
2 stage (val) OrderedDict([('Precision@1', 0.9425466060638428), ('Precision@5', 0.916149914264679), ('Precision@10', 0.8632526397705078), ('Recall@1', 0.01483029406517744), ('Recall@5', 0.05296662822365761), ('Recall@10', 0.07216054201126099), ('NDCG@5', 0.9260120987892151), ('NDCG@10', 0.8925718665122986), ('NDCG@20', 0.7971721291542053)])
1 stage (test) OrderedDict([('Precision@1', 0.9174818396568298), ('Precision@5', 0.9323304891586304), ('Precision@10', 0.8780455589294434), ('Recall@1', 0.0033601459581404924), ('Recall@5', 0.02541440539062023), ('Recall@10', 0.044133510440588), ('NDCG@5', 0.9298123121261597), ('NDCG@10', 0.8942909240722656), ('NDCG@20', 0.790717601776123)])
2 stage (test) OrderedDict([('Precision@1', 0.9739152193069458), ('Precision@5', 0.960572361946106), ('Precision@10', 0.9268561005592346), ('Recall@1', 0.007858017459511757), ('Recall@5', 0.03389439359307289), ('Recall@10', 0.05133416876196861), ('NDCG@5', 0.9649993181228638), ('NDCG@10', 0.9429105520248413), ('NDCG@20', 0.8533531427383423)])

 ---epoch 8---
1 stage 0.87052983045578
2 stage 0.9443708658218384
1 stage (val) OrderedDict([('Precision@1', 0.8291925191879272), ('Precision@5', 0.8628373146057129), ('Precision@10', 0.7907371520996094), ('Recall@1', 0.003596167080104351), ('Recall@5', 0.039720479398965836), ('Recall@10', 0.05748104676604271), ('NDCG@5', 0.8561263680458069), ('NDCG@10', 0.8106748461723328), ('NDCG@20', 0.722335696220398)])
2 stage (val) OrderedDict([('Precision@1', 0.9425466060638428), ('Precision@5', 0.9172885417938232), ('Precision@10', 0.8649604320526123), ('Recall@1', 0.01483029406517744), ('Recall@5', 0.05299568176269531), ('Recall@10', 0.07213201373815536), ('NDCG@5', 0.9268448352813721), ('NDCG@10', 0.8938650488853455), ('NDCG@20', 0.7998582124710083)])
1 stage (test) OrderedDict([('Precision@1', 0.9169802069664001), ('Precision@5', 0.9375976920127869), ('Precision@10', 0.8808299899101257), ('Recall@1', 0.0033486471511423588), ('Recall@5', 0.027368180453777313), ('Recall@10', 0.04409157484769821), ('NDCG@5', 0.9333572387695312), ('NDCG@10', 0.8973307609558105), ('NDCG@20', 0.7939802408218384)])
2 stage (test) OrderedDict([('Precision@1', 0.9739152193069458), ('Precision@5', 0.9613246917724609), ('Precision@10', 0.9292142987251282), ('Recall@1', 0.007858017459511757), ('Recall@5', 0.03391904756426811), ('Recall@10', 0.051458753645420074), ('NDCG@5', 0.9654447436332703), ('NDCG@10', 0.9445306658744812), ('NDCG@20', 0.8544122576713562)])

 ---epoch 9---
1 stage 0.8713576197624207
2 stage 0.9443708658218384
1 stage (val) OrderedDict([('Precision@1', 0.8307453393936157), ('Precision@5', 0.865321695804596), ('Precision@10', 0.792497456073761), ('Recall@1', 0.003700616303831339), ('Recall@5', 0.0393974669277668), ('Recall@10', 0.057807497680187225), ('NDCG@5', 0.8602885007858276), ('NDCG@10', 0.8141997456550598), ('NDCG@20', 0.7221478819847107)])
2 stage (val) OrderedDict([('Precision@1', 0.9430641531944275), ('Precision@5', 0.9181166887283325), ('Precision@10', 0.8678065538406372), ('Recall@1', 0.01500282809138298), ('Recall@5', 0.05298842117190361), ('Recall@10', 0.0718461275100708), ('NDCG@5', 0.9277399778366089), ('NDCG@10', 0.8964902758598328), ('NDCG@20', 0.7953608632087708)])
1 stage (test) OrderedDict([('Precision@1', 0.9174818396568298), ('Precision@5', 0.9374470710754395), ('Precision@10', 0.8820593357086182), ('Recall@1', 0.003359477501362562), ('Recall@5', 0.02692492865025997), ('Recall@10', 0.04415930435061455), ('NDCG@5', 0.9342272877693176), ('NDCG@10', 0.8988990783691406), ('NDCG@20', 0.7906973958015442)])
2 stage (test) OrderedDict([('Precision@1', 0.973664402961731), ('Precision@5', 0.9625282883644104), ('Precision@10', 0.9332548975944519), ('Recall@1', 0.007816214114427567), ('Recall@5', 0.03372284024953842), ('Recall@10', 0.05132255703210831), ('NDCG@5', 0.966265082359314), ('NDCG@10', 0.9475633502006531), ('NDCG@20', 0.846182644367218)])

 ---epoch 10---
1 stage 0.8715232014656067
2 stage 0.9443708658218384
1 stage (val) OrderedDict([('Precision@1', 0.8328157067298889), ('Precision@5', 0.8649077415466309), ('Precision@10', 0.7945675253868103), ('Recall@1', 0.003785414155572653), ('Recall@5', 0.038480695337057114), ('Recall@10', 0.05809003859758377), ('NDCG@5', 0.8613322377204895), ('NDCG@10', 0.8164018392562866), ('NDCG@20', 0.7221307754516602)])
2 stage (val) OrderedDict([('Precision@1', 0.9430641531944275), ('Precision@5', 0.9184269905090332), ('Precision@10', 0.8685827851295471), ('Recall@1', 0.01500282809138298), ('Recall@5', 0.05311937630176544), ('Recall@10', 0.07168952375650406), ('NDCG@5', 0.9280794858932495), ('NDCG@10', 0.8972344994544983), ('NDCG@20', 0.7971600294113159)])
1 stage (test) OrderedDict([('Precision@1', 0.9167293906211853), ('Precision@5', 0.9363434314727783), ('Precision@10', 0.8855713605880737), ('Recall@1', 0.003344816155731678), ('Recall@5', 0.02658488228917122), ('Recall@10', 0.04434677213430405), ('NDCG@5', 0.9335623979568481), ('NDCG@10', 0.9010850787162781), ('NDCG@20', 0.7878006100654602)])
2 stage (test) OrderedDict([('Precision@1', 0.973664402961731), ('Precision@5', 0.9630299210548401), ('Precision@10', 0.9340076446533203), ('Recall@1', 0.007816214114427567), ('Recall@5', 0.03367449343204498), ('Recall@10', 0.05126086622476578), ('NDCG@5', 0.9666032791137695), ('NDCG@10', 0.948119580745697), ('NDCG@20', 0.8466151356697083)])

 ---epoch 11---
1 stage 0.8716887831687927
2 stage 0.9445364475250244
1 stage (val) OrderedDict([('Precision@1', 0.8328157067298889), ('Precision@5', 0.8650111556053162), ('Precision@10', 0.7960682511329651), ('Recall@1', 0.0037994070444256067), ('Recall@5', 0.03818630799651146), ('Recall@10', 0.05843367055058479), ('NDCG@5', 0.8614438772201538), ('NDCG@10', 0.8172826170921326), ('NDCG@20', 0.7265201807022095)])
2 stage (val) OrderedDict([('Precision@1', 0.943581759929657), ('Precision@5', 0.9192551374435425), ('Precision@10', 0.8702907562255859), ('Recall@1', 0.015014591626822948), ('Recall@5', 0.05309101194143295), ('Recall@10', 0.07169770449399948), ('NDCG@5', 0.9286661148071289), ('NDCG@10', 0.8985097408294678), ('NDCG@20', 0.8005960583686829)])
1 stage (test) OrderedDict([('Precision@1', 0.9169802069664001), ('Precision@5', 0.9357415437698364), ('Precision@10', 0.8876538276672363), ('Recall@1', 0.0033544662874192), ('Recall@5', 0.025780821219086647), ('Recall@10', 0.044435515999794006), ('NDCG@5', 0.9333763122558594), ('NDCG@10', 0.9025286436080933), ('NDCG@20', 0.7911216616630554)])
2 stage (test) OrderedDict([('Precision@1', 0.973664402961731), ('Precision@5', 0.9631302952766418), ('Precision@10', 0.9348605871200562), ('Recall@1', 0.007816214114427567), ('Recall@5', 0.03368328884243965), ('Recall@10', 0.051325052976608276), ('NDCG@5', 0.9667436480522156), ('NDCG@10', 0.9488219618797302), ('NDCG@20', 0.8495675325393677)])

 ---epoch 12---
1 stage 0.872185468673706
2 stage 0.9445364475250244
1 stage (val) OrderedDict([('Precision@1', 0.8343685269355774), ('Precision@5', 0.8655286431312561), ('Precision@10', 0.7967411875724792), ('Recall@1', 0.003823715727776289), ('Recall@5', 0.037585459649562836), ('Recall@10', 0.05842055007815361), ('NDCG@5', 0.8622679114341736), ('NDCG@10', 0.8181396722793579), ('NDCG@20', 0.726946234703064)])
2 stage (val) OrderedDict([('Precision@1', 0.943581759929657), ('Precision@5', 0.919255256652832), ('Precision@10', 0.8715327382087708), ('Recall@1', 0.015014591626822948), ('Recall@5', 0.05310264229774475), ('Recall@10', 0.07185567170381546), ('NDCG@5', 0.9287427663803101), ('NDCG@10', 0.8994393944740295), ('NDCG@20', 0.8032458424568176)])
1 stage (test) OrderedDict([('Precision@1', 0.9169802069664001), ('Precision@5', 0.9359421730041504), ('Precision@10', 0.8880051374435425), ('Recall@1', 0.0033544662874192), ('Recall@5', 0.025745244696736336), ('Recall@10', 0.04438469186425209), ('NDCG@5', 0.9336979985237122), ('NDCG@10', 0.9029626846313477), ('NDCG@20', 0.7939386367797852)])
2 stage (test) OrderedDict([('Precision@1', 0.973664402961731), ('Precision@5', 0.9630801677703857), ('Precision@10', 0.9353371858596802), ('Recall@1', 0.007816214114427567), ('Recall@5', 0.0336674265563488), ('Recall@10', 0.051419779658317566), ('NDCG@5', 0.9667789340019226), ('NDCG@10', 0.9491879343986511), ('NDCG@20', 0.8521312475204468)])

 ---epoch 13---
1 stage 0.873675525188446
2 stage 0.9447020292282104
1 stage (val) OrderedDict([('Precision@1', 0.8359213471412659), ('Precision@5', 0.8670814633369446), ('Precision@10', 0.7974141240119934), ('Recall@1', 0.0038942007813602686), ('Recall@5', 0.037541553378105164), ('Recall@10', 0.05836675688624382), ('NDCG@5', 0.8633794784545898), ('NDCG@10', 0.8187873959541321), ('NDCG@20', 0.7323683500289917)])
2 stage (val) OrderedDict([('Precision@1', 0.943581759929657), ('Precision@5', 0.9190481901168823), ('Precision@10', 0.8714290261268616), ('Recall@1', 0.015014591626822948), ('Recall@5', 0.0530092716217041), ('Recall@10', 0.07166443020105362), ('NDCG@5', 0.9286344647407532), ('NDCG@10', 0.8993586897850037), ('NDCG@20', 0.80428546667099)])
1 stage (test) OrderedDict([('Precision@1', 0.9184851050376892), ('Precision@5', 0.9364939332008362), ('Precision@10', 0.8877039551734924), ('Recall@1', 0.003477392951026559), ('Recall@5', 0.025551820173859596), ('Recall@10', 0.04431741684675217), ('NDCG@5', 0.9343084096908569), ('NDCG@10', 0.9029132723808289), ('NDCG@20', 0.7982853651046753)])
2 stage (test) OrderedDict([('Precision@1', 0.9739152193069458), ('Precision@5', 0.9631302952766418), ('Precision@10', 0.935888946056366), ('Recall@1', 0.007823591120541096), ('Recall@5', 0.03369123861193657), ('Recall@10', 0.051465846598148346), ('NDCG@5', 0.9668166041374207), ('NDCG@10', 0.9495801329612732), ('NDCG@20', 0.8524214029312134)])

 ---epoch 14---
1 stage 0.8743377923965454
2 stage 0.9448675513267517
1 stage (val) OrderedDict([('Precision@1', 0.8374741077423096), ('Precision@5', 0.8677027225494385), ('Precision@10', 0.7978280782699585), ('Recall@1', 0.003873931709676981), ('Recall@5', 0.03667106106877327), ('Recall@10', 0.05825410783290863), ('NDCG@5', 0.864425778388977), ('NDCG@10', 0.8193790316581726), ('NDCG@20', 0.7328730821609497)])
2 stage (val) OrderedDict([('Precision@1', 0.943581759929657), ('Precision@5', 0.9192551374435425), ('Precision@10', 0.8715845942497253), ('Recall@1', 0.015014591626822948), ('Recall@5', 0.05313529074192047), ('Recall@10', 0.07173865288496017), ('NDCG@5', 0.9287505745887756), ('NDCG@10', 0.899377167224884), ('NDCG@20', 0.8064449429512024)])
1 stage (test) OrderedDict([('Precision@1', 0.918735921382904), ('Precision@5', 0.9366443753242493), ('Precision@10', 0.8875784277915955), ('Recall@1', 0.00348133803345263), ('Recall@5', 0.02504768967628479), ('Recall@10', 0.044314686208963394), ('NDCG@5', 0.9345718026161194), ('NDCG@10', 0.9027630090713501), ('NDCG@20', 0.7993535995483398)])
2 stage (test) OrderedDict([('Precision@1', 0.9741660356521606), ('Precision@5', 0.963180422782898), ('Precision@10', 0.9356882572174072), ('Recall@1', 0.007828607223927975), ('Recall@5', 0.03371934965252876), ('Recall@10', 0.051444873213768005), ('NDCG@5', 0.9669326543807983), ('NDCG@10', 0.9495087265968323), ('NDCG@20', 0.8542296290397644)])

 ---epoch 15---
1 stage 0.875
2 stage 0.9451987147331238
1 stage (val) OrderedDict([('Precision@1', 0.839026927947998), ('Precision@5', 0.8621119856834412), ('Precision@10', 0.7976210713386536), ('Recall@1', 0.003954415675252676), ('Recall@5', 0.03144076094031334), ('Recall@10', 0.05820336565375328), ('NDCG@5', 0.86229407787323), ('NDCG@10', 0.8189553022384644), ('NDCG@20', 0.7320632338523865)])
2 stage (val) OrderedDict([('Precision@1', 0.9440993666648865), ('Precision@5', 0.9179095029830933), ('Precision@10', 0.8713255524635315), ('Recall@1', 0.015030765905976295), ('Recall@5', 0.05264124274253845), ('Recall@10', 0.07145236432552338), ('NDCG@5', 0.9279696941375732), ('NDCG@10', 0.8991669416427612), ('NDCG@20', 0.8046199083328247)])
1 stage (test) OrderedDict([('Precision@1', 0.9189866781234741), ('Precision@5', 0.9343367218971252), ('Precision@10', 0.886650800704956), ('Recall@1', 0.0034877443686127663), ('Recall@5', 0.023578980937600136), ('Recall@10', 0.04410114884376526), ('NDCG@5', 0.9334456324577332), ('NDCG@10', 0.901811957359314), ('NDCG@20', 0.796948254108429)])
2 stage (test) OrderedDict([('Precision@1', 0.9744168519973755), ('Precision@5', 0.9631805419921875), ('Precision@10', 0.9350861310958862), ('Recall@1', 0.007846523076295853), ('Recall@5', 0.033945683389902115), ('Recall@10', 0.051433347165584564), ('NDCG@5', 0.9670196771621704), ('NDCG@10', 0.9492480158805847), ('NDCG@20', 0.8503140211105347)])

 ---epoch 16---
1 stage 0.8746688961982727
2 stage 0.9448675513267517
1 stage (val) OrderedDict([('Precision@1', 0.840062141418457), ('Precision@5', 0.8586959838867188), ('Precision@10', 0.7927557229995728), ('Recall@1', 0.00391168100759387), ('Recall@5', 0.030842551961541176), ('Recall@10', 0.05768047645688057), ('NDCG@5', 0.857774555683136), ('NDCG@10', 0.8133404850959778), ('NDCG@20', 0.7163088321685791)])
2 stage (val) OrderedDict([('Precision@1', 0.943581759929657), ('Precision@5', 0.9145970344543457), ('Precision@10', 0.8674951195716858), ('Recall@1', 0.015014591626822948), ('Recall@5', 0.05109909549355507), ('Recall@10', 0.06977085024118423), ('NDCG@5', 0.9253076910972595), ('NDCG@10', 0.8957194685935974), ('NDCG@20', 0.7942360639572144)])
1 stage (test) OrderedDict([('Precision@1', 0.9179834723472595), ('Precision@5', 0.9315779805183411), ('Precision@10', 0.8800285458564758), ('Recall@1', 0.0033887557219713926), ('Recall@5', 0.023249421268701553), ('Recall@10', 0.04385620728135109), ('NDCG@5', 0.9302358031272888), ('NDCG@10', 0.8959716558456421), ('NDCG@20', 0.7765030264854431)])
2 stage (test) OrderedDict([('Precision@1', 0.9741660356521606), ('Precision@5', 0.9618262052536011), ('Precision@10', 0.931850254535675), ('Recall@1', 0.007841506041586399), ('Recall@5', 0.03320588171482086), ('Recall@10', 0.05045972391963005), ('NDCG@5', 0.9660043716430664), ('NDCG@10', 0.9467595815658569), ('NDCG@20', 0.8368167877197266)])

 ---epoch 17---
1 stage 0.87649005651474
2 stage 0.9448675513267517
1 stage (val) OrderedDict([('Precision@1', 0.8436853289604187), ('Precision@5', 0.8591099381446838), ('Precision@10', 0.7869071364402771), ('Recall@1', 0.0039990185759961605), ('Recall@5', 0.030867619439959526), ('Recall@10', 0.057398393750190735), ('NDCG@5', 0.8583289384841919), ('NDCG@10', 0.8095158338546753), ('NDCG@20', 0.7068324685096741)])
2 stage (val) OrderedDict([('Precision@1', 0.943581759929657), ('Precision@5', 0.9143900275230408), ('Precision@10', 0.8670809268951416), ('Recall@1', 0.015014591626822948), ('Recall@5', 0.050812140107154846), ('Recall@10', 0.0695224329829216), ('NDCG@5', 0.9251974821090698), ('NDCG@10', 0.8953093886375427), ('NDCG@20', 0.791334331035614)])
1 stage (test) OrderedDict([('Precision@1', 0.9189866781234741), ('Precision@5', 0.9319291114807129), ('Precision@10', 0.8714011907577515), ('Recall@1', 0.0034084501676261425), ('Recall@5', 0.023317061364650726), ('Recall@10', 0.04327181726694107), ('NDCG@5', 0.9305843710899353), ('NDCG@10', 0.8901927471160889), ('NDCG@20', 0.7652526497840881)])
2 stage (test) OrderedDict([('Precision@1', 0.9741660356521606), ('Precision@5', 0.961374819278717), ('Precision@10', 0.9308974742889404), ('Recall@1', 0.007841506041586399), ('Recall@5', 0.03302949294447899), ('Recall@10', 0.050273146480321884), ('NDCG@5', 0.9657419919967651), ('NDCG@10', 0.9460641145706177), ('NDCG@20', 0.8330366015434265)])

 ---epoch 18---
1 stage 0.8769867420196533
2 stage 0.9448675513267517
1 stage (val) OrderedDict([('Precision@1', 0.8442028760910034), ('Precision@5', 0.8597308993339539), ('Precision@10', 0.7818864583969116), ('Recall@1', 0.0041385795921087265), ('Recall@5', 0.030936533585190773), ('Recall@10', 0.056731704622507095), ('NDCG@5', 0.8588704466819763), ('NDCG@10', 0.8062609434127808), ('NDCG@20', 0.7035788297653198)])
2 stage (val) OrderedDict([('Precision@1', 0.943581759929657), ('Precision@5', 0.9142864942550659), ('Precision@10', 0.8658906817436218), ('Recall@1', 0.015014591626822948), ('Recall@5', 0.050981584936380386), ('Recall@10', 0.06925816088914871), ('NDCG@5', 0.9250206351280212), ('NDCG@10', 0.8944141268730164), ('NDCG@20', 0.7902264595031738)])
1 stage (test) OrderedDict([('Precision@1', 0.9194883108139038), ('Precision@5', 0.9319792985916138), ('Precision@10', 0.8661093711853027), ('Recall@1', 0.003418426727876067), ('Recall@5', 0.023334238678216934), ('Recall@10', 0.042945496737957), ('NDCG@5', 0.9306420683860779), ('NDCG@10', 0.8865886330604553), ('NDCG@20', 0.7602352499961853)])
2 stage (test) OrderedDict([('Precision@1', 0.9741660356521606), ('Precision@5', 0.9603214263916016), ('Precision@10', 0.9288903474807739), ('Recall@1', 0.007841506041586399), ('Recall@5', 0.03269359469413757), ('Recall@10', 0.04984758794307709), ('NDCG@5', 0.9649168848991394), ('NDCG@10', 0.9444789886474609), ('NDCG@20', 0.8307515382766724)])

 ---epoch 19---
1 stage 0.8768212199211121
2 stage 0.9448675513267517
1 stage (val) OrderedDict([('Precision@1', 0.8442028760910034), ('Precision@5', 0.8590062260627747), ('Precision@10', 0.7816277146339417), ('Recall@1', 0.004117700736969709), ('Recall@5', 0.030927948653697968), ('Recall@10', 0.05665162578225136), ('NDCG@5', 0.8586164116859436), ('NDCG@10', 0.8061487078666687), ('NDCG@20', 0.7013629674911499)])
2 stage (val) OrderedDict([('Precision@1', 0.943581759929657), ('Precision@5', 0.9134584665298462), ('Precision@10', 0.8652697205543518), ('Recall@1', 0.015014591626822948), ('Recall@5', 0.050237275660037994), ('Recall@10', 0.06875021755695343), ('NDCG@5', 0.9243248701095581), ('NDCG@10', 0.8936079740524292), ('NDCG@20', 0.7890340089797974)])
1 stage (test) OrderedDict([('Precision@1', 0.919237494468689), ('Precision@5', 0.9320796132087708), ('Precision@10', 0.8633516430854797), ('Recall@1', 0.0034406548365950584), ('Recall@5', 0.023358946666121483), ('Recall@10', 0.0427171066403389), ('NDCG@5', 0.9306590557098389), ('NDCG@10', 0.8847069144248962), ('NDCG@20', 0.7577565312385559)])
2 stage (test) OrderedDict([('Precision@1', 0.9741660356521606), ('Precision@5', 0.9601708650588989), ('Precision@10', 0.9280124306678772), ('Recall@1', 0.007841506041586399), ('Recall@5', 0.03252454102039337), ('Recall@10', 0.049656614661216736), ('NDCG@5', 0.964770495891571), ('NDCG@10', 0.9437631964683533), ('NDCG@20', 0.8294360041618347)])
------------------------------------------------------------
Best validation epoch: 14
Best validation stage results
 1 stage: OrderedDict([('Precision@1', 0.8374741077423096), ('Precision@5', 0.8677027225494385), ('Precision@10', 0.7978280782699585), ('Recall@1', 0.003873931709676981), ('Recall@5', 0.03667106106877327), ('Recall@10', 0.05825410783290863), ('NDCG@5', 0.864425778388977), ('NDCG@10', 0.8193790316581726), ('NDCG@20', 0.7328730821609497)])
 2 stage: OrderedDict([('Precision@1', 0.943581759929657), ('Precision@5', 0.9192551374435425), ('Precision@10', 0.8715845942497253), ('Recall@1', 0.015014591626822948), ('Recall@5', 0.05313529074192047), ('Recall@10', 0.07173865288496017), ('NDCG@5', 0.9287505745887756), ('NDCG@10', 0.899377167224884), ('NDCG@20', 0.8064449429512024)])
Best test results
 1 stage: OrderedDict([('Precision@1', 0.918735921382904), ('Precision@5', 0.9366443753242493), ('Precision@10', 0.8875784277915955), ('Recall@1', 0.00348133803345263), ('Recall@5', 0.02504768967628479), ('Recall@10', 0.044314686208963394), ('NDCG@5', 0.9345718026161194), ('NDCG@10', 0.9027630090713501), ('NDCG@20', 0.7993535995483398)])
 2 stage: OrderedDict([('Precision@1', 0.9741660356521606), ('Precision@5', 0.963180422782898), ('Precision@10', 0.9356882572174072), ('Recall@1', 0.007828607223927975), ('Recall@5', 0.03371934965252876), ('Recall@10', 0.051444873213768005), ('NDCG@5', 0.9669326543807983), ('NDCG@10', 0.9495087265968323), ('NDCG@20', 0.8542296290397644)])
