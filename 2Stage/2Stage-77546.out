Fri Dec  3 13:31:07 2021       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 470.42.01    Driver Version: 470.42.01    CUDA Version: 11.4     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla V100-PCIE...  Off  | 00000000:AF:00.0 Off |                    0 |
| N/A   42C    P0    36W / 250W |      0MiB / 32510MiB |      2%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
--------------------------------------------------
TRAIN A SIMULATOR FROM MOVIELENS DATASET 

---epoch 0---
499 0.6932387556154579
999 0.7135011059385418
1499 0.7213769992512226
1999 0.7249889432254533
2499 0.7250345369844968
2999 0.7274164181709146
3499 0.7281983857417016
3999 0.7295506285509783
4499 0.7297455669806975
---epoch 1---
499 0.7283884923316021
999 0.7295873272513004
1499 0.7301497283955178
1999 0.7303284938618003
2499 0.7308553369350682
2999 0.7305033233993108
3499 0.7300444552891298
3999 0.7313431641599593
4499 0.7318222576755193
---epoch 2---
499 0.7314519585871704
999 0.7312422371168377
1499 0.731001755864461
1999 0.7322897300698424
2499 0.7323549295590692
2999 0.7321547432582102
3499 0.7331849290235803
3999 0.7327284454682886
4499 0.7333661983029975
---epoch 3---
499 0.7324884535508949
999 0.7323003492388144
1499 0.7327557311041264
1999 0.7329239716490018
2499 0.7318670875921103
2999 0.7335081977637932
3499 0.7344791198064623
3999 0.734241935592139
4499 0.7340704604342424
generating impression_feats
saved impression_feats
--------------------------------------------------
TRAIN A LOGGING POLICY 

---epoch 0---
78 0.7338524033029742
---epoch 1---
78 0.7608217379611688
---epoch 2---
78 0.7801706937630282
---epoch 3---
78 0.7980453506488202
---epoch 4---
78 0.8120240986550037
---epoch 5---
78 0.8241533301132196
---epoch 6---
78 0.830776375208554
---epoch 7---
78 0.835263762487239
---epoch 8---
78 0.8388195358270428
---epoch 9---
78 0.8409108445838736
---epoch 10---
78 0.8422468009103566
---epoch 11---
78 0.8428123696241658
---epoch 12---
78 0.8434530196887131
---epoch 13---
78 0.8432983180642704
---epoch 14---
78 0.8426433893045575
---epoch 15---
78 0.8430646580923891
---epoch 16---
78 0.8430290086349228
---epoch 17---
78 0.8427600774491555
---epoch 18---
78 0.8426490629582657
---epoch 19---
78 0.8422696846469795
---epoch 20---
78 0.842300511498794
---epoch 21---
78 0.8422743181308412
---epoch 22---
78 0.8421669915148617
---epoch 23---
78 0.8422119079400514
---epoch 24---
78 0.8422503942243719
---epoch 25---
78 0.8422798026627591
---epoch 26---
78 0.8420909645551722
---epoch 27---
78 0.8421455261916659
---epoch 28---
78 0.8421303018875489
---epoch 29---
78 0.8421242499902603
---epoch 30---
78 0.8421915773475972
---epoch 31---
78 0.8420207058100863
---epoch 32---
78 0.8422529473685405
---epoch 33---
78 0.8422482193237838
---epoch 34---
78 0.8423823066730867
---epoch 35---
78 0.8423633944940596
---epoch 36---
78 0.8424606976551546
---epoch 37---
78 0.8423812665032403
---epoch 38---
78 0.8422419783047047
---epoch 39---
78 0.8423780514328056
loaded full_impression_feats.pt
--------------------------------------------------
TRAIN A RANKING MODEL 

---epoch 0---
234 0.43145695328712463
234 OrderedDict([('Precision@1', 0.46066251397132874), ('Precision@5', 0.3108711242675781), ('Precision@10', 0.26470038294792175), ('Recall@1', 0.001715400954708457), ('Recall@5', 0.005121583119034767), ('Recall@10', 0.007823476567864418), ('NDCG@5', 0.34335950016975403), ('NDCG@10', 0.29934221506118774), ('NDCG@20', 0.26762863993644714)])
---epoch 1---
234 0.2940397262573242
234 OrderedDict([('Precision@1', 0.33747410774230957), ('Precision@5', 0.4348873794078827), ('Precision@10', 0.3757762014865875), ('Recall@1', 0.0012518998701125383), ('Recall@5', 0.012048608623445034), ('Recall@10', 0.01931745745241642), ('NDCG@5', 0.4225552976131439), ('NDCG@10', 0.38623949885368347), ('NDCG@20', 0.339391827583313)])
---epoch 2---
234 0.3692052960395813
234 OrderedDict([('Precision@1', 0.4063147008419037), ('Precision@5', 0.4995858371257782), ('Precision@10', 0.45993679761886597), ('Recall@1', 0.0019196252105757594), ('Recall@5', 0.018138039857149124), ('Recall@10', 0.03029865399003029), ('NDCG@5', 0.485514760017395), ('NDCG@10', 0.46413087844848633), ('NDCG@20', 0.3972618281841278)])
---epoch 3---
234 0.42500001192092896
234 OrderedDict([('Precision@1', 0.4611801207065582), ('Precision@5', 0.6063121557235718), ('Precision@10', 0.5505691170692444), ('Recall@1', 0.0039856694638729095), ('Recall@5', 0.023618612438440323), ('Recall@10', 0.03952493146061897), ('NDCG@5', 0.5834267735481262), ('NDCG@10', 0.5541077256202698), ('NDCG@20', 0.47984185814857483)])
---epoch 4---
234 0.5826159119606018
234 OrderedDict([('Precision@1', 0.6040372848510742), ('Precision@5', 0.6940985321998596), ('Precision@10', 0.6522787809371948), ('Recall@1', 0.0051864031702280045), ('Recall@5', 0.026984762400388718), ('Recall@10', 0.04611040651798248), ('NDCG@5', 0.6806671023368835), ('NDCG@10', 0.6579664945602417), ('NDCG@20', 0.5744660496711731)])
---epoch 5---
234 0.8084437251091003
234 OrderedDict([('Precision@1', 0.7800207138061523), ('Precision@5', 0.7740181088447571), ('Precision@10', 0.7184819579124451), ('Recall@1', 0.004794389475136995), ('Recall@5', 0.028909243643283844), ('Recall@10', 0.05002282187342644), ('NDCG@5', 0.7772438526153564), ('NDCG@10', 0.73863285779953), ('NDCG@20', 0.6561176776885986)])
---epoch 6---
234 0.8958609700202942
234 OrderedDict([('Precision@1', 0.8633540272712708), ('Precision@5', 0.8458606600761414), ('Precision@10', 0.7851489186286926), ('Recall@1', 0.0063436925411224365), ('Recall@5', 0.035246267914772034), ('Recall@10', 0.05866098403930664), ('NDCG@5', 0.8515275716781616), ('NDCG@10', 0.809196949005127), ('NDCG@20', 0.7243428826332092)])
---epoch 7---
234 0.9246689081192017
234 OrderedDict([('Precision@1', 0.909937858581543), ('Precision@5', 0.8795042634010315), ('Precision@10', 0.8346293568611145), ('Recall@1', 0.010423154570162296), ('Recall@5', 0.04152548685669899), ('Recall@10', 0.06775414198637009), ('NDCG@5', 0.8888917565345764), ('NDCG@10', 0.8576416969299316), ('NDCG@20', 0.779847264289856)])
---epoch 8---
234 0.9445364475250244
234 OrderedDict([('Precision@1', 0.9430641531944275), ('Precision@5', 0.9056946635246277), ('Precision@10', 0.8627854585647583), ('Recall@1', 0.013128543272614479), ('Recall@5', 0.04986891523003578), ('Recall@10', 0.07580656558275223), ('NDCG@5', 0.915285050868988), ('NDCG@10', 0.886572003364563), ('NDCG@20', 0.8237212300300598)])
---epoch 9---
234 0.9509934186935425
234 OrderedDict([('Precision@1', 0.9518633484840393), ('Precision@5', 0.9190481305122375), ('Precision@10', 0.8792968392372131), ('Recall@1', 0.014516452327370644), ('Recall@5', 0.05271698907017708), ('Recall@10', 0.07966701686382294), ('NDCG@5', 0.9296978116035461), ('NDCG@10', 0.9040801525115967), ('NDCG@20', 0.8507184982299805)])
-----------------------------------------------------
ALGORITHMS EVALUATION 
 with loss type: loss_ips

 ---epoch 0---
1 stage 0.8524834513664246
2 stage 0.9226821064949036
1 stage (val) OrderedDict([('Precision@1', 0.8059006333351135), ('Precision@5', 0.7285715341567993), ('Precision@10', 0.6945663690567017), ('Recall@1', 0.0033738818019628525), ('Recall@5', 0.012849566526710987), ('Recall@10', 0.022611645981669426), ('NDCG@5', 0.7493892312049866), ('NDCG@10', 0.718339741230011), ('NDCG@20', 0.6582445502281189)])
2 stage (val) OrderedDict([('Precision@1', 0.9089027047157288), ('Precision@5', 0.8488615155220032), ('Precision@10', 0.7869071960449219), ('Recall@1', 0.007492325734347105), ('Recall@5', 0.023258013650774956), ('Recall@10', 0.034837715327739716), ('NDCG@5', 0.8623825311660767), ('NDCG@10', 0.8156320452690125), ('NDCG@20', 0.7097929120063782)])
1 stage (test) OrderedDict([('Precision@1', 0.9009280204772949), ('Precision@5', 0.8199729919433594), ('Precision@10', 0.7780259251594543), ('Recall@1', 0.0031824486795812845), ('Recall@5', 0.013757237233221531), ('Recall@10', 0.02530842460691929), ('NDCG@5', 0.8417469263076782), ('NDCG@10', 0.8051412105560303), ('NDCG@20', 0.7202200889587402)])
2 stage (test) OrderedDict([('Precision@1', 0.9573614001274109), ('Precision@5', 0.9179859757423401), ('Precision@10', 0.8724558353424072), ('Recall@1', 0.005138430278748274), ('Recall@5', 0.019317010417580605), ('Recall@10', 0.032909318804740906), ('NDCG@5', 0.9274799227714539), ('NDCG@10', 0.8931178450584412), ('NDCG@20', 0.7715895771980286)])

 ---epoch 1---
1 stage 0.8523178696632385
2 stage 0.9201986789703369
1 stage (val) OrderedDict([('Precision@1', 0.8074533939361572), ('Precision@5', 0.740268886089325), ('Precision@10', 0.7178579568862915), ('Recall@1', 0.003377797780558467), ('Recall@5', 0.013479418121278286), ('Recall@10', 0.023438172414898872), ('NDCG@5', 0.7580297589302063), ('NDCG@10', 0.7362709641456604), ('NDCG@20', 0.6959933042526245)])
2 stage (val) OrderedDict([('Precision@1', 0.9042443037033081), ('Precision@5', 0.853830099105835), ('Precision@10', 0.8083863258361816), ('Recall@1', 0.007100386545062065), ('Recall@5', 0.023182127624750137), ('Recall@10', 0.036283936351537704), ('NDCG@5', 0.8650371432304382), ('NDCG@10', 0.8303576111793518), ('NDCG@20', 0.7567055225372314)])
1 stage (test) OrderedDict([('Precision@1', 0.8999247550964355), ('Precision@5', 0.833516538143158), ('Precision@10', 0.8143201470375061), ('Recall@1', 0.0031813522800803185), ('Recall@5', 0.014173907227814198), ('Recall@10', 0.026543082669377327), ('NDCG@5', 0.8515393137931824), ('NDCG@10', 0.8317602872848511), ('NDCG@20', 0.7784328460693359)])
2 stage (test) OrderedDict([('Precision@1', 0.9558565616607666), ('Precision@5', 0.9250077605247498), ('Precision@10', 0.8939763903617859), ('Recall@1', 0.004968787543475628), ('Recall@5', 0.019337745383381844), ('Recall@10', 0.03394860401749611), ('NDCG@5', 0.93238765001297), ('NDCG@10', 0.9084071516990662), ('NDCG@20', 0.835872232913971)])

 ---epoch 2---
1 stage 0.8523178696632385
2 stage 0.914238452911377
1 stage (val) OrderedDict([('Precision@1', 0.8090062141418457), ('Precision@5', 0.7711179256439209), ('Precision@10', 0.7261391282081604), ('Recall@1', 0.003396489890292287), ('Recall@5', 0.015023346059024334), ('Recall@10', 0.02389802783727646), ('NDCG@5', 0.782675564289093), ('NDCG@10', 0.747334897518158), ('NDCG@20', 0.7151355743408203)])
2 stage (val) OrderedDict([('Precision@1', 0.8949275612831116), ('Precision@5', 0.8567286133766174), ('Precision@10', 0.8154253959655762), ('Recall@1', 0.006594934035092592), ('Recall@5', 0.02299308218061924), ('Recall@10', 0.03672889247536659), ('NDCG@5', 0.8652084469795227), ('NDCG@10', 0.8344432711601257), ('NDCG@20', 0.7782101035118103)])
1 stage (test) OrderedDict([('Precision@1', 0.899172306060791), ('Precision@5', 0.8687783479690552), ('Precision@10', 0.8272854685783386), ('Recall@1', 0.003181388135999441), ('Recall@5', 0.015251808799803257), ('Recall@10', 0.027006568387150764), ('NDCG@5', 0.8787311315536499), ('NDCG@10', 0.846280574798584), ('NDCG@20', 0.8064084053039551)])
2 stage (test) OrderedDict([('Precision@1', 0.9513418674468994), ('Precision@5', 0.9283181428909302), ('Precision@10', 0.8988163471221924), ('Recall@1', 0.004735223483294249), ('Recall@5', 0.019243726506829262), ('Recall@10', 0.03420788049697876), ('NDCG@5', 0.9339382648468018), ('NDCG@10', 0.9116937518119812), ('NDCG@20', 0.864271342754364)])

 ---epoch 3---
1 stage 0.8551324605941772
2 stage 0.9104304909706116
1 stage (val) OrderedDict([('Precision@1', 0.8126294016838074), ('Precision@5', 0.7779499292373657), ('Precision@10', 0.7338512539863586), ('Recall@1', 0.0033686021342873573), ('Recall@5', 0.01513863354921341), ('Recall@10', 0.02453457936644554), ('NDCG@5', 0.7867214679718018), ('NDCG@10', 0.7529513239860535), ('NDCG@20', 0.7277429103851318)])
2 stage (val) OrderedDict([('Precision@1', 0.888198733329773), ('Precision@5', 0.8572463989257812), ('Precision@10', 0.8187380433082581), ('Recall@1', 0.006073897238820791), ('Recall@5', 0.02243436872959137), ('Recall@10', 0.03656478226184845), ('NDCG@5', 0.864194929599762), ('NDCG@10', 0.8359416723251343), ('NDCG@20', 0.7880752086639404)])
1 stage (test) OrderedDict([('Precision@1', 0.9016804695129395), ('Precision@5', 0.8805646300315857), ('Precision@10', 0.8358871340751648), ('Recall@1', 0.003201593179255724), ('Recall@5', 0.015480294823646545), ('Recall@10', 0.02752745896577835), ('NDCG@5', 0.8866994976997375), ('NDCG@10', 0.8532336354255676), ('NDCG@20', 0.825230598449707)])
2 stage (test) OrderedDict([('Precision@1', 0.948833703994751), ('Precision@5', 0.9304746389389038), ('Precision@10', 0.900822103023529), ('Recall@1', 0.004499442409723997), ('Recall@5', 0.01905914954841137), ('Recall@10', 0.03411457687616348), ('NDCG@5', 0.9347596168518066), ('NDCG@10', 0.9129462242126465), ('NDCG@20', 0.8783280849456787)])

 ---epoch 4---
1 stage 0.8413907289505005
2 stage 0.9052980542182922
1 stage (val) OrderedDict([('Precision@1', 0.7888198494911194), ('Precision@5', 0.7903726100921631), ('Precision@10', 0.7498452067375183), ('Recall@1', 0.002945383545011282), ('Recall@5', 0.015712754800915718), ('Recall@10', 0.026318395510315895), ('NDCG@5', 0.7896175384521484), ('NDCG@10', 0.7621515393257141), ('NDCG@20', 0.7297952771186829)])
2 stage (val) OrderedDict([('Precision@1', 0.8783643841743469), ('Precision@5', 0.8547619581222534), ('Precision@10', 0.8183240294456482), ('Recall@1', 0.005298440344631672), ('Recall@5', 0.021424230188131332), ('Recall@10', 0.0356605164706707), ('NDCG@5', 0.8599972128868103), ('NDCG@10', 0.833607017993927), ('NDCG@20', 0.7888606190681458)])
1 stage (test) OrderedDict([('Precision@1', 0.892400324344635), ('Precision@5', 0.8925023078918457), ('Precision@10', 0.8492045998573303), ('Recall@1', 0.003077918430790305), ('Recall@5', 0.01589050516486168), ('Recall@10', 0.028579508885741234), ('NDCG@5', 0.8925580978393555), ('NDCG@10', 0.862808108329773), ('NDCG@20', 0.8297770023345947)])
2 stage (test) OrderedDict([('Precision@1', 0.9458239078521729), ('Precision@5', 0.929722249507904), ('Precision@10', 0.9002196192741394), ('Recall@1', 0.0043699550442397594), ('Recall@5', 0.01892728917300701), ('Recall@10', 0.034039173275232315), ('NDCG@5', 0.9335896968841553), ('NDCG@10', 0.9120830297470093), ('NDCG@20', 0.8815329670906067)])

 ---epoch 5---
1 stage 0.8399006724357605
2 stage 0.9016556143760681
1 stage (val) OrderedDict([('Precision@1', 0.784679114818573), ('Precision@5', 0.7935816645622253), ('Precision@10', 0.7521226406097412), ('Recall@1', 0.002859697910025716), ('Recall@5', 0.015919549390673637), ('Recall@10', 0.026556117460131645), ('NDCG@5', 0.7915852069854736), ('NDCG@10', 0.7638789415359497), ('NDCG@20', 0.7303902506828308)])
2 stage (val) OrderedDict([('Precision@1', 0.8726708292961121), ('Precision@5', 0.8535197377204895), ('Precision@10', 0.8173408508300781), ('Recall@1', 0.0049555376172065735), ('Recall@5', 0.02096543461084366), ('Recall@10', 0.03509262204170227), ('NDCG@5', 0.857671320438385), ('NDCG@10', 0.831745982170105), ('NDCG@20', 0.787376344203949)])
1 stage (test) OrderedDict([('Precision@1', 0.8921495079994202), ('Precision@5', 0.8937063813209534), ('Precision@10', 0.851612389087677), ('Recall@1', 0.003065726952627301), ('Recall@5', 0.015988698229193687), ('Recall@10', 0.028743557631969452), ('NDCG@5', 0.8938055038452148), ('NDCG@10', 0.864892840385437), ('NDCG@20', 0.8305812478065491)])
2 stage (test) OrderedDict([('Precision@1', 0.9430649876594543), ('Precision@5', 0.9288694858551025), ('Precision@10', 0.9002949595451355), ('Recall@1', 0.004171710927039385), ('Recall@5', 0.018756309524178505), ('Recall@10', 0.03390856832265854), ('NDCG@5', 0.93243408203125), ('NDCG@10', 0.9116397500038147), ('NDCG@20', 0.8809553980827332)])

 ---epoch 6---
1 stage 0.8364238739013672
2 stage 0.9009934067726135
1 stage (val) OrderedDict([('Precision@1', 0.7774327397346497), ('Precision@5', 0.7921321392059326), ('Precision@10', 0.7531577348709106), ('Recall@1', 0.0026823971420526505), ('Recall@5', 0.015751715749502182), ('Recall@10', 0.026577265933156013), ('NDCG@5', 0.7894245982170105), ('NDCG@10', 0.7636283040046692), ('NDCG@20', 0.7287218570709229)])
2 stage (val) OrderedDict([('Precision@1', 0.8700827956199646), ('Precision@5', 0.8522773385047913), ('Precision@10', 0.8164607882499695), ('Recall@1', 0.004706846084445715), ('Recall@5', 0.02080991119146347), ('Recall@10', 0.0349370576441288), ('NDCG@5', 0.8564035892486572), ('NDCG@10', 0.8307410478591919), ('NDCG@20', 0.7849217057228088)])
1 stage (test) OrderedDict([('Precision@1', 0.8903937935829163), ('Precision@5', 0.8929539322853088), ('Precision@10', 0.8527154922485352), ('Recall@1', 0.0030356096103787422), ('Recall@5', 0.015921281650662422), ('Recall@10', 0.02880859561264515), ('NDCG@5', 0.8929928541183472), ('NDCG@10', 0.8653793334960938), ('NDCG@20', 0.8286440372467041)])
2 stage (test) OrderedDict([('Precision@1', 0.9433158040046692), ('Precision@5', 0.9282174110412598), ('Precision@10', 0.8986901044845581), ('Recall@1', 0.004175729583948851), ('Recall@5', 0.018715355545282364), ('Recall@10', 0.03379132226109505), ('NDCG@5', 0.9319992661476135), ('NDCG@10', 0.9105207920074463), ('NDCG@20', 0.8784573078155518)])

 ---epoch 7---
1 stage 0.8357616066932678
2 stage 0.9024834632873535
1 stage (val) OrderedDict([('Precision@1', 0.7763975262641907), ('Precision@5', 0.7902689576148987), ('Precision@10', 0.7525884509086609), ('Recall@1', 0.002668767934665084), ('Recall@5', 0.015492603182792664), ('Recall@10', 0.026521658524870872), ('NDCG@5', 0.7879995703697205), ('NDCG@10', 0.7629519701004028), ('NDCG@20', 0.7269257307052612)])
2 stage (val) OrderedDict([('Precision@1', 0.8742235898971558), ('Precision@5', 0.8523808121681213), ('Precision@10', 0.8155290484428406), ('Recall@1', 0.005449890159070492), ('Recall@5', 0.021519141271710396), ('Recall@10', 0.035540997982025146), ('NDCG@5', 0.857566773891449), ('NDCG@10', 0.831111490726471), ('NDCG@20', 0.783305823802948)])
1 stage (test) OrderedDict([('Precision@1', 0.8898921608924866), ('Precision@5', 0.8919004797935486), ('Precision@10', 0.8522894978523254), ('Recall@1', 0.003021828830242157), ('Recall@5', 0.01585036888718605), ('Recall@10', 0.028781626373529434), ('NDCG@5', 0.8921485543251038), ('NDCG@10', 0.8649379014968872), ('NDCG@20', 0.8258609771728516)])
2 stage (test) OrderedDict([('Precision@1', 0.943566620349884), ('Precision@5', 0.9276154041290283), ('Precision@10', 0.8964574933052063), ('Recall@1', 0.004318939987570047), ('Recall@5', 0.01881246082484722), ('Recall@10', 0.03382445126771927), ('NDCG@5', 0.9317699670791626), ('NDCG@10', 0.9091672897338867), ('NDCG@20', 0.8752578496932983)])

 ---epoch 8---
1 stage 0.8369205594062805
2 stage 0.9044702053070068
1 stage (val) OrderedDict([('Precision@1', 0.7753623127937317), ('Precision@5', 0.7872669696807861), ('Precision@10', 0.7517603635787964), ('Recall@1', 0.0026448846329003572), ('Recall@5', 0.015114248730242252), ('Recall@10', 0.026403173804283142), ('NDCG@5', 0.7859417796134949), ('NDCG@10', 0.762130618095398), ('NDCG@20', 0.7245774269104004)])
2 stage (val) OrderedDict([('Precision@1', 0.8762940168380737), ('Precision@5', 0.8530019521713257), ('Precision@10', 0.8143906593322754), ('Recall@1', 0.005667500197887421), ('Recall@5', 0.021753355860710144), ('Recall@10', 0.03565359115600586), ('NDCG@5', 0.8584415316581726), ('NDCG@10', 0.8307509422302246), ('NDCG@20', 0.7811580896377563)])
1 stage (test) OrderedDict([('Precision@1', 0.8921495079994202), ('Precision@5', 0.8898940086364746), ('Precision@10', 0.8523649573326111), ('Recall@1', 0.003031714353710413), ('Recall@5', 0.01569954864680767), ('Recall@10', 0.028771789744496346), ('NDCG@5', 0.8910378217697144), ('NDCG@10', 0.864936113357544), ('NDCG@20', 0.8230621218681335)])
2 stage (test) OrderedDict([('Precision@1', 0.945573091506958), ('Precision@5', 0.9280168414115906), ('Precision@10', 0.8946259021759033), ('Recall@1', 0.004472037311643362), ('Recall@5', 0.019000230357050896), ('Recall@10', 0.03391018509864807), ('NDCG@5', 0.932437002658844), ('NDCG@10', 0.908295750617981), ('NDCG@20', 0.8722979426383972)])

 ---epoch 9---
1 stage 0.8380795121192932
2 stage 0.9072847962379456
1 stage (val) OrderedDict([('Precision@1', 0.7774327397346497), ('Precision@5', 0.7842649817466736), ('Precision@10', 0.7509323954582214), ('Recall@1', 0.002658348297700286), ('Recall@5', 0.014832721091806889), ('Recall@10', 0.026316339150071144), ('NDCG@5', 0.7840657234191895), ('NDCG@10', 0.7613645195960999), ('NDCG@20', 0.7229173183441162)])
2 stage (val) OrderedDict([('Precision@1', 0.8799172043800354), ('Precision@5', 0.8540369272232056), ('Precision@10', 0.8135622143745422), ('Recall@1', 0.0062690419144928455), ('Recall@5', 0.022524649277329445), ('Recall@10', 0.036338649690151215), ('NDCG@5', 0.8600473999977112), ('NDCG@10', 0.8311757445335388), ('NDCG@20', 0.7800295948982239)])
1 stage (test) OrderedDict([('Precision@1', 0.8929019570350647), ('Precision@5', 0.8884896039962769), ('Precision@10', 0.8522148728370667), ('Recall@1', 0.003033872228115797), ('Recall@5', 0.015583191998302937), ('Recall@10', 0.02877078764140606), ('NDCG@5', 0.8902586698532104), ('NDCG@10', 0.8647649884223938), ('NDCG@20', 0.819994330406189)])
2 stage (test) OrderedDict([('Precision@1', 0.9480812549591064), ('Precision@5', 0.9282174706459045), ('Precision@10', 0.8930951952934265), ('Recall@1', 0.0048433043994009495), ('Recall@5', 0.01938510313630104), ('Recall@10', 0.034199949353933334), ('NDCG@5', 0.9331042766571045), ('NDCG@10', 0.9078661203384399), ('NDCG@20', 0.8701085448265076)])

 ---epoch 10---
1 stage 0.8384106159210205
2 stage 0.9134106040000916
1 stage (val) OrderedDict([('Precision@1', 0.7769151329994202), ('Precision@5', 0.7831262350082397), ('Precision@10', 0.7497938275337219), ('Recall@1', 0.002638294128701091), ('Recall@5', 0.01469119917601347), ('Recall@10', 0.026257483288645744), ('NDCG@5', 0.7835829854011536), ('NDCG@10', 0.7605829238891602), ('NDCG@20', 0.7207967042922974)])
2 stage (val) OrderedDict([('Precision@1', 0.8918219208717346), ('Precision@5', 0.8570390939712524), ('Precision@10', 0.814907968044281), ('Recall@1', 0.008813455700874329), ('Recall@5', 0.02534385398030281), ('Recall@10', 0.03912559151649475), ('NDCG@5', 0.8657218813896179), ('NDCG@10', 0.8357923626899719), ('NDCG@20', 0.7820301651954651)])
1 stage (test) OrderedDict([('Precision@1', 0.8936544060707092), ('Precision@5', 0.8870350122451782), ('Precision@10', 0.852089524269104), ('Recall@1', 0.0030382603872567415), ('Recall@5', 0.015487873926758766), ('Recall@10', 0.028747452422976494), ('NDCG@5', 0.8893518447875977), ('NDCG@10', 0.8645435571670532), ('NDCG@20', 0.8168845772743225)])
2 stage (test) OrderedDict([('Precision@1', 0.9515926837921143), ('Precision@5', 0.9289197325706482), ('Precision@10', 0.8925931453704834), ('Recall@1', 0.00530562037602067), ('Recall@5', 0.01984964869916439), ('Recall@10', 0.034625839442014694), ('NDCG@5', 0.934455931186676), ('NDCG@10', 0.908370316028595), ('NDCG@20', 0.8683386445045471)])

 ---epoch 11---
1 stage 0.8382450342178345
2 stage 0.9178808331489563
1 stage (val) OrderedDict([('Precision@1', 0.7763975262641907), ('Precision@5', 0.7809521555900574), ('Precision@10', 0.7494315505027771), ('Recall@1', 0.0026443819515407085), ('Recall@5', 0.014412852004170418), ('Recall@10', 0.026261471211910248), ('NDCG@5', 0.7819441556930542), ('NDCG@10', 0.7598832845687866), ('NDCG@20', 0.7190945148468018)])
2 stage (val) OrderedDict([('Precision@1', 0.8969979286193848), ('Precision@5', 0.8577637672424316), ('Precision@10', 0.8152186274528503), ('Recall@1', 0.009422323666512966), ('Recall@5', 0.025983646512031555), ('Recall@10', 0.039800457656383514), ('NDCG@5', 0.8674310445785522), ('NDCG@10', 0.8371434211730957), ('NDCG@20', 0.7816880941390991)])
1 stage (test) OrderedDict([('Precision@1', 0.8936544060707092), ('Precision@5', 0.8851792812347412), ('Precision@10', 0.8511864542961121), ('Recall@1', 0.003037412418052554), ('Recall@5', 0.015353466384112835), ('Recall@10', 0.028710903599858284), ('NDCG@5', 0.8880338668823242), ('NDCG@10', 0.863714873790741), ('NDCG@20', 0.8142037987709045)])
2 stage (test) OrderedDict([('Precision@1', 0.9558565616607666), ('Precision@5', 0.9299732446670532), ('Precision@10', 0.8927935361862183), ('Recall@1', 0.0059306323528289795), ('Recall@5', 0.020532211288809776), ('Recall@10', 0.03530930355191231), ('NDCG@5', 0.9361388683319092), ('NDCG@10', 0.9095468521118164), ('NDCG@20', 0.8673228025436401)])

 ---epoch 12---
1 stage 0.8379139304161072
2 stage 0.9187086224555969
1 stage (val) OrderedDict([('Precision@1', 0.7763975262641907), ('Precision@5', 0.7790886759757996), ('Precision@10', 0.7482412457466125), ('Recall@1', 0.0026424473617225885), ('Recall@5', 0.014272757805883884), ('Recall@10', 0.02620319463312626), ('NDCG@5', 0.7806203961372375), ('NDCG@10', 0.7588120102882385), ('NDCG@20', 0.7176167368888855)])
2 stage (val) OrderedDict([('Precision@1', 0.8980331420898438), ('Precision@5', 0.8579708337783813), ('Precision@10', 0.8153222799301147), ('Recall@1', 0.009448529221117496), ('Recall@5', 0.026153702288866043), ('Recall@10', 0.03998563066124916), ('NDCG@5', 0.8678606748580933), ('NDCG@10', 0.8374278545379639), ('NDCG@20', 0.7804821729660034)])
1 stage (test) OrderedDict([('Precision@1', 0.8931527733802795), ('Precision@5', 0.8826211094856262), ('Precision@10', 0.8504837155342102), ('Recall@1', 0.003025393933057785), ('Recall@5', 0.015070094726979733), ('Recall@10', 0.028680836781859398), ('NDCG@5', 0.8862404227256775), ('NDCG@10', 0.8629363775253296), ('NDCG@20', 0.812140166759491)])
2 stage (test) OrderedDict([('Precision@1', 0.9566089510917664), ('Precision@5', 0.9305751323699951), ('Precision@10', 0.8924673795700073), ('Recall@1', 0.005970606114715338), ('Recall@5', 0.020597636699676514), ('Recall@10', 0.0353248156607151), ('NDCG@5', 0.9366065859794617), ('NDCG@10', 0.9094142317771912), ('NDCG@20', 0.8652106523513794)])

 ---epoch 13---
1 stage 0.8370860815048218
2 stage 0.9218543171882629
1 stage (val) OrderedDict([('Precision@1', 0.773809552192688), ('Precision@5', 0.776500940322876), ('Precision@10', 0.7477753162384033), ('Recall@1', 0.002600757172331214), ('Recall@5', 0.014013935811817646), ('Recall@10', 0.026155436411499977), ('NDCG@5', 0.7787651419639587), ('NDCG@10', 0.7581520676612854), ('NDCG@20', 0.7166268229484558)])
2 stage (val) OrderedDict([('Precision@1', 0.9042443037033081), ('Precision@5', 0.8592130541801453), ('Precision@10', 0.8160468339920044), ('Recall@1', 0.009929532185196877), ('Recall@5', 0.026682788506150246), ('Recall@10', 0.04050769284367561), ('NDCG@5', 0.8700749278068542), ('NDCG@10', 0.8390794396400452), ('NDCG@20', 0.7801383137702942)])
1 stage (test) OrderedDict([('Precision@1', 0.8931527733802795), ('Precision@5', 0.8803136944770813), ('Precision@10', 0.8495557308197021), ('Recall@1', 0.003027866594493389), ('Recall@5', 0.01499134674668312), ('Recall@10', 0.02862103283405304), ('NDCG@5', 0.8846299648284912), ('NDCG@10', 0.86198890209198), ('NDCG@20', 0.8100637793540955)])
2 stage (test) OrderedDict([('Precision@1', 0.9583646655082703), ('Precision@5', 0.9305752515792847), ('Precision@10', 0.8925175666809082), ('Recall@1', 0.006159719079732895), ('Recall@5', 0.02088220976293087), ('Recall@10', 0.035595737397670746), ('NDCG@5', 0.9370740056037903), ('NDCG@10', 0.9098483324050903), ('NDCG@20', 0.8639865517616272)])

 ---epoch 14---
1 stage 0.8369205594062805
2 stage 0.9240066409111023
1 stage (val) OrderedDict([('Precision@1', 0.773809552192688), ('Precision@5', 0.773705780506134), ('Precision@10', 0.7468438148498535), ('Recall@1', 0.002625058637931943), ('Recall@5', 0.013789812102913857), ('Recall@10', 0.026069900020956993), ('NDCG@5', 0.7768892645835876), ('NDCG@10', 0.7571765780448914), ('NDCG@20', 0.715872049331665)])
2 stage (val) OrderedDict([('Precision@1', 0.9042443037033081), ('Precision@5', 0.8591095209121704), ('Precision@10', 0.8163056969642639), ('Recall@1', 0.009976180270314217), ('Recall@5', 0.02666594833135605), ('Recall@10', 0.0405643992125988), ('NDCG@5', 0.8700694441795349), ('NDCG@10', 0.8392456769943237), ('NDCG@20', 0.7795045375823975)])
1 stage (test) OrderedDict([('Precision@1', 0.8929019570350647), ('Precision@5', 0.8788090348243713), ('Precision@10', 0.8485274314880371), ('Recall@1', 0.0030219501350075006), ('Recall@5', 0.014938991516828537), ('Recall@10', 0.02854839526116848), ('NDCG@5', 0.8835630416870117), ('NDCG@10', 0.861046552658081), ('NDCG@20', 0.8082680702209473)])
2 stage (test) OrderedDict([('Precision@1', 0.9616252779960632), ('Precision@5', 0.9315785765647888), ('Precision@10', 0.8929688334465027), ('Recall@1', 0.0066758450120687485), ('Recall@5', 0.02143881842494011), ('Recall@10', 0.03613971546292305), ('NDCG@5', 0.9386357069015503), ('NDCG@10', 0.9109789729118347), ('NDCG@20', 0.8636295795440674)])

 ---epoch 15---
1 stage 0.8367549777030945
2 stage 0.9263245463371277
1 stage (val) OrderedDict([('Precision@1', 0.7732919454574585), ('Precision@5', 0.7711178064346313), ('Precision@10', 0.7458087205886841), ('Recall@1', 0.0026230306830257177), ('Recall@5', 0.013649744912981987), ('Recall@10', 0.025645026937127113), ('NDCG@5', 0.7750684022903442), ('NDCG@10', 0.756171464920044), ('NDCG@20', 0.7145808935165405)])
2 stage (val) OrderedDict([('Precision@1', 0.9078674912452698), ('Precision@5', 0.8598342537879944), ('Precision@10', 0.8168233036994934), ('Recall@1', 0.010108765214681625), ('Recall@5', 0.026852861046791077), ('Recall@10', 0.04076804965734482), ('NDCG@5', 0.8712517023086548), ('NDCG@10', 0.8401376605033875), ('NDCG@20', 0.7791740894317627)])
1 stage (test) OrderedDict([('Precision@1', 0.8929019570350647), ('Precision@5', 0.8776553869247437), ('Precision@10', 0.8467967510223389), ('Recall@1', 0.0030198993626981974), ('Recall@5', 0.014920705929398537), ('Recall@10', 0.02837933599948883), ('NDCG@5', 0.8827570676803589), ('NDCG@10', 0.8596747517585754), ('NDCG@20', 0.806827962398529)])
2 stage (test) OrderedDict([('Precision@1', 0.9633809924125671), ('Precision@5', 0.9314783215522766), ('Precision@10', 0.8932698965072632), ('Recall@1', 0.006833173334598541), ('Recall@5', 0.02157573401927948), ('Recall@10', 0.03630045801401138), ('NDCG@5', 0.9389359354972839), ('NDCG@10', 0.9114251732826233), ('NDCG@20', 0.8627160787582397)])

 ---epoch 16---
1 stage 0.8377483487129211
2 stage 0.9279801249504089
1 stage (val) OrderedDict([('Precision@1', 0.7732919454574585), ('Precision@5', 0.7703932523727417), ('Precision@10', 0.7450322508811951), ('Recall@1', 0.0026215016841888428), ('Recall@5', 0.01363329030573368), ('Recall@10', 0.02535092830657959), ('NDCG@5', 0.7744974493980408), ('NDCG@10', 0.7555225491523743), ('NDCG@20', 0.7141284346580505)])
2 stage (val) OrderedDict([('Precision@1', 0.909937858581543), ('Precision@5', 0.85973060131073), ('Precision@10', 0.8169785737991333), ('Recall@1', 0.010247328318655491), ('Recall@5', 0.026916243135929108), ('Recall@10', 0.04083896055817604), ('NDCG@5', 0.871487021446228), ('NDCG@10', 0.8404349684715271), ('NDCG@20', 0.7784505486488342)])
1 stage (test) OrderedDict([('Precision@1', 0.894406795501709), ('Precision@5', 0.8763011693954468), ('Precision@10', 0.8460192084312439), ('Recall@1', 0.0030427267774939537), ('Recall@5', 0.014874869957566261), ('Recall@10', 0.02825956419110298), ('NDCG@5', 0.8819859623908997), ('NDCG@10', 0.8590070009231567), ('NDCG@20', 0.8056714534759521)])
2 stage (test) OrderedDict([('Precision@1', 0.9648858904838562), ('Precision@5', 0.9313278198242188), ('Precision@10', 0.8936462998390198), ('Recall@1', 0.0066637517884373665), ('Recall@5', 0.02140112966299057), ('Recall@10', 0.03614155203104019), ('NDCG@5', 0.9389299154281616), ('NDCG@10', 0.9116401672363281), ('NDCG@20', 0.8616355061531067)])

 ---epoch 17---
1 stage 0.8380795121192932
2 stage 0.928311288356781
1 stage (val) OrderedDict([('Precision@1', 0.7743270993232727), ('Precision@5', 0.7690474987030029), ('Precision@10', 0.7437383532524109), ('Recall@1', 0.0026126643642783165), ('Recall@5', 0.013555226847529411), ('Recall@10', 0.025189176201820374), ('NDCG@5', 0.7735527753829956), ('NDCG@10', 0.7544404864311218), ('NDCG@20', 0.7135841250419617)])
2 stage (val) OrderedDict([('Precision@1', 0.910973072052002), ('Precision@5', 0.858384907245636), ('Precision@10', 0.8159434795379639), ('Recall@1', 0.010241901502013206), ('Recall@5', 0.026761410757899284), ('Recall@10', 0.04070962220430374), ('NDCG@5', 0.8705347776412964), ('NDCG@10', 0.8395485281944275), ('NDCG@20', 0.7770092487335205)])
1 stage (test) OrderedDict([('Precision@1', 0.894406795501709), ('Precision@5', 0.8756492137908936), ('Precision@10', 0.8449908494949341), ('Recall@1', 0.0030495007522404194), ('Recall@5', 0.01483848039060831), ('Recall@10', 0.028159769251942635), ('NDCG@5', 0.881527304649353), ('NDCG@10', 0.8581295013427734), ('NDCG@20', 0.8043125867843628)])
2 stage (test) OrderedDict([('Precision@1', 0.9648858904838562), ('Precision@5', 0.9307761192321777), ('Precision@10', 0.8930948376655579), ('Recall@1', 0.006684644613415003), ('Recall@5', 0.02141491509974003), ('Recall@10', 0.03612670674920082), ('NDCG@5', 0.9385197758674622), ('NDCG@10', 0.911191999912262), ('NDCG@20', 0.860363781452179)])

 ---epoch 18---
1 stage 0.8385761976242065
2 stage 0.9284768104553223
1 stage (val) OrderedDict([('Precision@1', 0.7753623127937317), ('Precision@5', 0.7689440250396729), ('Precision@10', 0.7423926591873169), ('Recall@1', 0.0026258444413542747), ('Recall@5', 0.013555916957557201), ('Recall@10', 0.02488681487739086), ('NDCG@5', 0.7735055088996887), ('NDCG@10', 0.7535225749015808), ('NDCG@20', 0.7133587598800659)])
2 stage (val) OrderedDict([('Precision@1', 0.9120082855224609), ('Precision@5', 0.8580743074417114), ('Precision@10', 0.815373957157135), ('Recall@1', 0.010421862825751305), ('Recall@5', 0.026906386017799377), ('Recall@10', 0.040826473385095596), ('NDCG@5', 0.8705376982688904), ('NDCG@10', 0.8393794298171997), ('NDCG@20', 0.776407778263092)])
1 stage (test) OrderedDict([('Precision@1', 0.8946576118469238), ('Precision@5', 0.8744452595710754), ('Precision@10', 0.8425575494766235), ('Recall@1', 0.0030520563013851643), ('Recall@5', 0.01479689683765173), ('Recall@10', 0.0279135312885046), ('NDCG@5', 0.8807300925254822), ('NDCG@10', 0.8563908338546753), ('NDCG@20', 0.8030115365982056)])
2 stage (test) OrderedDict([('Precision@1', 0.9646350741386414), ('Precision@5', 0.9301741719245911), ('Precision@10', 0.8928941488265991), ('Recall@1', 0.006708457134664059), ('Recall@5', 0.021374143660068512), ('Recall@10', 0.036129772663116455), ('NDCG@5', 0.9379391670227051), ('NDCG@10', 0.9108685255050659), ('NDCG@20', 0.8594520092010498)])

 ---epoch 19---
1 stage 0.8392384052276611
2 stage 0.9306291341781616
1 stage (val) OrderedDict([('Precision@1', 0.7779502868652344), ('Precision@5', 0.7680123448371887), ('Precision@10', 0.7404776215553284), ('Recall@1', 0.0026848965790122747), ('Recall@5', 0.013484515249729156), ('Recall@10', 0.02446618862450123), ('NDCG@5', 0.7731295824050903), ('NDCG@10', 0.7523353695869446), ('NDCG@20', 0.712979793548584)])
2 stage (val) OrderedDict([('Precision@1', 0.9145962595939636), ('Precision@5', 0.857660174369812), ('Precision@10', 0.8152185082435608), ('Recall@1', 0.01090286485850811), ('Recall@5', 0.027272948995232582), ('Recall@10', 0.041257504373788834), ('NDCG@5', 0.8707783222198486), ('NDCG@10', 0.839805006980896), ('NDCG@20', 0.7766426205635071)])
1 stage (test) OrderedDict([('Precision@1', 0.894406795501709), ('Precision@5', 0.8728401064872742), ('Precision@10', 0.8400994539260864), ('Recall@1', 0.0030561115127056837), ('Recall@5', 0.014737891964614391), ('Recall@10', 0.02773532271385193), ('NDCG@5', 0.8795916438102722), ('NDCG@10', 0.8545643091201782), ('NDCG@20', 0.8020243644714355)])
2 stage (test) OrderedDict([('Precision@1', 0.9666416049003601), ('Precision@5', 0.9304250478744507), ('Precision@10', 0.8929947018623352), ('Recall@1', 0.007100214716047049), ('Recall@5', 0.021800579503178596), ('Recall@10', 0.03653929382562637), ('NDCG@5', 0.9387186765670776), ('NDCG@10', 0.9114676117897034), ('NDCG@20', 0.8593714833259583)])
------------------------------------------------------------
Best validation epoch: 3
Best validation stage results
 1 stage: OrderedDict([('Precision@1', 0.8126294016838074), ('Precision@5', 0.7779499292373657), ('Precision@10', 0.7338512539863586), ('Recall@1', 0.0033686021342873573), ('Recall@5', 0.01513863354921341), ('Recall@10', 0.02453457936644554), ('NDCG@5', 0.7867214679718018), ('NDCG@10', 0.7529513239860535), ('NDCG@20', 0.7277429103851318)])
 2 stage: OrderedDict([('Precision@1', 0.888198733329773), ('Precision@5', 0.8572463989257812), ('Precision@10', 0.8187380433082581), ('Recall@1', 0.006073897238820791), ('Recall@5', 0.02243436872959137), ('Recall@10', 0.03656478226184845), ('NDCG@5', 0.864194929599762), ('NDCG@10', 0.8359416723251343), ('NDCG@20', 0.7880752086639404)])
Best test results
 1 stage: OrderedDict([('Precision@1', 0.9016804695129395), ('Precision@5', 0.8805646300315857), ('Precision@10', 0.8358871340751648), ('Recall@1', 0.003201593179255724), ('Recall@5', 0.015480294823646545), ('Recall@10', 0.02752745896577835), ('NDCG@5', 0.8866994976997375), ('NDCG@10', 0.8532336354255676), ('NDCG@20', 0.825230598449707)])
 2 stage: OrderedDict([('Precision@1', 0.948833703994751), ('Precision@5', 0.9304746389389038), ('Precision@10', 0.900822103023529), ('Recall@1', 0.004499442409723997), ('Recall@5', 0.01905914954841137), ('Recall@10', 0.03411457687616348), ('NDCG@5', 0.9347596168518066), ('NDCG@10', 0.9129462242126465), ('NDCG@20', 0.8783280849456787)])
loaded full_impression_feats.pt
-----------------------------------------------------
ALGORITHMS EVALUATION 
 with loss type: loss_2s

 ---epoch 0---
1 stage 0.873344361782074
2 stage 0.9384106397628784
1 stage (val) OrderedDict([('Precision@1', 0.8338509202003479), ('Precision@5', 0.7877851128578186), ('Precision@10', 0.7181189060211182), ('Recall@1', 0.003642122959718108), ('Recall@5', 0.020684462040662766), ('Recall@10', 0.041265055537223816), ('NDCG@5', 0.7985565066337585), ('NDCG@10', 0.7462682723999023), ('NDCG@20', 0.6313529014587402)])
2 stage (val) OrderedDict([('Precision@1', 0.9301242232322693), ('Precision@5', 0.875673234462738), ('Precision@10', 0.8062130808830261), ('Recall@1', 0.014403818175196648), ('Recall@5', 0.03602266684174538), ('Recall@10', 0.05059070140123367), ('NDCG@5', 0.8918942213058472), ('NDCG@10', 0.8433381915092468), ('NDCG@20', 0.7105907201766968)])
1 stage (test) OrderedDict([('Precision@1', 0.9189866781234741), ('Precision@5', 0.8634147047996521), ('Precision@10', 0.78136146068573), ('Recall@1', 0.0034247369039803743), ('Recall@5', 0.017489982768893242), ('Recall@10', 0.03379764035344124), ('NDCG@5', 0.8775942325592041), ('NDCG@10', 0.8160069584846497), ('NDCG@20', 0.6786080598831177)])
2 stage (test) OrderedDict([('Precision@1', 0.9709054231643677), ('Precision@5', 0.9409087300300598), ('Precision@10', 0.8751149773597717), ('Recall@1', 0.009031438268721104), ('Recall@5', 0.026501670479774475), ('Recall@10', 0.041449856013059616), ('NDCG@5', 0.9497897028923035), ('NDCG@10', 0.9045546650886536), ('NDCG@20', 0.7551402449607849)])

 ---epoch 1---
1 stage 0.8753311634063721
2 stage 0.9385761618614197
1 stage (val) OrderedDict([('Precision@1', 0.8354037404060364), ('Precision@5', 0.8445125222206116), ('Precision@10', 0.755904495716095), ('Recall@1', 0.0036841146647930145), ('Recall@5', 0.032292719930410385), ('Recall@10', 0.046266473829746246), ('NDCG@5', 0.843669593334198), ('NDCG@10', 0.786135733127594), ('NDCG@20', 0.6578509211540222)])
2 stage (val) OrderedDict([('Precision@1', 0.9311594367027283), ('Precision@5', 0.8897523283958435), ('Precision@10', 0.8409956097602844), ('Recall@1', 0.014148821122944355), ('Recall@5', 0.04270213097333908), ('Recall@10', 0.05903777852654457), ('NDCG@5', 0.9045421481132507), ('NDCG@10', 0.8711667060852051), ('NDCG@20', 0.7512878775596619)])
1 stage (test) OrderedDict([('Precision@1', 0.9212440252304077), ('Precision@5', 0.9205431342124939), ('Precision@10', 0.8301914930343628), ('Recall@1', 0.0034814050886780024), ('Recall@5', 0.024621345102787018), ('Recall@10', 0.038262225687503815), ('NDCG@5', 0.9212713241577148), ('NDCG@10', 0.861315131187439), ('NDCG@20', 0.7117437720298767)])
2 stage (test) OrderedDict([('Precision@1', 0.9706546068191528), ('Precision@5', 0.9434677362442017), ('Precision@10', 0.9044354557991028), ('Recall@1', 0.008502614684402943), ('Recall@5', 0.029152661561965942), ('Recall@10', 0.04529530555009842), ('NDCG@5', 0.9521176218986511), ('NDCG@10', 0.9244924783706665), ('NDCG@20', 0.7995257377624512)])

 ---epoch 2---
1 stage 0.8731788396835327
2 stage 0.9435430765151978
1 stage (val) OrderedDict([('Precision@1', 0.8312629461288452), ('Precision@5', 0.8476181626319885), ('Precision@10', 0.7773318886756897), ('Recall@1', 0.0035402001813054085), ('Recall@5', 0.03262514993548393), ('Recall@10', 0.04820612445473671), ('NDCG@5', 0.8456135988235474), ('NDCG@10', 0.7999119758605957), ('NDCG@20', 0.6980400085449219)])
2 stage (val) OrderedDict([('Precision@1', 0.9394409656524658), ('Precision@5', 0.9113879203796387), ('Precision@10', 0.8637183904647827), ('Recall@1', 0.014307752251625061), ('Recall@5', 0.05073155462741852), ('Recall@10', 0.07030732184648514), ('NDCG@5', 0.9216817617416382), ('NDCG@10', 0.891334593296051), ('NDCG@20', 0.7943497896194458)])
1 stage (test) OrderedDict([('Precision@1', 0.9199899435043335), ('Precision@5', 0.9240540862083435), ('Precision@10', 0.863624095916748), ('Recall@1', 0.0034455673303455114), ('Recall@5', 0.024460382759571075), ('Recall@10', 0.03978703171014786), ('NDCG@5', 0.9238967895507812), ('NDCG@10', 0.8838794231414795), ('NDCG@20', 0.7710138559341431)])
2 stage (test) OrderedDict([('Precision@1', 0.9741660356521606), ('Precision@5', 0.9570612907409668), ('Precision@10', 0.9234714508056641), ('Recall@1', 0.00781621690839529), ('Recall@5', 0.03321736305952072), ('Recall@10', 0.050937220454216), ('NDCG@5', 0.962189257144928), ('NDCG@10', 0.9397227764129639), ('NDCG@20', 0.8485462069511414)])

 ---epoch 3---
1 stage 0.8728476762771606
2 stage 0.943708598613739
1 stage (val) OrderedDict([('Precision@1', 0.8307453393936157), ('Precision@5', 0.8465829491615295), ('Precision@10', 0.7751567363739014), ('Recall@1', 0.0035668653436005116), ('Recall@5', 0.03270033001899719), ('Recall@10', 0.04852311685681343), ('NDCG@5', 0.8448703289031982), ('NDCG@10', 0.7976555228233337), ('NDCG@20', 0.7094318270683289)])
2 stage (val) OrderedDict([('Precision@1', 0.9404761791229248), ('Precision@5', 0.91521817445755), ('Precision@10', 0.8648566603660583), ('Recall@1', 0.014898229390382767), ('Recall@5', 0.0528409406542778), ('Recall@10', 0.07275377213954926), ('NDCG@5', 0.9252486824989319), ('NDCG@10', 0.8936250805854797), ('NDCG@20', 0.7935351133346558)])
1 stage (test) OrderedDict([('Precision@1', 0.9197391271591187), ('Precision@5', 0.9264116287231445), ('Precision@10', 0.8730055093765259), ('Recall@1', 0.0034180800430476665), ('Recall@5', 0.02452448010444641), ('Recall@10', 0.04040439799427986), ('NDCG@5', 0.9255384802818298), ('NDCG@10', 0.8901402950286865), ('NDCG@20', 0.7891217470169067)])
2 stage (test) OrderedDict([('Precision@1', 0.9739152193069458), ('Precision@5', 0.9596194624900818), ('Precision@10', 0.9265311360359192), ('Recall@1', 0.007858017459511757), ('Recall@5', 0.03383801877498627), ('Recall@10', 0.051749277859926224), ('NDCG@5', 0.9642794132232666), ('NDCG@10', 0.9424636960029602), ('NDCG@20', 0.8509746193885803)])

 ---epoch 4---
1 stage 0.871854305267334
2 stage 0.943874180316925
1 stage (val) OrderedDict([('Precision@1', 0.8291925191879272), ('Precision@5', 0.8445125222206116), ('Precision@10', 0.77577805519104), ('Recall@1', 0.0035469415597617626), ('Recall@5', 0.03286739066243172), ('Recall@10', 0.05468452349305153), ('NDCG@5', 0.8436872959136963), ('NDCG@10', 0.7966625094413757), ('NDCG@20', 0.7110303044319153)])
2 stage (val) OrderedDict([('Precision@1', 0.9409937858581543), ('Precision@5', 0.914907693862915), ('Precision@10', 0.8615439534187317), ('Recall@1', 0.014932735823094845), ('Recall@5', 0.05287071689963341), ('Recall@10', 0.07229438424110413), ('NDCG@5', 0.925213634967804), ('NDCG@10', 0.8914133906364441), ('NDCG@20', 0.7903339862823486)])
1 stage (test) OrderedDict([('Precision@1', 0.9189866781234741), ('Precision@5', 0.9278162121772766), ('Precision@10', 0.8754640817642212), ('Recall@1', 0.0034107810351997614), ('Recall@5', 0.024635957553982735), ('Recall@10', 0.042894214391708374), ('NDCG@5', 0.9267644286155701), ('NDCG@10', 0.8917465806007385), ('NDCG@20', 0.7922101020812988)])
2 stage (test) OrderedDict([('Precision@1', 0.9739152193069458), ('Precision@5', 0.959619402885437), ('Precision@10', 0.9259538054466248), ('Recall@1', 0.007858017459511757), ('Recall@5', 0.03384460508823395), ('Recall@10', 0.05136534199118614), ('NDCG@5', 0.9641972184181213), ('NDCG@10', 0.9420285224914551), ('NDCG@20', 0.8499817252159119)])

 ---epoch 5---
1 stage 0.8715232014656067
2 stage 0.9442052841186523
1 stage (val) OrderedDict([('Precision@1', 0.828157365322113), ('Precision@5', 0.8440985679626465), ('Precision@10', 0.7751054167747498), ('Recall@1', 0.0035600538831204176), ('Recall@5', 0.03293487802147865), ('Recall@10', 0.05498601496219635), ('NDCG@5', 0.8435922861099243), ('NDCG@10', 0.7962989807128906), ('NDCG@20', 0.7122547030448914)])
2 stage (val) OrderedDict([('Precision@1', 0.9420289993286133), ('Precision@5', 0.9152182340621948), ('Precision@10', 0.8588525652885437), ('Recall@1', 0.014970477670431137), ('Recall@5', 0.05290345475077629), ('Recall@10', 0.07179859280586243), ('NDCG@5', 0.9254247546195984), ('NDCG@10', 0.8896178603172302), ('NDCG@20', 0.789766252040863)])
1 stage (test) OrderedDict([('Precision@1', 0.9189866781234741), ('Precision@5', 0.929371178150177), ('Precision@10', 0.873407244682312), ('Recall@1', 0.0034213666804134846), ('Recall@5', 0.02445461042225361), ('Recall@10', 0.043027978390455246), ('NDCG@5', 0.9281464219093323), ('NDCG@10', 0.8906310200691223), ('NDCG@20', 0.7925272583961487)])
2 stage (test) OrderedDict([('Precision@1', 0.9739152193069458), ('Precision@5', 0.9595691561698914), ('Precision@10', 0.9251015186309814), ('Recall@1', 0.007858017459511757), ('Recall@5', 0.03378944844007492), ('Recall@10', 0.05123606324195862), ('NDCG@5', 0.9642377495765686), ('NDCG@10', 0.9415031671524048), ('NDCG@20', 0.8496964573860168)])

 ---epoch 6---
1 stage 0.8711920380592346
2 stage 0.9440397620201111
1 stage (val) OrderedDict([('Precision@1', 0.8286749720573425), ('Precision@5', 0.8456515669822693), ('Precision@10', 0.7802817821502686), ('Recall@1', 0.003579061245545745), ('Recall@5', 0.03249823674559593), ('Recall@10', 0.05669151619076729), ('NDCG@5', 0.8449612855911255), ('NDCG@10', 0.8000505566596985), ('NDCG@20', 0.7129603624343872)])
2 stage (val) OrderedDict([('Precision@1', 0.9415113925933838), ('Precision@5', 0.9159427881240845), ('Precision@10', 0.8606643080711365), ('Recall@1', 0.014797944575548172), ('Recall@5', 0.05294150114059448), ('Recall@10', 0.07188677042722702), ('NDCG@5', 0.9257479906082153), ('NDCG@10', 0.8907122015953064), ('NDCG@20', 0.7934211492538452)])
1 stage (test) OrderedDict([('Precision@1', 0.9182342886924744), ('Precision@5', 0.9304243326187134), ('Precision@10', 0.8760902285575867), ('Recall@1', 0.003392111510038376), ('Recall@5', 0.0243728905916214), ('Recall@10', 0.04407436400651932), ('NDCG@5', 0.9288574457168579), ('NDCG@10', 0.8924244046211243), ('NDCG@20', 0.7893427610397339)])
2 stage (test) OrderedDict([('Precision@1', 0.9739152193069458), ('Precision@5', 0.960070788860321), ('Precision@10', 0.9260292649269104), ('Recall@1', 0.007858017459511757), ('Recall@5', 0.03384515270590782), ('Recall@10', 0.05133317410945892), ('NDCG@5', 0.9645946621894836), ('NDCG@10', 0.9422363638877869), ('NDCG@20', 0.8519969582557678)])

 ---epoch 7---
1 stage 0.8710265159606934
2 stage 0.9443708658218384
1 stage (val) OrderedDict([('Precision@1', 0.8297101259231567), ('Precision@5', 0.8514488935470581), ('Precision@10', 0.7854577898979187), ('Recall@1', 0.0036012919154018164), ('Recall@5', 0.03555092588067055), ('Recall@10', 0.05728212743997574), ('NDCG@5', 0.8481239080429077), ('NDCG@10', 0.8049586415290833), ('NDCG@20', 0.7177723050117493)])
2 stage (val) OrderedDict([('Precision@1', 0.9425466060638428), ('Precision@5', 0.916149914264679), ('Precision@10', 0.8632526397705078), ('Recall@1', 0.01483029406517744), ('Recall@5', 0.05296662822365761), ('Recall@10', 0.07216054201126099), ('NDCG@5', 0.9260120987892151), ('NDCG@10', 0.8925718665122986), ('NDCG@20', 0.7971721291542053)])
1 stage (test) OrderedDict([('Precision@1', 0.9174818396568298), ('Precision@5', 0.9323304891586304), ('Precision@10', 0.8780455589294434), ('Recall@1', 0.0033601459581404924), ('Recall@5', 0.02541440539062023), ('Recall@10', 0.044133510440588), ('NDCG@5', 0.9298123121261597), ('NDCG@10', 0.8942909240722656), ('NDCG@20', 0.790717601776123)])
2 stage (test) OrderedDict([('Precision@1', 0.9739152193069458), ('Precision@5', 0.960572361946106), ('Precision@10', 0.9268561005592346), ('Recall@1', 0.007858017459511757), ('Recall@5', 0.03389439359307289), ('Recall@10', 0.05133416876196861), ('NDCG@5', 0.9649993181228638), ('NDCG@10', 0.9429105520248413), ('NDCG@20', 0.8533531427383423)])

 ---epoch 8---
1 stage 0.87052983045578
2 stage 0.9443708658218384
1 stage (val) OrderedDict([('Precision@1', 0.8291925191879272), ('Precision@5', 0.8628373146057129), ('Precision@10', 0.7907371520996094), ('Recall@1', 0.003596167080104351), ('Recall@5', 0.039720479398965836), ('Recall@10', 0.05748104676604271), ('NDCG@5', 0.8561263680458069), ('NDCG@10', 0.8106748461723328), ('NDCG@20', 0.722335696220398)])
2 stage (val) OrderedDict([('Precision@1', 0.9425466060638428), ('Precision@5', 0.9172885417938232), ('Precision@10', 0.8649604320526123), ('Recall@1', 0.01483029406517744), ('Recall@5', 0.05299568176269531), ('Recall@10', 0.07213201373815536), ('NDCG@5', 0.9268448352813721), ('NDCG@10', 0.8938650488853455), ('NDCG@20', 0.7998582124710083)])
1 stage (test) OrderedDict([('Precision@1', 0.9169802069664001), ('Precision@5', 0.9375976920127869), ('Precision@10', 0.8808299899101257), ('Recall@1', 0.0033486471511423588), ('Recall@5', 0.027368180453777313), ('Recall@10', 0.04409157484769821), ('NDCG@5', 0.9333572387695312), ('NDCG@10', 0.8973307609558105), ('NDCG@20', 0.7939802408218384)])
2 stage (test) OrderedDict([('Precision@1', 0.9739152193069458), ('Precision@5', 0.9613246917724609), ('Precision@10', 0.9292142987251282), ('Recall@1', 0.007858017459511757), ('Recall@5', 0.03391904756426811), ('Recall@10', 0.051458753645420074), ('NDCG@5', 0.9654447436332703), ('NDCG@10', 0.9445306658744812), ('NDCG@20', 0.8544122576713562)])

 ---epoch 9---
1 stage 0.8713576197624207
2 stage 0.9443708658218384
1 stage (val) OrderedDict([('Precision@1', 0.8307453393936157), ('Precision@5', 0.865321695804596), ('Precision@10', 0.792497456073761), ('Recall@1', 0.003700616303831339), ('Recall@5', 0.0393974669277668), ('Recall@10', 0.057807497680187225), ('NDCG@5', 0.8602885007858276), ('NDCG@10', 0.8141997456550598), ('NDCG@20', 0.7221478819847107)])
2 stage (val) OrderedDict([('Precision@1', 0.9430641531944275), ('Precision@5', 0.9181166887283325), ('Precision@10', 0.8678065538406372), ('Recall@1', 0.01500282809138298), ('Recall@5', 0.05298842117190361), ('Recall@10', 0.0718461275100708), ('NDCG@5', 0.9277399778366089), ('NDCG@10', 0.8964902758598328), ('NDCG@20', 0.7953608632087708)])
1 stage (test) OrderedDict([('Precision@1', 0.9174818396568298), ('Precision@5', 0.9374470710754395), ('Precision@10', 0.8820593357086182), ('Recall@1', 0.003359477501362562), ('Recall@5', 0.02692492865025997), ('Recall@10', 0.04415930435061455), ('NDCG@5', 0.9342272877693176), ('NDCG@10', 0.8988990783691406), ('NDCG@20', 0.7906973958015442)])
2 stage (test) OrderedDict([('Precision@1', 0.973664402961731), ('Precision@5', 0.9625282883644104), ('Precision@10', 0.9332548975944519), ('Recall@1', 0.007816214114427567), ('Recall@5', 0.03372284024953842), ('Recall@10', 0.05132255703210831), ('NDCG@5', 0.966265082359314), ('NDCG@10', 0.9475633502006531), ('NDCG@20', 0.846182644367218)])

 ---epoch 10---
1 stage 0.8715232014656067
2 stage 0.9443708658218384
1 stage (val) OrderedDict([('Precision@1', 0.8328157067298889), ('Precision@5', 0.8649077415466309), ('Precision@10', 0.7945675253868103), ('Recall@1', 0.003785414155572653), ('Recall@5', 0.038480695337057114), ('Recall@10', 0.05809003859758377), ('NDCG@5', 0.8613322377204895), ('NDCG@10', 0.8164018392562866), ('NDCG@20', 0.7221307754516602)])
2 stage (val) OrderedDict([('Precision@1', 0.9430641531944275), ('Precision@5', 0.9184269905090332), ('Precision@10', 0.8685827851295471), ('Recall@1', 0.01500282809138298), ('Recall@5', 0.05311937630176544), ('Recall@10', 0.07168952375650406), ('NDCG@5', 0.9280794858932495), ('NDCG@10', 0.8972344994544983), ('NDCG@20', 0.7971600294113159)])
1 stage (test) OrderedDict([('Precision@1', 0.9167293906211853), ('Precision@5', 0.9363434314727783), ('Precision@10', 0.8855713605880737), ('Recall@1', 0.003344816155731678), ('Recall@5', 0.02658488228917122), ('Recall@10', 0.04434677213430405), ('NDCG@5', 0.9335623979568481), ('NDCG@10', 0.9010850787162781), ('NDCG@20', 0.7878006100654602)])
2 stage (test) OrderedDict([('Precision@1', 0.973664402961731), ('Precision@5', 0.9630299210548401), ('Precision@10', 0.9340076446533203), ('Recall@1', 0.007816214114427567), ('Recall@5', 0.03367449343204498), ('Recall@10', 0.05126086622476578), ('NDCG@5', 0.9666032791137695), ('NDCG@10', 0.948119580745697), ('NDCG@20', 0.8466151356697083)])

 ---epoch 11---
1 stage 0.8716887831687927
2 stage 0.9445364475250244
1 stage (val) OrderedDict([('Precision@1', 0.8328157067298889), ('Precision@5', 0.8650111556053162), ('Precision@10', 0.7960682511329651), ('Recall@1', 0.0037994070444256067), ('Recall@5', 0.03818630799651146), ('Recall@10', 0.05843367055058479), ('NDCG@5', 0.8614438772201538), ('NDCG@10', 0.8172826170921326), ('NDCG@20', 0.7265201807022095)])
2 stage (val) OrderedDict([('Precision@1', 0.943581759929657), ('Precision@5', 0.9192551374435425), ('Precision@10', 0.8702907562255859), ('Recall@1', 0.015014591626822948), ('Recall@5', 0.05309101194143295), ('Recall@10', 0.07169770449399948), ('NDCG@5', 0.9286661148071289), ('NDCG@10', 0.8985097408294678), ('NDCG@20', 0.8005960583686829)])
1 stage (test) OrderedDict([('Precision@1', 0.9169802069664001), ('Precision@5', 0.9357415437698364), ('Precision@10', 0.8876538276672363), ('Recall@1', 0.0033544662874192), ('Recall@5', 0.025780821219086647), ('Recall@10', 0.044435515999794006), ('NDCG@5', 0.9333763122558594), ('NDCG@10', 0.9025286436080933), ('NDCG@20', 0.7911216616630554)])
2 stage (test) OrderedDict([('Precision@1', 0.973664402961731), ('Precision@5', 0.9631302952766418), ('Precision@10', 0.9348605871200562), ('Recall@1', 0.007816214114427567), ('Recall@5', 0.03368328884243965), ('Recall@10', 0.051325052976608276), ('NDCG@5', 0.9667436480522156), ('NDCG@10', 0.9488219618797302), ('NDCG@20', 0.8495675325393677)])

 ---epoch 12---
1 stage 0.872185468673706
2 stage 0.9445364475250244
1 stage (val) OrderedDict([('Precision@1', 0.8343685269355774), ('Precision@5', 0.8655286431312561), ('Precision@10', 0.7967411875724792), ('Recall@1', 0.003823715727776289), ('Recall@5', 0.037585459649562836), ('Recall@10', 0.05842055007815361), ('NDCG@5', 0.8622679114341736), ('NDCG@10', 0.8181396722793579), ('NDCG@20', 0.726946234703064)])
2 stage (val) OrderedDict([('Precision@1', 0.943581759929657), ('Precision@5', 0.919255256652832), ('Precision@10', 0.8715327382087708), ('Recall@1', 0.015014591626822948), ('Recall@5', 0.05310264229774475), ('Recall@10', 0.07185567170381546), ('NDCG@5', 0.9287427663803101), ('NDCG@10', 0.8994393944740295), ('NDCG@20', 0.8032458424568176)])
1 stage (test) OrderedDict([('Precision@1', 0.9169802069664001), ('Precision@5', 0.9359421730041504), ('Precision@10', 0.8880051374435425), ('Recall@1', 0.0033544662874192), ('Recall@5', 0.025745244696736336), ('Recall@10', 0.04438469186425209), ('NDCG@5', 0.9336979985237122), ('NDCG@10', 0.9029626846313477), ('NDCG@20', 0.7939386367797852)])
2 stage (test) OrderedDict([('Precision@1', 0.973664402961731), ('Precision@5', 0.9630801677703857), ('Precision@10', 0.9353371858596802), ('Recall@1', 0.007816214114427567), ('Recall@5', 0.0336674265563488), ('Recall@10', 0.051419779658317566), ('NDCG@5', 0.9667789340019226), ('NDCG@10', 0.9491879343986511), ('NDCG@20', 0.8521312475204468)])

 ---epoch 13---
1 stage 0.873675525188446
2 stage 0.9447020292282104
1 stage (val) OrderedDict([('Precision@1', 0.8359213471412659), ('Precision@5', 0.8670814633369446), ('Precision@10', 0.7974141240119934), ('Recall@1', 0.0038942007813602686), ('Recall@5', 0.037541553378105164), ('Recall@10', 0.05836675688624382), ('NDCG@5', 0.8633794784545898), ('NDCG@10', 0.8187873959541321), ('NDCG@20', 0.7323683500289917)])
2 stage (val) OrderedDict([('Precision@1', 0.943581759929657), ('Precision@5', 0.9190481901168823), ('Precision@10', 0.8714290261268616), ('Recall@1', 0.015014591626822948), ('Recall@5', 0.0530092716217041), ('Recall@10', 0.07166443020105362), ('NDCG@5', 0.9286344647407532), ('NDCG@10', 0.8993586897850037), ('NDCG@20', 0.80428546667099)])
1 stage (test) OrderedDict([('Precision@1', 0.9184851050376892), ('Precision@5', 0.9364939332008362), ('Precision@10', 0.8877039551734924), ('Recall@1', 0.003477392951026559), ('Recall@5', 0.025551820173859596), ('Recall@10', 0.04431741684675217), ('NDCG@5', 0.9343084096908569), ('NDCG@10', 0.9029132723808289), ('NDCG@20', 0.7982853651046753)])
2 stage (test) OrderedDict([('Precision@1', 0.9739152193069458), ('Precision@5', 0.9631302952766418), ('Precision@10', 0.935888946056366), ('Recall@1', 0.007823591120541096), ('Recall@5', 0.03369123861193657), ('Recall@10', 0.051465846598148346), ('NDCG@5', 0.9668166041374207), ('NDCG@10', 0.9495801329612732), ('NDCG@20', 0.8524214029312134)])

 ---epoch 14---
1 stage 0.8743377923965454
2 stage 0.9448675513267517
1 stage (val) OrderedDict([('Precision@1', 0.8374741077423096), ('Precision@5', 0.8677027225494385), ('Precision@10', 0.7978280782699585), ('Recall@1', 0.003873931709676981), ('Recall@5', 0.03667106106877327), ('Recall@10', 0.05825410783290863), ('NDCG@5', 0.864425778388977), ('NDCG@10', 0.8193790316581726), ('NDCG@20', 0.7328730821609497)])
2 stage (val) OrderedDict([('Precision@1', 0.943581759929657), ('Precision@5', 0.9192551374435425), ('Precision@10', 0.8715845942497253), ('Recall@1', 0.015014591626822948), ('Recall@5', 0.05313529074192047), ('Recall@10', 0.07173865288496017), ('NDCG@5', 0.9287505745887756), ('NDCG@10', 0.899377167224884), ('NDCG@20', 0.8064449429512024)])
1 stage (test) OrderedDict([('Precision@1', 0.918735921382904), ('Precision@5', 0.9366443753242493), ('Precision@10', 0.8875784277915955), ('Recall@1', 0.00348133803345263), ('Recall@5', 0.02504768967628479), ('Recall@10', 0.044314686208963394), ('NDCG@5', 0.9345718026161194), ('NDCG@10', 0.9027630090713501), ('NDCG@20', 0.7993535995483398)])
2 stage (test) OrderedDict([('Precision@1', 0.9741660356521606), ('Precision@5', 0.963180422782898), ('Precision@10', 0.9356882572174072), ('Recall@1', 0.007828607223927975), ('Recall@5', 0.03371934965252876), ('Recall@10', 0.051444873213768005), ('NDCG@5', 0.9669326543807983), ('NDCG@10', 0.9495087265968323), ('NDCG@20', 0.8542296290397644)])

 ---epoch 15---
1 stage 0.875
2 stage 0.9451987147331238
1 stage (val) OrderedDict([('Precision@1', 0.839026927947998), ('Precision@5', 0.8621119856834412), ('Precision@10', 0.7976210713386536), ('Recall@1', 0.003954415675252676), ('Recall@5', 0.03144076094031334), ('Recall@10', 0.05820336565375328), ('NDCG@5', 0.86229407787323), ('NDCG@10', 0.8189553022384644), ('NDCG@20', 0.7320632338523865)])
2 stage (val) OrderedDict([('Precision@1', 0.9440993666648865), ('Precision@5', 0.9179095029830933), ('Precision@10', 0.8713255524635315), ('Recall@1', 0.015030765905976295), ('Recall@5', 0.05264124274253845), ('Recall@10', 0.07145236432552338), ('NDCG@5', 0.9279696941375732), ('NDCG@10', 0.8991669416427612), ('NDCG@20', 0.8046199083328247)])
1 stage (test) OrderedDict([('Precision@1', 0.9189866781234741), ('Precision@5', 0.9343367218971252), ('Precision@10', 0.886650800704956), ('Recall@1', 0.0034877443686127663), ('Recall@5', 0.023578980937600136), ('Recall@10', 0.04410114884376526), ('NDCG@5', 0.9334456324577332), ('NDCG@10', 0.901811957359314), ('NDCG@20', 0.796948254108429)])
2 stage (test) OrderedDict([('Precision@1', 0.9744168519973755), ('Precision@5', 0.9631805419921875), ('Precision@10', 0.9350861310958862), ('Recall@1', 0.007846523076295853), ('Recall@5', 0.033945683389902115), ('Recall@10', 0.051433347165584564), ('NDCG@5', 0.9670196771621704), ('NDCG@10', 0.9492480158805847), ('NDCG@20', 0.8503140211105347)])

 ---epoch 16---
1 stage 0.8746688961982727
2 stage 0.9448675513267517
1 stage (val) OrderedDict([('Precision@1', 0.840062141418457), ('Precision@5', 0.8586959838867188), ('Precision@10', 0.7927557229995728), ('Recall@1', 0.00391168100759387), ('Recall@5', 0.030842551961541176), ('Recall@10', 0.05768047645688057), ('NDCG@5', 0.857774555683136), ('NDCG@10', 0.8133404850959778), ('NDCG@20', 0.7163088321685791)])
2 stage (val) OrderedDict([('Precision@1', 0.943581759929657), ('Precision@5', 0.9145970344543457), ('Precision@10', 0.8674951195716858), ('Recall@1', 0.015014591626822948), ('Recall@5', 0.05109909549355507), ('Recall@10', 0.06977085024118423), ('NDCG@5', 0.9253076910972595), ('NDCG@10', 0.8957194685935974), ('NDCG@20', 0.7942360639572144)])
1 stage (test) OrderedDict([('Precision@1', 0.9179834723472595), ('Precision@5', 0.9315779805183411), ('Precision@10', 0.8800285458564758), ('Recall@1', 0.0033887557219713926), ('Recall@5', 0.023249421268701553), ('Recall@10', 0.04385620728135109), ('NDCG@5', 0.9302358031272888), ('NDCG@10', 0.8959716558456421), ('NDCG@20', 0.7765030264854431)])
2 stage (test) OrderedDict([('Precision@1', 0.9741660356521606), ('Precision@5', 0.9618262052536011), ('Precision@10', 0.931850254535675), ('Recall@1', 0.007841506041586399), ('Recall@5', 0.03320588171482086), ('Recall@10', 0.05045972391963005), ('NDCG@5', 0.9660043716430664), ('NDCG@10', 0.9467595815658569), ('NDCG@20', 0.8368167877197266)])

 ---epoch 17---
1 stage 0.87649005651474
2 stage 0.9448675513267517
1 stage (val) OrderedDict([('Precision@1', 0.8436853289604187), ('Precision@5', 0.8591099381446838), ('Precision@10', 0.7869071364402771), ('Recall@1', 0.0039990185759961605), ('Recall@5', 0.030867619439959526), ('Recall@10', 0.057398393750190735), ('NDCG@5', 0.8583289384841919), ('NDCG@10', 0.8095158338546753), ('NDCG@20', 0.7068324685096741)])
2 stage (val) OrderedDict([('Precision@1', 0.943581759929657), ('Precision@5', 0.9143900275230408), ('Precision@10', 0.8670809268951416), ('Recall@1', 0.015014591626822948), ('Recall@5', 0.050812140107154846), ('Recall@10', 0.0695224329829216), ('NDCG@5', 0.9251974821090698), ('NDCG@10', 0.8953093886375427), ('NDCG@20', 0.791334331035614)])
1 stage (test) OrderedDict([('Precision@1', 0.9189866781234741), ('Precision@5', 0.9319291114807129), ('Precision@10', 0.8714011907577515), ('Recall@1', 0.0034084501676261425), ('Recall@5', 0.023317061364650726), ('Recall@10', 0.04327181726694107), ('NDCG@5', 0.9305843710899353), ('NDCG@10', 0.8901927471160889), ('NDCG@20', 0.7652526497840881)])
2 stage (test) OrderedDict([('Precision@1', 0.9741660356521606), ('Precision@5', 0.961374819278717), ('Precision@10', 0.9308974742889404), ('Recall@1', 0.007841506041586399), ('Recall@5', 0.03302949294447899), ('Recall@10', 0.050273146480321884), ('NDCG@5', 0.9657419919967651), ('NDCG@10', 0.9460641145706177), ('NDCG@20', 0.8330366015434265)])

 ---epoch 18---
1 stage 0.8769867420196533
2 stage 0.9448675513267517
1 stage (val) OrderedDict([('Precision@1', 0.8442028760910034), ('Precision@5', 0.8597308993339539), ('Precision@10', 0.7818864583969116), ('Recall@1', 0.0041385795921087265), ('Recall@5', 0.030936533585190773), ('Recall@10', 0.056731704622507095), ('NDCG@5', 0.8588704466819763), ('NDCG@10', 0.8062609434127808), ('NDCG@20', 0.7035788297653198)])
2 stage (val) OrderedDict([('Precision@1', 0.943581759929657), ('Precision@5', 0.9142864942550659), ('Precision@10', 0.8658906817436218), ('Recall@1', 0.015014591626822948), ('Recall@5', 0.050981584936380386), ('Recall@10', 0.06925816088914871), ('NDCG@5', 0.9250206351280212), ('NDCG@10', 0.8944141268730164), ('NDCG@20', 0.7902264595031738)])
1 stage (test) OrderedDict([('Precision@1', 0.9194883108139038), ('Precision@5', 0.9319792985916138), ('Precision@10', 0.8661093711853027), ('Recall@1', 0.003418426727876067), ('Recall@5', 0.023334238678216934), ('Recall@10', 0.042945496737957), ('NDCG@5', 0.9306420683860779), ('NDCG@10', 0.8865886330604553), ('NDCG@20', 0.7602352499961853)])
2 stage (test) OrderedDict([('Precision@1', 0.9741660356521606), ('Precision@5', 0.9603214263916016), ('Precision@10', 0.9288903474807739), ('Recall@1', 0.007841506041586399), ('Recall@5', 0.03269359469413757), ('Recall@10', 0.04984758794307709), ('NDCG@5', 0.9649168848991394), ('NDCG@10', 0.9444789886474609), ('NDCG@20', 0.8307515382766724)])

 ---epoch 19---
1 stage 0.8768212199211121
2 stage 0.9448675513267517
1 stage (val) OrderedDict([('Precision@1', 0.8442028760910034), ('Precision@5', 0.8590062260627747), ('Precision@10', 0.7816277146339417), ('Recall@1', 0.004117700736969709), ('Recall@5', 0.030927948653697968), ('Recall@10', 0.05665162578225136), ('NDCG@5', 0.8586164116859436), ('NDCG@10', 0.8061487078666687), ('NDCG@20', 0.7013629674911499)])
2 stage (val) OrderedDict([('Precision@1', 0.943581759929657), ('Precision@5', 0.9134584665298462), ('Precision@10', 0.8652697205543518), ('Recall@1', 0.015014591626822948), ('Recall@5', 0.050237275660037994), ('Recall@10', 0.06875021755695343), ('NDCG@5', 0.9243248701095581), ('NDCG@10', 0.8936079740524292), ('NDCG@20', 0.7890340089797974)])
1 stage (test) OrderedDict([('Precision@1', 0.919237494468689), ('Precision@5', 0.9320796132087708), ('Precision@10', 0.8633516430854797), ('Recall@1', 0.0034406548365950584), ('Recall@5', 0.023358946666121483), ('Recall@10', 0.0427171066403389), ('NDCG@5', 0.9306590557098389), ('NDCG@10', 0.8847069144248962), ('NDCG@20', 0.7577565312385559)])
2 stage (test) OrderedDict([('Precision@1', 0.9741660356521606), ('Precision@5', 0.9601708650588989), ('Precision@10', 0.9280124306678772), ('Recall@1', 0.007841506041586399), ('Recall@5', 0.03252454102039337), ('Recall@10', 0.049656614661216736), ('NDCG@5', 0.964770495891571), ('NDCG@10', 0.9437631964683533), ('NDCG@20', 0.8294360041618347)])
------------------------------------------------------------
Best validation epoch: 14
Best validation stage results
 1 stage: OrderedDict([('Precision@1', 0.8374741077423096), ('Precision@5', 0.8677027225494385), ('Precision@10', 0.7978280782699585), ('Recall@1', 0.003873931709676981), ('Recall@5', 0.03667106106877327), ('Recall@10', 0.05825410783290863), ('NDCG@5', 0.864425778388977), ('NDCG@10', 0.8193790316581726), ('NDCG@20', 0.7328730821609497)])
 2 stage: OrderedDict([('Precision@1', 0.943581759929657), ('Precision@5', 0.9192551374435425), ('Precision@10', 0.8715845942497253), ('Recall@1', 0.015014591626822948), ('Recall@5', 0.05313529074192047), ('Recall@10', 0.07173865288496017), ('NDCG@5', 0.9287505745887756), ('NDCG@10', 0.899377167224884), ('NDCG@20', 0.8064449429512024)])
Best test results
 1 stage: OrderedDict([('Precision@1', 0.918735921382904), ('Precision@5', 0.9366443753242493), ('Precision@10', 0.8875784277915955), ('Recall@1', 0.00348133803345263), ('Recall@5', 0.02504768967628479), ('Recall@10', 0.044314686208963394), ('NDCG@5', 0.9345718026161194), ('NDCG@10', 0.9027630090713501), ('NDCG@20', 0.7993535995483398)])
 2 stage: OrderedDict([('Precision@1', 0.9741660356521606), ('Precision@5', 0.963180422782898), ('Precision@10', 0.9356882572174072), ('Recall@1', 0.007828607223927975), ('Recall@5', 0.03371934965252876), ('Recall@10', 0.051444873213768005), ('NDCG@5', 0.9669326543807983), ('NDCG@10', 0.9495087265968323), ('NDCG@20', 0.8542296290397644)])
